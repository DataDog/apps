!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DDClient=t():e.DDClient=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UiAppEventType=t.UiAppCapabilityType=t.Host=void 0,function(e){e.PROD="https://app.datadoghq.com/",e.STAGE="https://dd.datad0g.com/"}(t.Host||(t.Host={})),function(e){e.APP_CONTEXT="app_context",e.DASHBOARD_COG_MENU="dashboard_cog_menu"}(t.UiAppCapabilityType||(t.UiAppCapabilityType={})),function(e){e.APP_CONTEXT="app_context",e.DASHBOARD_COG_MENU_CONTEXT="dashboard_cog_menu_context"}(t.UiAppEventType||(t.UiAppEventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLogger=void 0,t.getLogger=e=>e.debug?{log:e=>console.log("dd-apps: "+e),error:e=>console.error("dd-apps: "+e)}:{log(){},error(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueInt=t.defer=void 0,t.defer=()=>{let e=()=>{},t=()=>{};const n=new Promise((n,i)=>{e=n,t=i});return{resolve:e,reject:t,promise:n}};let i=0;t.uniqueInt=()=>(i++,i)},function(e,t,n){"use strict";const i=n(4);e.exports=i.DDClient},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{d(i.next(e))}catch(e){o(e)}}function s(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DDClient=void 0;const o=r(n(5)),a=n(6),s=n(0),d=n(1),c=n(2),u={host:s.Host.STAGE,debug:!1};t.DDClient=class{constructor(e={}){this.host=e.host||u.host,this.debug=e.debug||u.debug,this.context=c.defer(),this.logger=d.getLogger(e),o.default.debug=this._debug,this.handshake=new o.default.Model({init:e=>this.init(e),handleEvent:e=>this.handleEvent(e)}),this.capabilityManagers=a.capabilityManagers.map(e=>new e({host:this.host,debug:this.debug},this.handshake,this.context)),this.capabilityManagers.forEach(e=>e.applyAdditionalMethods(this))}on(e,t){const n=this.getManagerByEventType(e);return n?n.subscribeHandler(e,t):(this.logger.error("Unknown event type"),()=>{})}init(e){return i(this,void 0,void 0,(function*(){yield this.handshake,this.context.resolve(e),this.logger.log("dd-apps: sdk handshake: parent <-> child handshake is complete"),this.handleEvent({eventType:s.UiAppEventType.APP_CONTEXT,data:e})}))}handleEvent({eventType:e,data:t}){return i(this,void 0,void 0,(function*(){const n=this.getManagerByEventType(e);n?n.handleEvent({eventType:e,data:t}):this.logger.error("Could not handle event: no corresponding manager found")}))}getManagerByType(e){return this.capabilityManagers.find(t=>t.type===e)}getManagerByEventType(e){return this.capabilityManagers.find(t=>t.events.includes(e))}}},function(e,t,n){"use strict";n.r(t);
/**
  postmate - A powerful, simple, promise-based postMessage library
  @version v1.5.2
  @link https://github.com/dollarshaveclub/postmate
  @author Jacob Kelley <jakie8@gmail.com>
  @license MIT
**/
var i="application/x-postmate-v1+json",r=0,o={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},a=function(e,t){return("string"!=typeof t||e.origin===t)&&(!!e.data&&(("object"!=typeof e.data||"postmate"in e.data)&&(e.data.type===i&&!!o[e.data.postmate])))},s=function(){function e(e){var t=this;this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.events={},this.listener=function(e){if(!a(e,t.childOrigin))return!1;var n=((e||{}).data||{}).value||{},i=n.data,r=n.name;"emit"===e.data.postmate&&r in t.events&&t.events[r].call(t,i)},this.parent.addEventListener("message",this.listener,!1)}var t=e.prototype;return t.get=function(e){var t=this;return new c.Promise((function(n){var o=++r;t.parent.addEventListener("message",(function e(i){i.data.uid===o&&"reply"===i.data.postmate&&(t.parent.removeEventListener("message",e,!1),n(i.data.value))}),!1),t.child.postMessage({postmate:"request",type:i,property:e,uid:o},t.childOrigin)}))},t.call=function(e,t){this.child.postMessage({postmate:"call",type:i,property:e,data:t},this.childOrigin)},t.on=function(e,t){this.events[e]=t},t.destroy=function(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)},e}(),d=function(){function e(e){var t=this;this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(function(e){if(a(e,t.parentOrigin)){0;var n=e.data,r=n.property,o=n.uid,s=n.data;"call"!==e.data.postmate?function(e,t){var n="function"==typeof e[t]?e[t]():e[t];return c.Promise.resolve(n)}(t.model,r).then((function(t){return e.source.postMessage({property:r,postmate:"reply",type:i,uid:o,value:t},e.origin)})):r in t.model&&"function"==typeof t.model[r]&&t.model[r](s)}}))}return e.prototype.emit=function(e,t){this.parent.postMessage({postmate:"emit",type:i,value:{name:e,data:t}},this.parentOrigin)},e}(),c=function(){function e(e){var t=e.container,n=void 0===t?void 0!==n?n:document.body:t,i=e.model,r=e.url,o=e.name,a=e.classListArray,s=void 0===a?[]:a;return this.parent=window,this.frame=document.createElement("iframe"),this.frame.name=o||"",this.frame.classList.add.apply(this.frame.classList,s),n.appendChild(this.frame),this.child=this.frame.contentWindow||this.frame.contentDocument.parentWindow,this.model=i||{},this.sendHandshake(r)}return e.prototype.sendHandshake=function(t){var n,r=this,o=function(e){var t=document.createElement("a");t.href=e;var n=t.protocol.length>4?t.protocol:window.location.protocol,i=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||n+"//"+i}(t),d=0;return new e.Promise((function(e,c){r.parent.addEventListener("message",(function t(i){return!!a(i,o)&&("handshake-reply"===i.data.postmate?(clearInterval(n),r.parent.removeEventListener("message",t,!1),r.childOrigin=i.origin,e(new s(r))):c("Failed handshake"))}),!1);var u=function(){d++,r.child.postMessage({postmate:"handshake",type:i,model:r.model},o),5===d&&clearInterval(n)},p=function(){u(),n=setInterval(u,500)};r.frame.attachEvent?r.frame.attachEvent("onload",p):r.frame.onload=p,r.frame.src=t}))},e}();c.debug=!1,c.Promise=function(){try{return window?window.Promise:Promise}catch(e){return null}}(),c.Model=function(){function e(e){return this.child=window,this.model=e,this.parent=this.child.parent,this.sendHandshakeReply()}return e.prototype.sendHandshakeReply=function(){var e=this;return new c.Promise((function(t,n){e.child.addEventListener("message",(function r(o){if(o.data.postmate){if("handshake"===o.data.postmate){0,e.child.removeEventListener("message",r,!1),o.source.postMessage({postmate:"handshake-reply",type:i},o.origin),e.parentOrigin=o.origin;var a=o.data.model;return a&&Object.keys(a).forEach((function(t){e.model[t]=a[t]})),t(new d(e))}return n("Handshake Reply Failed")}}),!1)}))},e}(),t.default=c},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{d(i.next(e))}catch(e){o(e)}}function s(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.capabilityManagers=void 0;const r=n(0),o=n(7);class a extends o.CapabilityManager{constructor(){super(...arguments),this.type=r.UiAppCapabilityType.APP_CONTEXT,this.events=[r.UiAppEventType.APP_CONTEXT]}isEnabled(){return i(this,void 0,void 0,(function*(){return Promise.resolve(!0)}))}getAdditionalClientMethods(){return{}}}class s extends o.CapabilityManager{constructor(){super(...arguments),this.type=r.UiAppCapabilityType.DASHBOARD_COG_MENU,this.events=[r.UiAppEventType.DASHBOARD_COG_MENU_CONTEXT]}getAdditionalClientMethods(){return{}}}t.capabilityManagers=[a,s]},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{d(i.next(e))}catch(e){o(e)}}function s(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.CapabilityManager=void 0;const o=n(0),a=n(1),s=n(2);t.CapabilityManager=class{constructor(e,t,n){this.host=e.host,this.debug=e.debug,this.logger=a.getLogger(e),this.handshake=t,this.context=n,this.subscriptions=(()=>{const e={};return Object.values(o.UiAppEventType).forEach(t=>{e[t]={}}),e})()}applyAdditionalMethods(e){const t=this.getAdditionalClientMethods(),n={};Object.entries(t).forEach(([e,t])=>{n[e]=(...e)=>i(this,void 0,void 0,(function*(){if(yield this.isEnabled())return t(...e);this.logger.error(`The ${this.type} capability must be enabled to perform this action`)}))}),Object.assign(e,n)}subscribeHandler(e,t){const n=s.uniqueInt();return this.subscriptions[e][n]=t,()=>{const t=this.subscriptions[e],i=n,o=(t[i],r(t,["symbol"==typeof i?i:i+""]));this.subscriptions[e]=o}}handleEvent({eventType:e,data:t}){return i(this,void 0,void 0,(function*(){if(!this.hasHandlers(e))return;if(yield this.isEnabled()){const n=this.subscriptions[e];Object.values(n).forEach(e=>e(t))}else this.logger.error(`The ${this.type} capability must be enabled to respond to events of type ${e}.`)}))}isEnabled(){return i(this,void 0,void 0,(function*(){const{capabilities:e}=yield this.context.promise;return e.includes(this.type)}))}hasHandlers(e){return!!Object.keys(this.subscriptions[e]).length}}}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ERENsaWVudC93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vRERDbGllbnQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vRERDbGllbnQvLi9zcmMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL0REQ2xpZW50Ly4vc3JjL2xvZ2dlci50cyIsIndlYnBhY2s6Ly9ERENsaWVudC8uL3NyYy91dGlscy50cyIsIndlYnBhY2s6Ly9ERENsaWVudC8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly9ERENsaWVudC8uL3NyYy9jbGllbnQudHMiLCJ3ZWJwYWNrOi8vRERDbGllbnQvLi9ub2RlX21vZHVsZXMvcG9zdG1hdGUvYnVpbGQvcG9zdG1hdGUuZXMuanMiLCJ3ZWJwYWNrOi8vRERDbGllbnQvLi9zcmMvY2FwYWJpbGl0ZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vRERDbGllbnQvLi9zcmMvY2FwYWJpbGl0ZXMvY2FwYWJpbGl0eU1hbmFnZXIudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwid2luZG93IiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIkhvc3QiLCJVaUFwcENhcGFiaWxpdHlUeXBlIiwiVWlBcHBFdmVudFR5cGUiLCJnZXRMb2dnZXIiLCJvcHRpb25zIiwiZGVidWciLCJsb2ciLCJtZXNzYWdlIiwiY29uc29sZSIsImVycm9yIiwiZGVmZXIiLCJyZXNvbHZlIiwicmVqZWN0IiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXMiLCJyZWoiLCJpbmNyZW1lbnQiLCJ1bmlxdWVJbnQiLCJERENsaWVudCIsIkRFRkFVTFRfT1BUSU9OUyIsImhvc3QiLCJTVEFHRSIsInRoaXMiLCJjb250ZXh0IiwibG9nZ2VyIiwiX2RlYnVnIiwiaGFuZHNoYWtlIiwiTW9kZWwiLCJpbml0IiwiaGFuZGxlRXZlbnQiLCJwYXJhbXMiLCJjYXBhYmlsaXR5TWFuYWdlcnMiLCJtYXAiLCJNYW5hZ2VyIiwiZm9yRWFjaCIsIm1hbmFnZXIiLCJhcHBseUFkZGl0aW9uYWxNZXRob2RzIiwiZXZlbnRUeXBlIiwiaGFuZGxlciIsImdldE1hbmFnZXJCeUV2ZW50VHlwZSIsInN1YnNjcmliZUhhbmRsZXIiLCJBUFBfQ09OVEVYVCIsImRhdGEiLCJjYXBhYmlsaXR5VHlwZSIsImZpbmQiLCJ0eXBlIiwiZXZlbnRzIiwiaW5jbHVkZXMiLCJtZXNzYWdlVHlwZSIsIl9tZXNzYWdlSWQiLCJtZXNzYWdlVHlwZXMiLCJlbWl0IiwicmVwbHkiLCJyZXF1ZXN0Iiwic2FuaXRpemUiLCJhbGxvd2VkT3JpZ2luIiwib3JpZ2luIiwicG9zdG1hdGUiLCJQYXJlbnRBUEkiLCJpbmZvIiwiX3RoaXMiLCJwYXJlbnQiLCJmcmFtZSIsImNoaWxkIiwiY2hpbGRPcmlnaW4iLCJsaXN0ZW5lciIsImUiLCJfcmVmIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9wcm90byIsIl90aGlzMiIsIlBvc3RtYXRlIiwidWlkIiwidHJhbnNhY3QiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicG9zdE1lc3NhZ2UiLCJvbiIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwiZGVzdHJveSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsIkNoaWxkQVBJIiwiX3RoaXMzIiwibW9kZWwiLCJwYXJlbnRPcmlnaW4iLCJfZSRkYXRhIiwidW53cmFwcGVkQ29udGV4dCIsInJlc29sdmVWYWx1ZSIsInRoZW4iLCJzb3VyY2UiLCJfcmVmMiIsIl9yZWYyJGNvbnRhaW5lciIsImNvbnRhaW5lciIsImRvY3VtZW50IiwiYm9keSIsInVybCIsIl9yZWYyJGNsYXNzTGlzdEFycmF5IiwiY2xhc3NMaXN0QXJyYXkiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwbHkiLCJhcHBlbmRDaGlsZCIsImNvbnRlbnRXaW5kb3ciLCJjb250ZW50RG9jdW1lbnQiLCJwYXJlbnRXaW5kb3ciLCJzZW5kSGFuZHNoYWtlIiwicmVzcG9uc2VJbnRlcnZhbCIsIl90aGlzNCIsImEiLCJocmVmIiwicHJvdG9jb2wiLCJsZW5ndGgiLCJsb2NhdGlvbiIsInBvcnQiLCJob3N0bmFtZSIsInJlc29sdmVPcmlnaW4iLCJhdHRlbXB0IiwiY2xlYXJJbnRlcnZhbCIsImRvU2VuZCIsImxvYWRlZCIsInNldEludGVydmFsIiwiYXR0YWNoRXZlbnQiLCJvbmxvYWQiLCJzcmMiLCJzZW5kSGFuZHNoYWtlUmVwbHkiLCJfdGhpczUiLCJzaGFrZSIsImRlZmF1bHRzIiwia2V5cyIsIkFwcENvbnRleHRNYW5hZ2VyIiwiQ2FwYWJpbGl0eU1hbmFnZXIiLCJEYXNoYm9hcmRDb2dNZW51TWFuYWdlciIsIkRBU0hCT0FSRF9DT0dfTUVOVSIsIkRBU0hCT0FSRF9DT0dfTUVOVV9DT05URVhUIiwic3Vic2NyaXB0aW9ucyIsInN1YmNyaXB0aW9ucyIsInZhbHVlcyIsImluaXRTdWJzY3JpcHRpb25zIiwiY2xpZW50IiwiYWRkaXRpb25hbE1ldGhvZHMiLCJnZXRBZGRpdGlvbmFsQ2xpZW50TWV0aG9kcyIsIndyYXBwZWRNZXRob2RzIiwiZW50cmllcyIsIm1ldGhvZCIsImFyZ3MiLCJpc0VuYWJsZWQiLCJhc3NpZ24iLCJzdWJzY3JpcHRpb25JZCIsIm90aGVyU3Vic2NyaXB0aW9ucyIsImhhc0hhbmRsZXJzIiwiY2FwYWJpbGl0aWVzIl0sIm1h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YSxLQUd2Qm9HLEdBMEJrQkUsR0FpQnpCLHVCQUF1QkMsR0FDbkIsTUFBTUMsRUFBb0J2SCxLQUFLd0gsNkJBRXpCQyxFQUErQyxHQUVyRHRLLE9BQU91SyxRQUFRSCxHQUFtQjNHLFFBQVEsRUFBRTVDLEVBQUsySixNQUM3Q0YsRUFBZXpKLEdBQU8sSUFBVTRKLElBQWdCLEVBQUQsZ0NBRzNDLFNBRndCNUgsS0FBSzZILFlBR3pCLE9BQU9GLEtBQVVDLEdBRWpCNUgsS0FBS0UsT0FBT2hCLE1BQ1IsT0FBT2MsS0FBS3VCLCtEQU01QnBFLE9BQU8ySyxPQUFPUixFQUFRRyxHQU0xQixpQkFDSTFHLEVBQ0FDLEdBRUEsTUFBTStHLEVBQWlCLEVBQUFwSSxZQUl2QixPQUZBSyxLQUFLa0gsY0FBY25HLEdBQVdnSCxHQUFrQi9HLEVBRXpDLEtBQ0gsTUFHSSxFQUFBaEIsS0FBS2tILGNBQWNuRyxHQUZuQixFQUFDZ0gsRUFDRUMsR0FEZ0IsS0FDRSxJQUZuQiw4QkFLTmhJLEtBQUtrSCxjQUFjbkcsR0FBYWlILEdBT2xDLGFBQWUsVUFBRWpILEVBQVMsS0FBRUssSSx5Q0FHOUIsSUFGb0JwQixLQUFLaUksWUFBWWxILEdBR2pDLE9BS0osU0FGd0JmLEtBQUs2SCxZQUVkLENBQ1gsTUFBTVgsRUFBZ0JsSCxLQUFLa0gsY0FBY25HLEdBRXpDNUQsT0FBT2lLLE9BQU9GLEdBQWV0RyxRQUFRSSxHQUFXQSxFQUFRSSxTQUV4RHBCLEtBQUtFLE9BQU9oQixNQUNSLE9BQU9jLEtBQUt1QixnRUFBZ0VSLFNBS2xGLFkseUNBQ0YsTUFBTSxhQUFFbUgsU0FBdUJsSSxLQUFLQyxRQUFRWCxRQUU1QyxPQUFPNEksRUFBYXpHLFNBQVN6QixLQUFLdUIsU0FHdEMsWUFBWVIsR0FDUixRQUFTNUQsT0FBT3lKLEtBQUs1RyxLQUFLa0gsY0FBY25HLElBQVk0RSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiRERDbGllbnRcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiRERDbGllbnRcIl0gPSBmYWN0b3J5KCk7XG59KSh3aW5kb3csIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAzKTtcbiIsImV4cG9ydCBlbnVtIEhvc3Qge1xuICAgIFBST0QgPSAnaHR0cHM6Ly9hcHAuZGF0YWRvZ2hxLmNvbS8nLFxuICAgIFNUQUdFID0gJ2h0dHBzOi8vZGQuZGF0YWQwZy5jb20vJ1xufVxuXG5leHBvcnQgZW51bSBVaUFwcENhcGFiaWxpdHlUeXBlIHtcbiAgICBBUFBfQ09OVEVYVCA9ICdhcHBfY29udGV4dCcsXG4gICAgREFTSEJPQVJEX0NPR19NRU5VID0gJ2Rhc2hib2FyZF9jb2dfbWVudSdcbn1cblxuZXhwb3J0IGVudW0gVWlBcHBFdmVudFR5cGUge1xuICAgIEFQUF9DT05URVhUID0gJ2FwcF9jb250ZXh0JyxcbiAgICBEQVNIQk9BUkRfQ09HX01FTlVfQ09OVEVYVCA9ICdkYXNoYm9hcmRfY29nX21lbnVfY29udGV4dCdcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi9cbmltcG9ydCB7IENsaWVudE9wdGlvbnMgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBMb2dnZXIge1xuICAgIGxvZyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkO1xuICAgIGVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjb25zdCBnZXRMb2dnZXIgPSAob3B0aW9uczogQ2xpZW50T3B0aW9ucyk6IExvZ2dlciA9PiB7XG4gICAgaWYgKG9wdGlvbnMuZGVidWcpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvZyhtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coYGRkLWFwcHM6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5lcnJvcihgZGQtYXBwczogJHttZXNzYWdlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsb2coKSB7fSxcbiAgICAgICAgICAgIGVycm9yKCkge31cbiAgICAgICAgfTtcbiAgICB9XG59O1xuIiwiZXhwb3J0IGludGVyZmFjZSBEZWZlcnJlZDxUPiB7XG4gICAgcmVzb2x2ZTogKHQ6IFQpID0+IHZvaWQ7XG4gICAgcmVqZWN0OiAodDogVCkgPT4gdm9pZDtcbiAgICBwcm9taXNlOiBQcm9taXNlPFQ+O1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBkZWZmZXJyZWQgb2JqZWN0LCBpbmNsdWRpbmcgcHJvbWlzZSBhbmQgcmVzb2x2ZSArIHJlamVjdCBtZXRob2RzIHRvIGJlIGV4ZWN1dGVkIGxhdGVyXG4gKi9cbmV4cG9ydCBjb25zdCBkZWZlciA9IDxUPigpOiBEZWZlcnJlZDxUPiA9PiB7XG4gICAgbGV0IHJlc29sdmU6ICh0OiBUKSA9PiB2b2lkID0gKCkgPT4ge307XG4gICAgbGV0IHJlamVjdDogKHQ6IFQpID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2U8VD4oKHJlcywgcmVqKSA9PiB7XG4gICAgICAgIHJlc29sdmUgPSByZXM7XG4gICAgICAgIHJlamVjdCA9IHJlajtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc29sdmUsXG4gICAgICAgIHJlamVjdCxcbiAgICAgICAgcHJvbWlzZVxuICAgIH07XG59O1xuXG5sZXQgaW5jcmVtZW50OiBudW1iZXIgPSAwO1xuXG4vLyBnZW5lcmF0ZXMgYW4gaW50ZWdlciwgZ3VhcmFudGVlZCB0byBiZSB1bmlxdWUgYmVjdWFzZSBpdCdzIGluY3JlbWVudGVkIDopXG5leHBvcnQgY29uc3QgdW5pcXVlSW50ID0gKCk6IG51bWJlciA9PiB7XG4gICAgaW5jcmVtZW50Kys7XG5cbiAgICByZXR1cm4gaW5jcmVtZW50O1xufTtcbiIsImltcG9ydCB7IEREQ2xpZW50IH0gZnJvbSAnLi9jbGllbnQnO1xuXG5leHBvcnQgPSBERENsaWVudDtcbiIsImltcG9ydCBQb3N0bWF0ZSBmcm9tICdwb3N0bWF0ZSc7XG5cbmltcG9ydCB7IENhcGFiaWxpdHlNYW5hZ2VyIH0gZnJvbSAnLi9jYXBhYmlsaXRlcy9jYXBhYmlsaXR5TWFuYWdlcic7XG5pbXBvcnQgeyBjYXBhYmlsaXR5TWFuYWdlcnMgfSBmcm9tICcuL2NhcGFiaWxpdGVzJztcbmltcG9ydCB7IEhvc3QsIFVpQXBwQ2FwYWJpbGl0eVR5cGUsIFVpQXBwRXZlbnRUeXBlIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyLCBMb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQge1xuICAgIEFwcENvbnRleHQsXG4gICAgRXZlbnRIYW5kbGVyLFxuICAgIEhhbmRsZUV2ZW50UGFyYW1zLFxuICAgIENsaWVudE9wdGlvbnNcbn0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBEZWZlcnJlZCwgZGVmZXIgfSBmcm9tICcuL3V0aWxzJztcblxuY29uc3QgREVGQVVMVF9PUFRJT05TID0ge1xuICAgIGhvc3Q6IEhvc3QuU1RBR0UsXG4gICAgZGVidWc6IGZhbHNlXG59O1xuXG5leHBvcnQgY2xhc3MgRERDbGllbnQge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgaG9zdDogc3RyaW5nO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgZGVidWc6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSByZWFkb25seSBoYW5kc2hha2U6IFBvc3RtYXRlLk1vZGVsO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgbG9nZ2VyOiBMb2dnZXI7XG4gICAgcHJpdmF0ZSBjb250ZXh0OiBEZWZlcnJlZDxBcHBDb250ZXh0PjtcbiAgICBwcml2YXRlIGNhcGFiaWxpdHlNYW5hZ2VyczogQ2FwYWJpbGl0eU1hbmFnZXJbXTtcblxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM6IENsaWVudE9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0aGlzLmhvc3QgPSBvcHRpb25zLmhvc3QgfHwgREVGQVVMVF9PUFRJT05TLmhvc3Q7XG4gICAgICAgIHRoaXMuZGVidWcgPSBvcHRpb25zLmRlYnVnIHx8IERFRkFVTFRfT1BUSU9OUy5kZWJ1ZztcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gZGVmZXIoKTtcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBnZXRMb2dnZXIob3B0aW9ucyk7XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBQb3N0bWF0ZS5kZWJ1ZyA9IHRoaXMuX2RlYnVnO1xuXG4gICAgICAgIHRoaXMuaGFuZHNoYWtlID0gbmV3IFBvc3RtYXRlLk1vZGVsKHtcbiAgICAgICAgICAgIGluaXQ6IChjb250ZXh0OiBBcHBDb250ZXh0KSA9PiB0aGlzLmluaXQoY29udGV4dCksXG4gICAgICAgICAgICBoYW5kbGVFdmVudDogKHBhcmFtczogSGFuZGxlRXZlbnRQYXJhbXMpID0+IHRoaXMuaGFuZGxlRXZlbnQocGFyYW1zKVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNhcGFiaWxpdHlNYW5hZ2VycyA9IGNhcGFiaWxpdHlNYW5hZ2Vycy5tYXAoXG4gICAgICAgICAgICBNYW5hZ2VyID0+XG4gICAgICAgICAgICAgICAgbmV3IE1hbmFnZXIoXG4gICAgICAgICAgICAgICAgICAgIHsgaG9zdDogdGhpcy5ob3N0LCBkZWJ1ZzogdGhpcy5kZWJ1ZyB9LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRzaGFrZSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuY2FwYWJpbGl0eU1hbmFnZXJzLmZvckVhY2gobWFuYWdlciA9PlxuICAgICAgICAgICAgbWFuYWdlci5hcHBseUFkZGl0aW9uYWxNZXRob2RzKHRoaXMpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBldmVudCBoYW5kbGVyIHRvIGV4ZWN1dGUgb24gYSBjZXJ0YWluIGV2ZW50IHR5cGUgZnJvbSB0aGUgcGFyZW50LiBXaWxsIHByaW50XG4gICAgICogYW4gZXJyb3IgaWYgdGhlIGluc3RhbGxlZCBhcHAgZG9lcyBub3QgaGF2ZSB0aGUgcmVxdWlyZWQgY2FwYWJpbGl0eS4gUmV0dXJucyBhbiB1bnN1YnNjcmliZVxuICAgICAqIG1ldGhvZC4gVGhpcyBtZXRob2QgY2FuIGJlIGNhbGxlZCBiZWZvcmUgaGFuZHNoYWtlIGlzIHN1Y2Nlc3NmdWwsIGJ1dCBoYW5kbGVycyB3aWxsIG5vdCBleGVjdXRlIHVudGlsXG4gICAgICogYWZ0ZXIgc3VjY2Vzc3NmdWwgaGFuZHNoYWtlLlxuICAgICAqL1xuICAgIG9uPFQgPSBhbnk+KFxuICAgICAgICBldmVudFR5cGU6IFVpQXBwRXZlbnRUeXBlLFxuICAgICAgICBoYW5kbGVyOiBFdmVudEhhbmRsZXI8VD5cbiAgICApOiAoKSA9PiB2b2lkIHtcbiAgICAgICAgY29uc3QgbWFuYWdlciA9IHRoaXMuZ2V0TWFuYWdlckJ5RXZlbnRUeXBlKGV2ZW50VHlwZSk7XG5cbiAgICAgICAgaWYgKCFtYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcignVW5rbm93biBldmVudCB0eXBlJyk7XG5cbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtYW5hZ2VyLnN1YnNjcmliZUhhbmRsZXI8VD4oZXZlbnRUeXBlLCBoYW5kbGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBpbml0IG1ldGhvZCBpcyBleHBvc2VkIGluIHRoZSBwb3N0bWF0ZSBtb2RlbC4gSXQgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIG90aGVyIG9wZXJhdGlvbnMgbWF5IHByb2NlZWQsXG4gICAgICogaW4gb3JkZXIgdG8gaW5mb3JtIGNsaWVudCBvZiBhcHAgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaW5pdChjb250ZXh0OiBBcHBDb250ZXh0KSB7XG4gICAgICAgIC8vIHBhcmVudCBzaG91bGQgb25seSBiZSBhYmxlIHRvIGNhbGwgdGhpcyBhZnRlciBoYW5kc2hha2UgaXMgY29tcGxldGUsIGJ1dCBpdHMgd29ydGggYSBjaGVjayBhbnl3YXlzXG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZHNoYWtlO1xuXG4gICAgICAgIHRoaXMuY29udGV4dC5yZXNvbHZlKGNvbnRleHQpO1xuXG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZyhcbiAgICAgICAgICAgICdkZC1hcHBzOiBzZGsgaGFuZHNoYWtlOiBwYXJlbnQgPC0+IGNoaWxkIGhhbmRzaGFrZSBpcyBjb21wbGV0ZSdcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBleGVjIGFueSBhcHBfaW5pdCBldmVudCBoYW5kbGVycyByZWdpc3RlcmVkIGJ5IGNvbnN1bWVyXG4gICAgICAgIHRoaXMuaGFuZGxlRXZlbnQoe1xuICAgICAgICAgICAgZXZlbnRUeXBlOiBVaUFwcEV2ZW50VHlwZS5BUFBfQ09OVEVYVCxcbiAgICAgICAgICAgIGRhdGE6IGNvbnRleHRcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogaGFuZGxlRXZlbnQgaXMgdGhlIG1haW4gbWV0aG9kIGNhbGxlZCBieSB0aGUgcGFyZW50IHRocm91Z2ggcG9zdG1hdGUgKGNoaWxkLmhhbmRsZUV2ZW50KCdleGVjJywgey4uLn0pKS5cbiAgICAgKiBJdCBhY2NlcHRzIGEga2V5ZWQgZXZlbnQgdHlwZSBhbmQgYXJiaXRyYXJ5IGRhdGEgdG8gYmUgcGFzc2VkIHRvIGV2ZW50IGhhbmRsZXJzLiBJdCB3aWxsIGxvZyBhbiBlcnJvclxuICAgICAqIG1lc3NhZ2UgaWYgdGhlIHVzZXIgZG9lcyBub3QgaGF2ZSB0aGUgcmVxdWlyZWQgY2FwYWJpbGl0eSBlbmFibGVkXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVFdmVudDxUPih7IGV2ZW50VHlwZSwgZGF0YSB9OiBIYW5kbGVFdmVudFBhcmFtczxUPikge1xuICAgICAgICBjb25zdCBtYW5hZ2VyID0gdGhpcy5nZXRNYW5hZ2VyQnlFdmVudFR5cGUoZXZlbnRUeXBlKTtcblxuICAgICAgICBpZiAoIW1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICAgICdDb3VsZCBub3QgaGFuZGxlIGV2ZW50OiBubyBjb3JyZXNwb25kaW5nIG1hbmFnZXIgZm91bmQnXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBtYW5hZ2VyLmhhbmRsZUV2ZW50KHsgZXZlbnRUeXBlLCBkYXRhIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0TWFuYWdlckJ5VHlwZShcbiAgICAgICAgY2FwYWJpbGl0eVR5cGU6IFVpQXBwQ2FwYWJpbGl0eVR5cGVcbiAgICApOiBDYXBhYmlsaXR5TWFuYWdlciB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhcGFiaWxpdHlNYW5hZ2Vycy5maW5kKFxuICAgICAgICAgICAgbWFuYWdlciA9PiBtYW5hZ2VyLnR5cGUgPT09IGNhcGFiaWxpdHlUeXBlXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRNYW5hZ2VyQnlFdmVudFR5cGUoXG4gICAgICAgIGV2ZW50VHlwZTogVWlBcHBFdmVudFR5cGVcbiAgICApOiBDYXBhYmlsaXR5TWFuYWdlciB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhcGFiaWxpdHlNYW5hZ2Vycy5maW5kKG1hbmFnZXIgPT5cbiAgICAgICAgICAgIG1hbmFnZXIuZXZlbnRzLmluY2x1ZGVzKGV2ZW50VHlwZSlcbiAgICAgICAgKTtcbiAgICB9XG59XG4iLCIvKipcbiAgcG9zdG1hdGUgLSBBIHBvd2VyZnVsLCBzaW1wbGUsIHByb21pc2UtYmFzZWQgcG9zdE1lc3NhZ2UgbGlicmFyeVxuICBAdmVyc2lvbiB2MS41LjJcbiAgQGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2RvbGxhcnNoYXZlY2x1Yi9wb3N0bWF0ZVxuICBAYXV0aG9yIEphY29iIEtlbGxleSA8amFraWU4QGdtYWlsLmNvbT5cbiAgQGxpY2Vuc2UgTUlUXG4qKi9cbi8qKlxuICogVGhlIHR5cGUgb2YgbWVzc2FnZXMgb3VyIGZyYW1lcyBvdXIgc2VuZGluZ1xuICogQHR5cGUge1N0cmluZ31cbiAqL1xudmFyIG1lc3NhZ2VUeXBlID0gJ2FwcGxpY2F0aW9uL3gtcG9zdG1hdGUtdjEranNvbic7XG4vKipcbiAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBhdHRlbXB0cyB0byBzZW5kIGEgaGFuZHNoYWtlIHJlcXVlc3QgdG8gdGhlIHBhcmVudFxuICogQHR5cGUge051bWJlcn1cbiAqL1xuXG52YXIgbWF4SGFuZHNoYWtlUmVxdWVzdHMgPSA1O1xuLyoqXG4gKiBBIHVuaXF1ZSBtZXNzYWdlIElEIHRoYXQgaXMgdXNlZCB0byBlbnN1cmUgcmVzcG9uc2VzIGFyZSBzZW50IHRvIHRoZSBjb3JyZWN0IHJlcXVlc3RzXG4gKiBAdHlwZSB7TnVtYmVyfVxuICovXG5cbnZhciBfbWVzc2FnZUlkID0gMDtcbi8qKlxuICogSW5jcmVtZW50cyBhbmQgcmV0dXJucyBhIG1lc3NhZ2UgSURcbiAqIEByZXR1cm4ge051bWJlcn0gQSB1bmlxdWUgSUQgZm9yIGEgbWVzc2FnZVxuICovXG5cbnZhciBnZW5lcmF0ZU5ld01lc3NhZ2VJZCA9IGZ1bmN0aW9uIGdlbmVyYXRlTmV3TWVzc2FnZUlkKCkge1xuICByZXR1cm4gKytfbWVzc2FnZUlkO1xufTtcbi8qKlxuICogUG9zdG1hdGUgbG9nZ2luZyBmdW5jdGlvbiB0aGF0IGVuYWJsZXMvZGlzYWJsZXMgdmlhIGNvbmZpZ1xuICogQHBhcmFtICB7T2JqZWN0fSAuLi5hcmdzIFJlc3QgQXJndW1lbnRzXG4gKi9cblxudmFyIGxvZyA9IGZ1bmN0aW9uIGxvZygpIHtcbiAgdmFyIF9jb25zb2xlO1xuXG4gIHJldHVybiBQb3N0bWF0ZS5kZWJ1ZyA/IChfY29uc29sZSA9IGNvbnNvbGUpLmxvZy5hcHBseShfY29uc29sZSwgYXJndW1lbnRzKSA6IG51bGw7XG59OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcblxuLyoqXG4gKiBUYWtlcyBhIFVSTCBhbmQgcmV0dXJucyB0aGUgb3JpZ2luXG4gKiBAcGFyYW0gIHtTdHJpbmd9IHVybCBUaGUgZnVsbCBVUkwgYmVpbmcgcmVxdWVzdGVkXG4gKiBAcmV0dXJuIHtTdHJpbmd9ICAgICBUaGUgVVJMcyBvcmlnaW5cbiAqL1xuXG52YXIgcmVzb2x2ZU9yaWdpbiA9IGZ1bmN0aW9uIHJlc29sdmVPcmlnaW4odXJsKSB7XG4gIHZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICBhLmhyZWYgPSB1cmw7XG4gIHZhciBwcm90b2NvbCA9IGEucHJvdG9jb2wubGVuZ3RoID4gNCA/IGEucHJvdG9jb2wgOiB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2w7XG4gIHZhciBob3N0ID0gYS5ob3N0Lmxlbmd0aCA/IGEucG9ydCA9PT0gJzgwJyB8fCBhLnBvcnQgPT09ICc0NDMnID8gYS5ob3N0bmFtZSA6IGEuaG9zdCA6IHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuICByZXR1cm4gYS5vcmlnaW4gfHwgcHJvdG9jb2wgKyBcIi8vXCIgKyBob3N0O1xufTtcbnZhciBtZXNzYWdlVHlwZXMgPSB7XG4gIGhhbmRzaGFrZTogMSxcbiAgJ2hhbmRzaGFrZS1yZXBseSc6IDEsXG4gIGNhbGw6IDEsXG4gIGVtaXQ6IDEsXG4gIHJlcGx5OiAxLFxuICByZXF1ZXN0OiAxXG4gIC8qKlxuICAgKiBFbnN1cmVzIHRoYXQgYSBtZXNzYWdlIGlzIHNhZmUgdG8gaW50ZXJwcmV0XG4gICAqIEBwYXJhbSAge09iamVjdH0gbWVzc2FnZSBUaGUgcG9zdG1hdGUgbWVzc2FnZSBiZWluZyBzZW50XG4gICAqIEBwYXJhbSAge1N0cmluZ3xCb29sZWFufSBhbGxvd2VkT3JpZ2luIFRoZSB3aGl0ZWxpc3RlZCBvcmlnaW4gb3IgZmFsc2UgdG8gc2tpcCBvcmlnaW4gY2hlY2tcbiAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICovXG5cbn07XG52YXIgc2FuaXRpemUgPSBmdW5jdGlvbiBzYW5pdGl6ZShtZXNzYWdlLCBhbGxvd2VkT3JpZ2luKSB7XG4gIGlmICh0eXBlb2YgYWxsb3dlZE9yaWdpbiA9PT0gJ3N0cmluZycgJiYgbWVzc2FnZS5vcmlnaW4gIT09IGFsbG93ZWRPcmlnaW4pIHJldHVybiBmYWxzZTtcbiAgaWYgKCFtZXNzYWdlLmRhdGEpIHJldHVybiBmYWxzZTtcbiAgaWYgKHR5cGVvZiBtZXNzYWdlLmRhdGEgPT09ICdvYmplY3QnICYmICEoJ3Bvc3RtYXRlJyBpbiBtZXNzYWdlLmRhdGEpKSByZXR1cm4gZmFsc2U7XG4gIGlmIChtZXNzYWdlLmRhdGEudHlwZSAhPT0gbWVzc2FnZVR5cGUpIHJldHVybiBmYWxzZTtcbiAgaWYgKCFtZXNzYWdlVHlwZXNbbWVzc2FnZS5kYXRhLnBvc3RtYXRlXSkgcmV0dXJuIGZhbHNlO1xuICByZXR1cm4gdHJ1ZTtcbn07XG4vKipcbiAqIFRha2VzIGEgbW9kZWwsIGFuZCBzZWFyY2hlcyBmb3IgYSB2YWx1ZSBieSB0aGUgcHJvcGVydHlcbiAqIEBwYXJhbSAge09iamVjdH0gbW9kZWwgICAgIFRoZSBkaWN0aW9uYXJ5IHRvIHNlYXJjaCBhZ2FpbnN0XG4gKiBAcGFyYW0gIHtTdHJpbmd9IHByb3BlcnR5ICBBIHBhdGggd2l0aGluIGEgZGljdGlvbmFyeSAoaS5lLiAnd2luZG93LmxvY2F0aW9uLmhyZWYnKVxuICogQHBhcmFtICB7T2JqZWN0fSBkYXRhICAgICAgQWRkaXRpb25hbCBpbmZvcm1hdGlvbiBmcm9tIHRoZSBnZXQgcmVxdWVzdCB0aGF0IGlzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzZWQgdG8gZnVuY3Rpb25zIGluIHRoZSBjaGlsZCBtb2RlbFxuICogQHJldHVybiB7UHJvbWlzZX1cbiAqL1xuXG52YXIgcmVzb2x2ZVZhbHVlID0gZnVuY3Rpb24gcmVzb2x2ZVZhbHVlKG1vZGVsLCBwcm9wZXJ0eSkge1xuICB2YXIgdW53cmFwcGVkQ29udGV4dCA9IHR5cGVvZiBtb2RlbFtwcm9wZXJ0eV0gPT09ICdmdW5jdGlvbicgPyBtb2RlbFtwcm9wZXJ0eV0oKSA6IG1vZGVsW3Byb3BlcnR5XTtcbiAgcmV0dXJuIFBvc3RtYXRlLlByb21pc2UucmVzb2x2ZSh1bndyYXBwZWRDb250ZXh0KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGFuIEFQSSB0byBiZSB1c2VkIGJ5IHRoZSBwYXJlbnRcbiAqIEBwYXJhbSB7T2JqZWN0fSBpbmZvIEluZm9ybWF0aW9uIG9uIHRoZSBjb25zdW1lclxuICovXG5cbnZhciBQYXJlbnRBUEkgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQYXJlbnRBUEkoaW5mbykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICB0aGlzLnBhcmVudCA9IGluZm8ucGFyZW50O1xuICAgIHRoaXMuZnJhbWUgPSBpbmZvLmZyYW1lO1xuICAgIHRoaXMuY2hpbGQgPSBpbmZvLmNoaWxkO1xuICAgIHRoaXMuY2hpbGRPcmlnaW4gPSBpbmZvLmNoaWxkT3JpZ2luO1xuICAgIHRoaXMuZXZlbnRzID0ge307XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgbG9nKCdQYXJlbnQ6IFJlZ2lzdGVyaW5nIEFQSScpO1xuICAgICAgbG9nKCdQYXJlbnQ6IEF3YWl0aW5nIG1lc3NhZ2VzLi4uJyk7XG4gICAgfVxuXG4gICAgdGhpcy5saXN0ZW5lciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoIXNhbml0aXplKGUsIF90aGlzLmNoaWxkT3JpZ2luKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgLyoqXG4gICAgICAgKiB0aGUgYXNzaWdubWVudHMgYmVsb3cgZW5zdXJlcyB0aGF0IGUsIGRhdGEsIGFuZCB2YWx1ZSBhcmUgYWxsIGRlZmluZWRcbiAgICAgICAqL1xuXG4gICAgICB2YXIgX3JlZiA9ICgoZSB8fCB7fSkuZGF0YSB8fCB7fSkudmFsdWUgfHwge30sXG4gICAgICAgICAgZGF0YSA9IF9yZWYuZGF0YSxcbiAgICAgICAgICBuYW1lID0gX3JlZi5uYW1lO1xuXG4gICAgICBpZiAoZS5kYXRhLnBvc3RtYXRlID09PSAnZW1pdCcpIHtcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBsb2coXCJQYXJlbnQ6IFJlY2VpdmVkIGV2ZW50IGVtaXNzaW9uOiBcIiArIG5hbWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5hbWUgaW4gX3RoaXMuZXZlbnRzKSB7XG4gICAgICAgICAgX3RoaXMuZXZlbnRzW25hbWVdLmNhbGwoX3RoaXMsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmxpc3RlbmVyLCBmYWxzZSk7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgbG9nKCdQYXJlbnQ6IEF3YWl0aW5nIGV2ZW50IGVtaXNzaW9ucyBmcm9tIENoaWxkJyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIF9wcm90byA9IFBhcmVudEFQSS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmdldCA9IGZ1bmN0aW9uIGdldChwcm9wZXJ0eSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgcmV0dXJuIG5ldyBQb3N0bWF0ZS5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAvLyBFeHRyYWN0IGRhdGEgZnJvbSByZXNwb25zZSBhbmQga2lsbCBsaXN0ZW5lcnNcbiAgICAgIHZhciB1aWQgPSBnZW5lcmF0ZU5ld01lc3NhZ2VJZCgpO1xuXG4gICAgICB2YXIgdHJhbnNhY3QgPSBmdW5jdGlvbiB0cmFuc2FjdChlKSB7XG4gICAgICAgIGlmIChlLmRhdGEudWlkID09PSB1aWQgJiYgZS5kYXRhLnBvc3RtYXRlID09PSAncmVwbHknKSB7XG4gICAgICAgICAgX3RoaXMyLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdHJhbnNhY3QsIGZhbHNlKTtcblxuICAgICAgICAgIHJlc29sdmUoZS5kYXRhLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfTsgLy8gUHJlcGFyZSBmb3IgcmVzcG9uc2UgZnJvbSBDaGlsZC4uLlxuXG5cbiAgICAgIF90aGlzMi5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRyYW5zYWN0LCBmYWxzZSk7IC8vIFRoZW4gYXNrIGNoaWxkIGZvciBpbmZvcm1hdGlvblxuXG5cbiAgICAgIF90aGlzMi5jaGlsZC5wb3N0TWVzc2FnZSh7XG4gICAgICAgIHBvc3RtYXRlOiAncmVxdWVzdCcsXG4gICAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksXG4gICAgICAgIHVpZDogdWlkXG4gICAgICB9LCBfdGhpczIuY2hpbGRPcmlnaW4pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5jYWxsID0gZnVuY3Rpb24gY2FsbChwcm9wZXJ0eSwgZGF0YSkge1xuICAgIC8vIFNlbmQgaW5mb3JtYXRpb24gdG8gdGhlIGNoaWxkXG4gICAgdGhpcy5jaGlsZC5wb3N0TWVzc2FnZSh7XG4gICAgICBwb3N0bWF0ZTogJ2NhbGwnLFxuICAgICAgdHlwZTogbWVzc2FnZVR5cGUsXG4gICAgICBwcm9wZXJ0eTogcHJvcGVydHksXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSwgdGhpcy5jaGlsZE9yaWdpbik7XG4gIH07XG5cbiAgX3Byb3RvLm9uID0gZnVuY3Rpb24gb24oZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBjYWxsYmFjaztcbiAgfTtcblxuICBfcHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGxvZygnUGFyZW50OiBEZXN0cm95aW5nIFBvc3RtYXRlIGluc3RhbmNlJyk7XG4gICAgfVxuXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmxpc3RlbmVyLCBmYWxzZSk7XG4gICAgdGhpcy5mcmFtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZnJhbWUpO1xuICB9O1xuXG4gIHJldHVybiBQYXJlbnRBUEk7XG59KCk7XG4vKipcbiAqIENvbXBvc2VzIGFuIEFQSSB0byBiZSB1c2VkIGJ5IHRoZSBjaGlsZFxuICogQHBhcmFtIHtPYmplY3R9IGluZm8gSW5mb3JtYXRpb24gb24gdGhlIGNvbnN1bWVyXG4gKi9cblxudmFyIENoaWxkQVBJID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ2hpbGRBUEkoaW5mbykge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdGhpcy5tb2RlbCA9IGluZm8ubW9kZWw7XG4gICAgdGhpcy5wYXJlbnQgPSBpbmZvLnBhcmVudDtcbiAgICB0aGlzLnBhcmVudE9yaWdpbiA9IGluZm8ucGFyZW50T3JpZ2luO1xuICAgIHRoaXMuY2hpbGQgPSBpbmZvLmNoaWxkO1xuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGxvZygnQ2hpbGQ6IFJlZ2lzdGVyaW5nIEFQSScpO1xuICAgICAgbG9nKCdDaGlsZDogQXdhaXRpbmcgbWVzc2FnZXMuLi4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmNoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCFzYW5pdGl6ZShlLCBfdGhpczMucGFyZW50T3JpZ2luKSkgcmV0dXJuO1xuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBsb2coJ0NoaWxkOiBSZWNlaXZlZCByZXF1ZXN0JywgZS5kYXRhKTtcbiAgICAgIH1cblxuICAgICAgdmFyIF9lJGRhdGEgPSBlLmRhdGEsXG4gICAgICAgICAgcHJvcGVydHkgPSBfZSRkYXRhLnByb3BlcnR5LFxuICAgICAgICAgIHVpZCA9IF9lJGRhdGEudWlkLFxuICAgICAgICAgIGRhdGEgPSBfZSRkYXRhLmRhdGE7XG5cbiAgICAgIGlmIChlLmRhdGEucG9zdG1hdGUgPT09ICdjYWxsJykge1xuICAgICAgICBpZiAocHJvcGVydHkgaW4gX3RoaXMzLm1vZGVsICYmIHR5cGVvZiBfdGhpczMubW9kZWxbcHJvcGVydHldID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgX3RoaXMzLm1vZGVsW3Byb3BlcnR5XShkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gUmVwbHkgdG8gUGFyZW50XG5cblxuICAgICAgcmVzb2x2ZVZhbHVlKF90aGlzMy5tb2RlbCwgcHJvcGVydHkpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBlLnNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxuICAgICAgICAgIHBvc3RtYXRlOiAncmVwbHknLFxuICAgICAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICAgIHVpZDogdWlkLFxuICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICB9LCBlLm9yaWdpbik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBfcHJvdG8yID0gQ2hpbGRBUEkucHJvdG90eXBlO1xuXG4gIF9wcm90bzIuZW1pdCA9IGZ1bmN0aW9uIGVtaXQobmFtZSwgZGF0YSkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBsb2coXCJDaGlsZDogRW1pdHRpbmcgRXZlbnQgXFxcIlwiICsgbmFtZSArIFwiXFxcIlwiLCBkYXRhKTtcbiAgICB9XG5cbiAgICB0aGlzLnBhcmVudC5wb3N0TWVzc2FnZSh7XG4gICAgICBwb3N0bWF0ZTogJ2VtaXQnLFxuICAgICAgdHlwZTogbWVzc2FnZVR5cGUsXG4gICAgICB2YWx1ZToge1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9XG4gICAgfSwgdGhpcy5wYXJlbnRPcmlnaW4pO1xuICB9O1xuXG4gIHJldHVybiBDaGlsZEFQSTtcbn0oKTtcbi8qKlxuICAqIFRoZSBlbnRyeSBwb2ludCBvZiB0aGUgUGFyZW50LlxuICogQHR5cGUge0NsYXNzfVxuICovXG5cbnZhciBQb3N0bWF0ZSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiAgLy8gSW50ZXJuZXQgRXhwbG9yZXIgY3JhcHMgaXRzZWxmXG5cbiAgLyoqXG4gICAqIFNldHMgb3B0aW9ucyByZWxhdGVkIHRvIHRoZSBQYXJlbnRcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZWxlbWVudCB0byBpbmplY3QgdGhlIGZyYW1lIGludG8sIGFuZCB0aGUgdXJsXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAqL1xuICBmdW5jdGlvbiBQb3N0bWF0ZShfcmVmMikge1xuICAgIHZhciBfcmVmMiRjb250YWluZXIgPSBfcmVmMi5jb250YWluZXIsXG4gICAgICAgIGNvbnRhaW5lciA9IF9yZWYyJGNvbnRhaW5lciA9PT0gdm9pZCAwID8gdHlwZW9mIGNvbnRhaW5lciAhPT0gJ3VuZGVmaW5lZCcgPyBjb250YWluZXIgOiBkb2N1bWVudC5ib2R5IDogX3JlZjIkY29udGFpbmVyLFxuICAgICAgICBtb2RlbCA9IF9yZWYyLm1vZGVsLFxuICAgICAgICB1cmwgPSBfcmVmMi51cmwsXG4gICAgICAgIG5hbWUgPSBfcmVmMi5uYW1lLFxuICAgICAgICBfcmVmMiRjbGFzc0xpc3RBcnJheSA9IF9yZWYyLmNsYXNzTGlzdEFycmF5LFxuICAgICAgICBjbGFzc0xpc3RBcnJheSA9IF9yZWYyJGNsYXNzTGlzdEFycmF5ID09PSB2b2lkIDAgPyBbXSA6IF9yZWYyJGNsYXNzTGlzdEFycmF5O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiAgICB0aGlzLnBhcmVudCA9IHdpbmRvdztcbiAgICB0aGlzLmZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG4gICAgdGhpcy5mcmFtZS5uYW1lID0gbmFtZSB8fCAnJztcbiAgICB0aGlzLmZyYW1lLmNsYXNzTGlzdC5hZGQuYXBwbHkodGhpcy5mcmFtZS5jbGFzc0xpc3QsIGNsYXNzTGlzdEFycmF5KTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5mcmFtZSk7XG4gICAgdGhpcy5jaGlsZCA9IHRoaXMuZnJhbWUuY29udGVudFdpbmRvdyB8fCB0aGlzLmZyYW1lLmNvbnRlbnREb2N1bWVudC5wYXJlbnRXaW5kb3c7XG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsIHx8IHt9O1xuICAgIHJldHVybiB0aGlzLnNlbmRIYW5kc2hha2UodXJsKTtcbiAgfVxuICAvKipcbiAgICogQmVnaW5zIHRoZSBoYW5kc2hha2Ugc3RyYXRlZ3lcbiAgICogQHBhcmFtICB7U3RyaW5nfSB1cmwgVGhlIFVSTCB0byBzZW5kIGEgaGFuZHNoYWtlIHJlcXVlc3QgdG9cbiAgICogQHJldHVybiB7UHJvbWlzZX0gICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBoYW5kc2hha2UgaXMgY29tcGxldGVcbiAgICovXG5cblxuICB2YXIgX3Byb3RvMyA9IFBvc3RtYXRlLnByb3RvdHlwZTtcblxuICBfcHJvdG8zLnNlbmRIYW5kc2hha2UgPSBmdW5jdGlvbiBzZW5kSGFuZHNoYWtlKHVybCkge1xuICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgdmFyIGNoaWxkT3JpZ2luID0gcmVzb2x2ZU9yaWdpbih1cmwpO1xuICAgIHZhciBhdHRlbXB0ID0gMDtcbiAgICB2YXIgcmVzcG9uc2VJbnRlcnZhbDtcbiAgICByZXR1cm4gbmV3IFBvc3RtYXRlLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlcGx5ID0gZnVuY3Rpb24gcmVwbHkoZSkge1xuICAgICAgICBpZiAoIXNhbml0aXplKGUsIGNoaWxkT3JpZ2luKSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGlmIChlLmRhdGEucG9zdG1hdGUgPT09ICdoYW5kc2hha2UtcmVwbHknKSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChyZXNwb25zZUludGVydmFsKTtcblxuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ1BhcmVudDogUmVjZWl2ZWQgaGFuZHNoYWtlIHJlcGx5IGZyb20gQ2hpbGQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpczQucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCByZXBseSwgZmFsc2UpO1xuXG4gICAgICAgICAgX3RoaXM0LmNoaWxkT3JpZ2luID0gZS5vcmlnaW47XG5cbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgbG9nKCdQYXJlbnQ6IFNhdmluZyBDaGlsZCBvcmlnaW4nLCBfdGhpczQuY2hpbGRPcmlnaW4pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ldyBQYXJlbnRBUEkoX3RoaXM0KSk7XG4gICAgICAgIH0gLy8gTWlnaHQgbmVlZCB0byByZW1vdmUgc2luY2UgcGFyZW50IG1pZ2h0IGJlIHJlY2VpdmluZyBkaWZmZXJlbnQgbWVzc2FnZXNcbiAgICAgICAgLy8gZnJvbSBkaWZmZXJlbnQgaG9zdHNcblxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgbG9nKCdQYXJlbnQ6IEludmFsaWQgaGFuZHNoYWtlIHJlcGx5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVqZWN0KCdGYWlsZWQgaGFuZHNoYWtlJyk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpczQucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCByZXBseSwgZmFsc2UpO1xuXG4gICAgICB2YXIgZG9TZW5kID0gZnVuY3Rpb24gZG9TZW5kKCkge1xuICAgICAgICBhdHRlbXB0Kys7XG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBsb2coXCJQYXJlbnQ6IFNlbmRpbmcgaGFuZHNoYWtlIGF0dGVtcHQgXCIgKyBhdHRlbXB0LCB7XG4gICAgICAgICAgICBjaGlsZE9yaWdpbjogY2hpbGRPcmlnaW5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzNC5jaGlsZC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgcG9zdG1hdGU6ICdoYW5kc2hha2UnLFxuICAgICAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICAgIG1vZGVsOiBfdGhpczQubW9kZWxcbiAgICAgICAgfSwgY2hpbGRPcmlnaW4pO1xuXG4gICAgICAgIGlmIChhdHRlbXB0ID09PSBtYXhIYW5kc2hha2VSZXF1ZXN0cykge1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwocmVzcG9uc2VJbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBsb2FkZWQgPSBmdW5jdGlvbiBsb2FkZWQoKSB7XG4gICAgICAgIGRvU2VuZCgpO1xuICAgICAgICByZXNwb25zZUludGVydmFsID0gc2V0SW50ZXJ2YWwoZG9TZW5kLCA1MDApO1xuICAgICAgfTtcblxuICAgICAgaWYgKF90aGlzNC5mcmFtZS5hdHRhY2hFdmVudCkge1xuICAgICAgICBfdGhpczQuZnJhbWUuYXR0YWNoRXZlbnQoJ29ubG9hZCcsIGxvYWRlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpczQuZnJhbWUub25sb2FkID0gbG9hZGVkO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBsb2coJ1BhcmVudDogTG9hZGluZyBmcmFtZScsIHtcbiAgICAgICAgICB1cmw6IHVybFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgX3RoaXM0LmZyYW1lLnNyYyA9IHVybDtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gUG9zdG1hdGU7XG59KCk7XG4vKipcbiAqIFRoZSBlbnRyeSBwb2ludCBvZiB0aGUgQ2hpbGRcbiAqIEB0eXBlIHtDbGFzc31cbiAqL1xuXG5cblBvc3RtYXRlLmRlYnVnID0gZmFsc2U7XG5cblBvc3RtYXRlLlByb21pc2UgPSBmdW5jdGlvbiAoKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbmRvdyA/IHdpbmRvdy5Qcm9taXNlIDogUHJvbWlzZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59KCk7XG5cblBvc3RtYXRlLk1vZGVsID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBjaGlsZCwgbW9kZWwsIHBhcmVudCwgYW5kIHJlc3BvbmRzIHRvIHRoZSBQYXJlbnRzIGhhbmRzaGFrZVxuICAgKiBAcGFyYW0ge09iamVjdH0gbW9kZWwgSGFzaCBvZiB2YWx1ZXMsIGZ1bmN0aW9ucywgb3IgcHJvbWlzZXNcbiAgICogQHJldHVybiB7UHJvbWlzZX0gICAgICAgVGhlIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBoYW5kc2hha2UgaGFzIGJlZW4gcmVjZWl2ZWRcbiAgICovXG4gIGZ1bmN0aW9uIE1vZGVsKG1vZGVsKSB7XG4gICAgdGhpcy5jaGlsZCA9IHdpbmRvdztcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgdGhpcy5wYXJlbnQgPSB0aGlzLmNoaWxkLnBhcmVudDtcbiAgICByZXR1cm4gdGhpcy5zZW5kSGFuZHNoYWtlUmVwbHkoKTtcbiAgfVxuICAvKipcbiAgICogUmVzcG9uZHMgdG8gYSBoYW5kc2hha2UgaW5pdGlhdGVkIGJ5IHRoZSBQYXJlbnRcbiAgICogQHJldHVybiB7UHJvbWlzZX0gUmVzb2x2ZXMgYW4gb2JqZWN0IHRoYXQgZXhwb3NlcyBhbiBBUEkgZm9yIHRoZSBDaGlsZFxuICAgKi9cblxuXG4gIHZhciBfcHJvdG80ID0gTW9kZWwucHJvdG90eXBlO1xuXG4gIF9wcm90bzQuc2VuZEhhbmRzaGFrZVJlcGx5ID0gZnVuY3Rpb24gc2VuZEhhbmRzaGFrZVJlcGx5KCkge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgcmV0dXJuIG5ldyBQb3N0bWF0ZS5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBzaGFrZSA9IGZ1bmN0aW9uIHNoYWtlKGUpIHtcbiAgICAgICAgaWYgKCFlLmRhdGEucG9zdG1hdGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZS5kYXRhLnBvc3RtYXRlID09PSAnaGFuZHNoYWtlJykge1xuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ0NoaWxkOiBSZWNlaXZlZCBoYW5kc2hha2UgZnJvbSBQYXJlbnQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpczUuY2hpbGQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHNoYWtlLCBmYWxzZSk7XG5cbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgbG9nKCdDaGlsZDogU2VuZGluZyBoYW5kc2hha2UgcmVwbHkgdG8gUGFyZW50Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZS5zb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgcG9zdG1hdGU6ICdoYW5kc2hha2UtcmVwbHknLFxuICAgICAgICAgICAgdHlwZTogbWVzc2FnZVR5cGVcbiAgICAgICAgICB9LCBlLm9yaWdpbik7XG4gICAgICAgICAgX3RoaXM1LnBhcmVudE9yaWdpbiA9IGUub3JpZ2luOyAvLyBFeHRlbmQgbW9kZWwgd2l0aCB0aGUgb25lIHByb3ZpZGVkIGJ5IHRoZSBwYXJlbnRcblxuICAgICAgICAgIHZhciBkZWZhdWx0cyA9IGUuZGF0YS5tb2RlbDtcblxuICAgICAgICAgIGlmIChkZWZhdWx0cykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGVmYXVsdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICBfdGhpczUubW9kZWxba2V5XSA9IGRlZmF1bHRzW2tleV07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgICAgbG9nKCdDaGlsZDogSW5oZXJpdGVkIGFuZCBleHRlbmRlZCBtb2RlbCBmcm9tIFBhcmVudCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ0NoaWxkOiBTYXZpbmcgUGFyZW50IG9yaWdpbicsIF90aGlzNS5wYXJlbnRPcmlnaW4pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ldyBDaGlsZEFQSShfdGhpczUpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZWplY3QoJ0hhbmRzaGFrZSBSZXBseSBGYWlsZWQnKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzNS5jaGlsZC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgc2hha2UsIGZhbHNlKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gTW9kZWw7XG59KCk7XG5cbmV4cG9ydCBkZWZhdWx0IFBvc3RtYXRlO1xuIiwiaW1wb3J0IHsgVWlBcHBDYXBhYmlsaXR5VHlwZSwgVWlBcHBFdmVudFR5cGUgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuXG5pbXBvcnQgeyBDYXBhYmlsaXR5TWFuYWdlciB9IGZyb20gJy4vY2FwYWJpbGl0eU1hbmFnZXInO1xuXG5leHBvcnQgdHlwZSB7IENhcGFiaWxpdHlNYW5hZ2VyIH0gZnJvbSAnLi9jYXBhYmlsaXR5TWFuYWdlcic7XG5cbmNsYXNzIEFwcENvbnRleHRNYW5hZ2VyIGV4dGVuZHMgQ2FwYWJpbGl0eU1hbmFnZXIge1xuICAgIHR5cGUgPSBVaUFwcENhcGFiaWxpdHlUeXBlLkFQUF9DT05URVhUO1xuICAgIGV2ZW50cyA9IFtVaUFwcEV2ZW50VHlwZS5BUFBfQ09OVEVYVF07XG5cbiAgICAvLyBUaGlzIG92ZXJyaWRlIHNob3VsZCBvbmx5IGJlIHVzZWQgZm9yIGFwcF9jb250ZXh0IHNpbmNlIGl0J3MgYWx3YXlzIGVuYWJsZWRcbiAgICBhc3luYyBpc0VuYWJsZWQoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodHJ1ZSk7XG4gICAgfVxuXG4gICAgZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMoKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG59XG5cbmNsYXNzIERhc2hib2FyZENvZ01lbnVNYW5hZ2VyIGV4dGVuZHMgQ2FwYWJpbGl0eU1hbmFnZXIge1xuICAgIHR5cGUgPSBVaUFwcENhcGFiaWxpdHlUeXBlLkRBU0hCT0FSRF9DT0dfTUVOVTtcbiAgICBldmVudHMgPSBbVWlBcHBFdmVudFR5cGUuREFTSEJPQVJEX0NPR19NRU5VX0NPTlRFWFRdO1xuXG4gICAgZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMoKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBjYXBhYmlsaXR5TWFuYWdlcnMgPSBbQXBwQ29udGV4dE1hbmFnZXIsIERhc2hib2FyZENvZ01lbnVNYW5hZ2VyXTtcbiIsImltcG9ydCAqIGFzIFBvc3RtYXRlIGZyb20gJ3Bvc3RtYXRlJztcblxuaW1wb3J0IHR5cGUgeyBERENsaWVudCB9IGZyb20gJy4uL2NsaWVudCc7XG5pbXBvcnQgeyBVaUFwcENhcGFiaWxpdHlUeXBlLCBVaUFwcEV2ZW50VHlwZSB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBnZXRMb2dnZXIsIExvZ2dlciB9IGZyb20gJy4uL2xvZ2dlcic7XG5pbXBvcnQge1xuICAgIEFwcENvbnRleHQsXG4gICAgQ2xpZW50T3B0aW9ucyxcbiAgICBFdmVudEhhbmRsZXIsXG4gICAgSGFuZGxlRXZlbnRQYXJhbXNcbn0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgRGVmZXJyZWQsIHVuaXF1ZUludCB9IGZyb20gJy4uL3V0aWxzJztcblxudHlwZSBTdWJzY3JpcHRpb25zID0ge1xuICAgIFtrZXkgaW4gVWlBcHBFdmVudFR5cGVdOiB7IFtpZDogbnVtYmVyXTogRXZlbnRIYW5kbGVyIH07XG59O1xuXG5jb25zdCBpbml0U3Vic2NyaXB0aW9ucyA9ICgpOiBTdWJzY3JpcHRpb25zID0+IHtcbiAgICBjb25zdCBzdWJjcmlwdGlvbnM6IFBhcnRpYWw8U3Vic2NyaXB0aW9ucz4gPSB7fTtcblxuICAgIE9iamVjdC52YWx1ZXMoVWlBcHBFdmVudFR5cGUpLmZvckVhY2goZXZlbnRUeXBlID0+IHtcbiAgICAgICAgc3ViY3JpcHRpb25zW2V2ZW50VHlwZV0gPSB7fTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdWJjcmlwdGlvbnMgYXMgU3Vic2NyaXB0aW9ucztcbn07XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDYXBhYmlsaXR5TWFuYWdlciB7XG4gICAgYWJzdHJhY3QgdHlwZTogVWlBcHBDYXBhYmlsaXR5VHlwZTtcbiAgICBhYnN0cmFjdCBldmVudHM6IFVpQXBwRXZlbnRUeXBlW107XG5cbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgaG9zdDogc3RyaW5nO1xuICAgIHByb3RlY3RlZCByZWFkb25seSBkZWJ1ZzogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgbG9nZ2VyOiBMb2dnZXI7XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGhhbmRzaGFrZTogUG9zdG1hdGUuTW9kZWw7XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGNvbnRleHQ6IERlZmVycmVkPEFwcENvbnRleHQ+O1xuICAgIHByaXZhdGUgc3Vic2NyaXB0aW9uczoge1xuICAgICAgICBba2V5IGluIFVpQXBwRXZlbnRUeXBlXTogeyBbaWQ6IG51bWJlcl06IEV2ZW50SGFuZGxlciB9O1xuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgb3B0aW9uczogUmVxdWlyZWQ8Q2xpZW50T3B0aW9ucz4sXG4gICAgICAgIGhhbmRzaGFrZTogUG9zdG1hdGUuTW9kZWwsXG4gICAgICAgIGNvbnRleHQ6IERlZmVycmVkPEFwcENvbnRleHQ+XG4gICAgKSB7XG4gICAgICAgIHRoaXMuaG9zdCA9IG9wdGlvbnMuaG9zdDtcbiAgICAgICAgdGhpcy5kZWJ1ZyA9IG9wdGlvbnMuZGVidWc7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gZ2V0TG9nZ2VyKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmhhbmRzaGFrZSA9IGhhbmRzaGFrZTtcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gaW5pdFN1YnNjcmlwdGlvbnMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHBsYWNlIGZvciBldmVudHVhbCBleHRlbnNpb25zIG9mIHRoZSBiYXNlIGNsaWVudCBtZXRob2RzLCBzcGVjaWZpYyB0byBhIGNhcGFiaWxpdHlcbiAgICAgKiBFeGFtcGxlOlxuICAgICAqIHByaXZhdGUgZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMoKTogeyBbbmFtZTogc3RyaW5nXTogRnVuY3Rpb24gfSB7XG4gICAgICogICByZXR1cm4gIHtcbiAgICAgKiAgICAgZ2V0VGltZVNlcmllczogKCkgPT4gdGhpcy5nZXRUaW1lU2VyaWVzKCk7XG4gICAgICogICB9XG4gICAgICogfVxuICAgICAqL1xuICAgIGFic3RyYWN0IGdldEFkZGl0aW9uYWxDbGllbnRNZXRob2RzKCk6IHsgW25hbWU6IHN0cmluZ106IEZ1bmN0aW9uIH07XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcyBhZGRpdGlvbmFsIG1ldGhvZHMgaW4gYSBjaGVjayBhZ2FpbnN0IHRoZSBjYXBhYmlsaXR5IHR5cGUsIHRoZW4gYXBwbGllcyB0byBwcm92aWRlZCBjbGllbnQgb2JqZWN0LiBEbyBub3Qgb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBhcHBseUFkZGl0aW9uYWxNZXRob2RzKGNsaWVudDogRERDbGllbnQpIHtcbiAgICAgICAgY29uc3QgYWRkaXRpb25hbE1ldGhvZHMgPSB0aGlzLmdldEFkZGl0aW9uYWxDbGllbnRNZXRob2RzKCk7XG5cbiAgICAgICAgY29uc3Qgd3JhcHBlZE1ldGhvZHM6IHsgW25hbWU6IHN0cmluZ106IEZ1bmN0aW9uIH0gPSB7fTtcblxuICAgICAgICBPYmplY3QuZW50cmllcyhhZGRpdGlvbmFsTWV0aG9kcykuZm9yRWFjaCgoW2tleSwgbWV0aG9kXSkgPT4ge1xuICAgICAgICAgICAgd3JhcHBlZE1ldGhvZHNba2V5XSA9IGFzeW5jICguLi5hcmdzOiBhbnlbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzRW5hYmxlZCA9IGF3YWl0IHRoaXMuaXNFbmFibGVkKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRob2QoLi4uYXJncyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICBgVGhlICR7dGhpcy50eXBlfSBjYXBhYmlsaXR5IG11c3QgYmUgZW5hYmxlZCB0byBwZXJmb3JtIHRoaXMgYWN0aW9uYFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIE9iamVjdC5hc3NpZ24oY2xpZW50LCB3cmFwcGVkTWV0aG9kcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IHRoZSBjbGllbnQgdG8gcmVnaXN0ZXIgYW4gZXZlbnQgaGFuZGxlciBtYW5hZ2VkIGJ5IHRoaXMgY2FwYWJpbGl0eS4gRG8gbm90IG92ZXJyaWRlXG4gICAgICovXG4gICAgc3Vic2NyaWJlSGFuZGxlcjxUPihcbiAgICAgICAgZXZlbnRUeXBlOiBVaUFwcEV2ZW50VHlwZSxcbiAgICAgICAgaGFuZGxlcjogRXZlbnRIYW5kbGVyPFQ+XG4gICAgKTogKCkgPT4gdm9pZCB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbklkID0gdW5pcXVlSW50KCk7XG5cbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV1bc3Vic2NyaXB0aW9uSWRdID0gaGFuZGxlcjtcblxuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgICAgIFtzdWJzY3JpcHRpb25JZF06IF8sXG4gICAgICAgICAgICAgICAgLi4ub3RoZXJTdWJzY3JpcHRpb25zXG4gICAgICAgICAgICB9ID0gdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV07XG5cbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc1tldmVudFR5cGVdID0gb3RoZXJTdWJzY3JpcHRpb25zO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCBieSB0aGUgY2xpZW50IHRvIGRlbGdhdGUgZXZlbnQgaGFuZGxpbmcuIERvIG5vdCBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIGhhbmRsZUV2ZW50PFQ+KHsgZXZlbnRUeXBlLCBkYXRhIH06IEhhbmRsZUV2ZW50UGFyYW1zPFQ+KSB7XG4gICAgICAgIGNvbnN0IGhhc0hhbmRsZXJzID0gdGhpcy5oYXNIYW5kbGVycyhldmVudFR5cGUpO1xuXG4gICAgICAgIGlmICghaGFzSGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzRW5hYmxlZCA9IGF3YWl0IHRoaXMuaXNFbmFibGVkKCk7XG5cbiAgICAgICAgaWYgKGlzRW5hYmxlZCkge1xuICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9uc1tldmVudFR5cGVdO1xuXG4gICAgICAgICAgICBPYmplY3QudmFsdWVzKHN1YnNjcmlwdGlvbnMpLmZvckVhY2goaGFuZGxlciA9PiBoYW5kbGVyKGRhdGEpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICAgIGBUaGUgJHt0aGlzLnR5cGV9IGNhcGFiaWxpdHkgbXVzdCBiZSBlbmFibGVkIHRvIHJlc3BvbmQgdG8gZXZlbnRzIG9mIHR5cGUgJHtldmVudFR5cGV9LmBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBpc0VuYWJsZWQoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHsgY2FwYWJpbGl0aWVzIH0gPSBhd2FpdCB0aGlzLmNvbnRleHQucHJvbWlzZTtcblxuICAgICAgICByZXR1cm4gY2FwYWJpbGl0aWVzLmluY2x1ZGVzKHRoaXMudHlwZSk7XG4gICAgfVxuXG4gICAgaGFzSGFuZGxlcnMoZXZlbnRUeXBlOiBVaUFwcEV2ZW50VHlwZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISFPYmplY3Qua2V5cyh0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXSkubGVuZ3RoO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=