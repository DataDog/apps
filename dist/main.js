!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DD_SDK=t():e.DD_SDK=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STORAGE_PREFIX=t.UiAppEventType=t.UiAppCapabilityType=t.Host=void 0,function(e){e.PROD="https://app.datadoghq.com/",e.STAGE="https://dd.datad0g.com/"}(t.Host||(t.Host={})),function(e){e.APP_CONTEXT="app_context",e.DASHBOARD_COG_MENU="dashboard_cog_menu"}(t.UiAppCapabilityType||(t.UiAppCapabilityType={})),function(e){e.DASHBOARD_COG_MENU_CONTEXT="dashboard_cog_menu_context"}(t.UiAppEventType||(t.UiAppEventType={})),t.STORAGE_PREFIX="dd_apps_"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLogger=void 0,t.getLogger=e=>e.debug?{log:e=>console.log("dd-apps: "+e),error:e=>console.error("dd-apps: "+e)}:{log(){},error(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueInt=t.defer=void 0,t.defer=()=>{let e=()=>{},t=()=>{};const n=new Promise((n,i)=>{e=n,t=i});return{resolve:e,reject:t,promise:n}};let i=0;t.uniqueInt=()=>(i++,i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const i=n(4);let r;t.init=(e,t)=>(r||(r=new i.DDClient(e)),t&&r.getContext().then(t),r)},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DDClient=void 0;const o=r(n(5)),s=n(6),a=n(0),d=n(1),c=n(2),u={host:a.Host.STAGE,debug:!1};t.DDClient=class{constructor(e={}){this.host=e.host||u.host,this.debug=e.debug||u.debug,this.context=c.defer(),this.logger=d.getLogger(e),o.default.debug=this._debug,this.handshake=new o.default.Model({init:e=>this.init(e),handleEvent:e=>this.handleEvent(e),setSecret:e=>this.setSecret(e)}),this.capabilityManagers=s.capabilityManagers.map(e=>new e({host:this.host,debug:this.debug},this.handshake,this.context)),this.capabilityManagers.forEach(e=>e.applyAdditionalMethods(this))}on(e,t){const n=this.getManagerByEventType(e);return n?n.subscribeHandler(e,t):(this.logger.error("Unknown event type"),()=>{})}getContext(){return i(this,void 0,void 0,(function*(){return this.context.promise}))}getSecret(e){return i(this,void 0,void 0,(function*(){return yield this.context.promise,localStorage.getItem(`${a.STORAGE_PREFIX}${e}`)}))}init(e){return i(this,void 0,void 0,(function*(){yield this.handshake,this.context.resolve(e),this.logger.log("dd-apps: sdk handshake: parent <-> child handshake is complete")}))}handleEvent({eventType:e,data:t}){return i(this,void 0,void 0,(function*(){yield this.context.promise;const n=this.getManagerByEventType(e);n?n.handleEvent({eventType:e,data:t}):this.logger.error("Could not handle event: no corresponding manager found")}))}setSecret({key:e,value:t}){return i(this,void 0,void 0,(function*(){yield this.context.promise,localStorage.setItem(`${a.STORAGE_PREFIX}${e}`,t)}))}getManagerByType(e){return this.capabilityManagers.find(t=>t.type===e)}getManagerByEventType(e){return this.capabilityManagers.find(t=>t.events.includes(e))}}},function(e,t,n){"use strict";n.r(t);
/**
  postmate - A powerful, simple, promise-based postMessage library
  @version v1.6.0
  @link https://github.com/dollarshaveclub/postmate
  @author Jacob Kelley <jakie8@gmail.com>
  @license MIT
**/
var i="application/x-postmate-v1+json",r=0,o={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},s=function(e,t){return("string"!=typeof t||e.origin===t)&&(!!e.data&&(("object"!=typeof e.data||"postmate"in e.data)&&(e.data.type===i&&!!o[e.data.postmate])))},a=function(){function e(e){var t=this;this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.events={},this.listener=function(e){if(!s(e,t.childOrigin))return!1;var n=((e||{}).data||{}).value||{},i=n.data,r=n.name;"emit"===e.data.postmate&&r in t.events&&t.events[r].forEach((function(e){e.call(t,i)}))},this.parent.addEventListener("message",this.listener,!1)}var t=e.prototype;return t.get=function(e){var t=this;return new c.Promise((function(n){var o=++r;t.parent.addEventListener("message",(function e(i){i.data.uid===o&&"reply"===i.data.postmate&&(t.parent.removeEventListener("message",e,!1),n(i.data.value))}),!1),t.child.postMessage({postmate:"request",type:i,property:e,uid:o},t.childOrigin)}))},t.call=function(e,t){this.child.postMessage({postmate:"call",type:i,property:e,data:t},this.childOrigin)},t.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},t.destroy=function(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)},e}(),d=function(){function e(e){var t=this;this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(function(e){if(s(e,t.parentOrigin)){0;var n=e.data,r=n.property,o=n.uid,a=n.data;"call"!==e.data.postmate?function(e,t){var n="function"==typeof e[t]?e[t]():e[t];return c.Promise.resolve(n)}(t.model,r).then((function(t){return e.source.postMessage({property:r,postmate:"reply",type:i,uid:o,value:t},e.origin)})):r in t.model&&"function"==typeof t.model[r]&&t.model[r](a)}}))}return e.prototype.emit=function(e,t){this.parent.postMessage({postmate:"emit",type:i,value:{name:e,data:t}},this.parentOrigin)},e}(),c=function(){function e(e){var t=this,n=e.container,i=void 0===n?void 0!==i?i:document.body:n,r=e.model,o=e.url,s=e.name,a=e.additionalAttributes,d=void 0===a?{}:a,c=e.classListArray,u=void 0===c?[]:c;return this.parent=window,this.frame=document.createElement("iframe"),this.frame.name=s||"",this.frame.classList.add.apply(this.frame.classList,u),Object.keys(d).forEach((function(e){t.frame[e]=d[e]})),i.appendChild(this.frame),this.child=this.frame.contentWindow||this.frame.contentDocument.parentWindow,this.model=r||{},this.sendHandshake(o)}return e.prototype.sendHandshake=function(t){var n,r=this,o=function(e){var t=document.createElement("a");t.href=e;var n=t.protocol.length>4?t.protocol:window.location.protocol,i=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||n+"//"+i}(t),d=0;return new e.Promise((function(e,c){r.parent.addEventListener("message",(function t(i){return!!s(i,o)&&("handshake-reply"===i.data.postmate?(clearInterval(n),r.parent.removeEventListener("message",t,!1),r.childOrigin=i.origin,e(new a(r))):c("Failed handshake"))}),!1);var u=function(){d++,r.child.postMessage({postmate:"handshake",type:i,model:r.model},o),5===d&&clearInterval(n)},l=function(){u(),n=setInterval(u,500)};r.frame.attachEvent?r.frame.attachEvent("onload",l):r.frame.addEventListener("load",l),r.frame.src=t}))},e}();c.debug=!1,c.Promise=function(){try{return window?window.Promise:Promise}catch(e){return null}}(),c.Model=function(){function e(e){return this.child=window,this.model=e,this.parent=this.child.parent,this.sendHandshakeReply()}return e.prototype.sendHandshakeReply=function(){var e=this;return new c.Promise((function(t,n){e.child.addEventListener("message",(function r(o){if(o.data.postmate){if("handshake"===o.data.postmate){0,e.child.removeEventListener("message",r,!1),o.source.postMessage({postmate:"handshake-reply",type:i},o.origin),e.parentOrigin=o.origin;var s=o.data.model;return s&&Object.keys(s).forEach((function(t){e.model[t]=s[t]})),t(new d(e))}return n("Handshake Reply Failed")}}),!1)}))},e}(),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capabilityManagers=void 0;const i=n(0),r=n(7);class o extends r.CapabilityManager{constructor(){super(...arguments),this.type=i.UiAppCapabilityType.DASHBOARD_COG_MENU,this.events=[i.UiAppEventType.DASHBOARD_COG_MENU_CONTEXT]}getAdditionalClientMethods(){return{}}}t.capabilityManagers=[o]},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.CapabilityManager=void 0;const o=n(0),s=n(1),a=n(2);t.CapabilityManager=class{constructor(e,t,n){this.host=e.host,this.debug=e.debug,this.logger=s.getLogger(e),this.handshake=t,this.context=n,this.subscriptions=(()=>{const e={};return Object.values(o.UiAppEventType).forEach(t=>{e[t]={}}),e})()}applyAdditionalMethods(e){const t=this.getAdditionalClientMethods(),n={};Object.entries(t).forEach(([e,t])=>{n[e]=(...e)=>i(this,void 0,void 0,(function*(){if(yield this.isEnabled())return t(...e);this.logger.error(`The ${this.type} capability must be enabled to perform this action`)}))}),Object.assign(e,n)}subscribeHandler(e,t){const n=a.uniqueInt();return this.subscriptions[e][n]=t,()=>{const t=this.subscriptions[e],i=n,o=(t[i],r(t,["symbol"==typeof i?i:i+""]));this.subscriptions[e]=o}}handleEvent({eventType:e,data:t}){return i(this,void 0,void 0,(function*(){if(!this.hasHandlers(e))return;if(yield this.isEnabled()){const n=this.subscriptions[e];Object.values(n).forEach(e=>e(t))}else this.logger.error(`The ${this.type} capability must be enabled to respond to events of type ${e}.`)}))}isEnabled(){return i(this,void 0,void 0,(function*(){const{capabilities:e}=yield this.context.promise;return e.includes(this.type)}))}hasHandlers(e){return!!Object.keys(this.subscriptions[e]).length}}}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ERF9TREsvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0REX1NESy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9ERF9TREsvLi9zcmMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL0REX1NESy8uL3NyYy9sb2dnZXIudHMiLCJ3ZWJwYWNrOi8vRERfU0RLLy4vc3JjL3V0aWxzLnRzIiwid2VicGFjazovL0REX1NESy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly9ERF9TREsvLi9zcmMvY2xpZW50LnRzIiwid2VicGFjazovL0REX1NESy8uL25vZGVfbW9kdWxlcy9wb3N0bWF0ZS9idWlsZC9wb3N0bWF0ZS5lcy5qcyIsIndlYnBhY2s6Ly9ERF9TREsvLi9zcmMvY2FwYWJpbGl0ZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vRERfU0RLLy4vc3JjL2NhcGFiaWxpdGVzL2NhcGFiaWxpdHlNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJIb3N0IiwiVWlBcHBDYXBhYmlsaXR5VHlwZSIsIlVpQXBwRXZlbnRUeXBlIiwiU1RPUkFHRV9QUkVGSVgiLCJnZXRMb2dnZXIiLCJvcHRpb25zIiwiZGVidWciLCJsb2ciLCJtZXNzYWdlIiwiY29uc29sZSIsImVycm9yIiwiZGVmZXIiLCJyZXNvbHZlIiwicmVqZWN0IiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXMiLCJyZWoiLCJpbmNyZW1lbnQiLCJ1bmlxdWVJbnQiLCJjbGllbnQiLCJpbml0IiwiY2FsbGJhY2siLCJERENsaWVudCIsImdldENvbnRleHQiLCJ0aGVuIiwiREVGQVVMVF9PUFRJT05TIiwiaG9zdCIsIlNUQUdFIiwidGhpcyIsImNvbnRleHQiLCJsb2dnZXIiLCJfZGVidWciLCJoYW5kc2hha2UiLCJNb2RlbCIsImhhbmRsZUV2ZW50IiwicGFyYW1zIiwic2V0U2VjcmV0IiwiY2FwYWJpbGl0eU1hbmFnZXJzIiwibWFwIiwiTWFuYWdlciIsImZvckVhY2giLCJtYW5hZ2VyIiwiYXBwbHlBZGRpdGlvbmFsTWV0aG9kcyIsImV2ZW50VHlwZSIsImhhbmRsZXIiLCJnZXRNYW5hZ2VyQnlFdmVudFR5cGUiLCJzdWJzY3JpYmVIYW5kbGVyIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImRhdGEiLCJzZXRJdGVtIiwiY2FwYWJpbGl0eVR5cGUiLCJmaW5kIiwidHlwZSIsImV2ZW50cyIsImluY2x1ZGVzIiwibWVzc2FnZVR5cGUiLCJfbWVzc2FnZUlkIiwibWVzc2FnZVR5cGVzIiwiZW1pdCIsInJlcGx5IiwicmVxdWVzdCIsInNhbml0aXplIiwiYWxsb3dlZE9yaWdpbiIsIm9yaWdpbiIsInBvc3RtYXRlIiwiUGFyZW50QVBJIiwiaW5mbyIsIl90aGlzIiwicGFyZW50IiwiZnJhbWUiLCJjaGlsZCIsImNoaWxkT3JpZ2luIiwibGlzdGVuZXIiLCJlIiwiX3JlZiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfcHJvdG8iLCJfdGhpczIiLCJQb3N0bWF0ZSIsInVpZCIsInRyYW5zYWN0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInBvc3RNZXNzYWdlIiwib24iLCJldmVudE5hbWUiLCJwdXNoIiwiZGVzdHJveSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsIkNoaWxkQVBJIiwiX3RoaXMzIiwibW9kZWwiLCJwYXJlbnRPcmlnaW4iLCJfZSRkYXRhIiwidW53cmFwcGVkQ29udGV4dCIsInJlc29sdmVWYWx1ZSIsInNvdXJjZSIsIl9yZWYyIiwiX3RoaXM0IiwiX3JlZjIkY29udGFpbmVyIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJib2R5IiwidXJsIiwiX3JlZjIkYWRkaXRpb25hbEF0dHJpIiwiYWRkaXRpb25hbEF0dHJpYnV0ZXMiLCJfcmVmMiRjbGFzc0xpc3RBcnJheSIsImNsYXNzTGlzdEFycmF5IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGx5Iiwia2V5cyIsImF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwiY29udGVudFdpbmRvdyIsImNvbnRlbnREb2N1bWVudCIsInBhcmVudFdpbmRvdyIsInNlbmRIYW5kc2hha2UiLCJyZXNwb25zZUludGVydmFsIiwiX3RoaXM1IiwiYSIsImhyZWYiLCJwcm90b2NvbCIsImxlbmd0aCIsImxvY2F0aW9uIiwicG9ydCIsImhvc3RuYW1lIiwicmVzb2x2ZU9yaWdpbiIsImF0dGVtcHQiLCJjbGVhckludGVydmFsIiwiZG9TZW5kIiwibG9hZGVkIiwic2V0SW50ZXJ2YWwiLCJhdHRhY2hFdmVudCIsInNyYyIsInNlbmRIYW5kc2hha2VSZXBseSIsIl90aGlzNiIsInNoYWtlIiwiZGVmYXVsdHMiLCJEYXNoYm9hcmRDb2dNZW51TWFuYWdlciIsIkNhcGFiaWxpdHlNYW5hZ2VyIiwiREFTSEJPQVJEX0NPR19NRU5VIiwiREFTSEJPQVJEX0NPR19NRU5VX0NPTlRFWFQiLCJzdWJzY3JpcHRpb25zIiwic3ViY3JpcHRpb25zIiwidmFsdWVzIiwiaW5pdFN1YnNjcmlwdGlvbnMiLCJhZGRpdGlvbmFsTWV0aG9kcyIsImdldEFkZGl0aW9uYWxDbGllbnRNZXRob2RzIiwid3JhcHBlZE1ldGhvZHMiLCJlbnRyaWVzIiwibWV0aG9kIiwiYXJncyIsImlzRW5hYmxlZCIsImFzc2lnbiIsInN1YnNjcmlwdGlvbklkIiwib3RoZXJTdWJzY3JpcHRpb25zIiwiaGFzSGFuZGxlcnMiLCJjYXBhYmlsaXRpZXMiXSwibWFwcGluZ3MiOiJDQUFBLFNBQTJDQSxFQUFNQyxHQUMxQixpQkFBWkMsU0FBMEMsaUJBQVhDLE9BQ3hDQSxPQUFPRCxRQUFVRCxJQUNRLG1CQUFYRyxRQUF5QkEsT0FBT0MsSUFDOUNELE9BQU8sR0FBSUgsR0FDZSxpQkFBWkMsUUFDZEEsUUFBZ0IsT0FBSUQsSUFFcEJELEVBQWEsT0FBSUMsSUFSbkIsQ0FTR0ssUUFBUSxXQUNYLE8sWUNURSxJQUFJQyxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVUCxRQUduQyxJQUFJQyxFQUFTSSxFQUFpQkUsR0FBWSxDQUN6Q0MsRUFBR0QsRUFDSEUsR0FBRyxFQUNIVCxRQUFTLElBVVYsT0FOQVUsRUFBUUgsR0FBVUksS0FBS1YsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU00sR0FHL0RMLEVBQU9RLEdBQUksRUFHSlIsRUFBT0QsUUEwRGYsT0FyREFNLEVBQW9CTSxFQUFJRixFQUd4QkosRUFBb0JPLEVBQUlSLEVBR3hCQyxFQUFvQlEsRUFBSSxTQUFTZCxFQUFTZSxFQUFNQyxHQUMzQ1YsRUFBb0JXLEVBQUVqQixFQUFTZSxJQUNsQ0csT0FBT0MsZUFBZW5CLEVBQVNlLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVYsRUFBb0JnQixFQUFJLFNBQVN0QixHQUNYLG9CQUFYdUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlbkIsRUFBU3VCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZW5CLEVBQVMsYUFBYyxDQUFFeUIsT0FBTyxLQVF2RG5CLEVBQW9Cb0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFuQixFQUFvQm1CLElBQy9CLEVBQVBF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RUFBQ2tILEVBQ0VDLEdBRGdCLEtBQ0UsSUFGbkIsOEJBS05sSSxLQUFLcUgsY0FBY3RHLEdBQWFtSCxHQU9sQyxhQUFlLFVBQUVuSCxFQUFTLEtBQUVNLEkseUNBRzlCLElBRm9CckIsS0FBS21JLFlBQVlwSCxHQUdqQyxPQUtKLFNBRndCZixLQUFLK0gsWUFFZCxDQUNYLE1BQU1WLEVBQWdCckgsS0FBS3FILGNBQWN0RyxHQUV6Q2xFLE9BQU8wSyxPQUFPRixHQUFlekcsUUFBUUksR0FBV0EsRUFBUUssU0FFeERyQixLQUFLRSxPQUFPckIsTUFDUixPQUFPbUIsS0FBS3lCLGdFQUFnRVYsU0FLbEYsWSx5Q0FDRixNQUFNLGFBQUVxSCxTQUF1QnBJLEtBQUtDLFFBQVFoQixRQUU1QyxPQUFPbUosRUFBYXpHLFNBQVMzQixLQUFLeUIsU0FHdEMsWUFBWVYsR0FDUixRQUFTbEUsT0FBT3dJLEtBQUtyRixLQUFLcUgsY0FBY3RHLElBQVlrRiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiRERfU0RLXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkREX1NES1wiXSA9IGZhY3RvcnkoKTtcbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiZXhwb3J0IGVudW0gSG9zdCB7XG4gICAgUFJPRCA9ICdodHRwczovL2FwcC5kYXRhZG9naHEuY29tLycsXG4gICAgU1RBR0UgPSAnaHR0cHM6Ly9kZC5kYXRhZDBnLmNvbS8nXG59XG5cbmV4cG9ydCBlbnVtIFVpQXBwQ2FwYWJpbGl0eVR5cGUge1xuICAgIEFQUF9DT05URVhUID0gJ2FwcF9jb250ZXh0JyxcbiAgICBEQVNIQk9BUkRfQ09HX01FTlUgPSAnZGFzaGJvYXJkX2NvZ19tZW51J1xufVxuXG5leHBvcnQgZW51bSBVaUFwcEV2ZW50VHlwZSB7XG4gICAgREFTSEJPQVJEX0NPR19NRU5VX0NPTlRFWFQgPSAnZGFzaGJvYXJkX2NvZ19tZW51X2NvbnRleHQnXG59XG5cbmV4cG9ydCBjb25zdCBTVE9SQUdFX1BSRUZJWCA9ICdkZF9hcHBzXyc7XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1jb25zb2xlICovXG5pbXBvcnQgeyBDbGllbnRPcHRpb25zIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyIHtcbiAgICBsb2cobWVzc2FnZTogc3RyaW5nKTogdm9pZDtcbiAgICBlcnJvcihtZXNzYWdlOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5leHBvcnQgY29uc3QgZ2V0TG9nZ2VyID0gKG9wdGlvbnM6IENsaWVudE9wdGlvbnMpOiBMb2dnZXIgPT4ge1xuICAgIGlmIChvcHRpb25zLmRlYnVnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsb2cobWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGBkZC1hcHBzOiAke21lc3NhZ2V9YCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3IobWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUuZXJyb3IoYGRkLWFwcHM6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbG9nKCkge30sXG4gICAgICAgICAgICBlcnJvcigpIHt9XG4gICAgICAgIH07XG4gICAgfVxufTtcbiIsImV4cG9ydCBpbnRlcmZhY2UgRGVmZXJyZWQ8VD4ge1xuICAgIHJlc29sdmU6ICh0OiBUKSA9PiB2b2lkO1xuICAgIHJlamVjdDogKHQ6IFQpID0+IHZvaWQ7XG4gICAgcHJvbWlzZTogUHJvbWlzZTxUPjtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgZGVmZmVycmVkIG9iamVjdCwgaW5jbHVkaW5nIHByb21pc2UgYW5kIHJlc29sdmUgKyByZWplY3QgbWV0aG9kcyB0byBiZSBleGVjdXRlZCBsYXRlclxuICovXG5leHBvcnQgY29uc3QgZGVmZXIgPSA8VD4oKTogRGVmZXJyZWQ8VD4gPT4ge1xuICAgIGxldCByZXNvbHZlOiAodDogVCkgPT4gdm9pZCA9ICgpID0+IHt9O1xuICAgIGxldCByZWplY3Q6ICh0OiBUKSA9PiB2b2lkID0gKCkgPT4ge307XG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlPFQ+KChyZXMsIHJlaikgPT4ge1xuICAgICAgICByZXNvbHZlID0gcmVzO1xuICAgICAgICByZWplY3QgPSByZWo7XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXNvbHZlLFxuICAgICAgICByZWplY3QsXG4gICAgICAgIHByb21pc2VcbiAgICB9O1xufTtcblxubGV0IGluY3JlbWVudDogbnVtYmVyID0gMDtcblxuLy8gZ2VuZXJhdGVzIGFuIGludGVnZXIsIGd1YXJhbnRlZWQgdG8gYmUgdW5pcXVlIGJlY3Vhc2UgaXQncyBpbmNyZW1lbnRlZCA6KVxuZXhwb3J0IGNvbnN0IHVuaXF1ZUludCA9ICgpOiBudW1iZXIgPT4ge1xuICAgIGluY3JlbWVudCsrO1xuXG4gICAgcmV0dXJuIGluY3JlbWVudDtcbn07XG4iLCJpbXBvcnQgeyBERENsaWVudCB9IGZyb20gJy4vY2xpZW50JztcbmltcG9ydCB7IEFwcENvbnRleHQsIENsaWVudE9wdGlvbnMgfSBmcm9tICcuL3R5cGVzJztcblxubGV0IGNsaWVudDogRERDbGllbnQ7XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYSBjbGllbnQsIG9yIHJldHVybnMgYW4gZXhpc3Rpbmcgb25lIGlmIGFscmVhZHkgaW5pdGlhbGl6ZWQuIFVzZXIgY2FuIHByb3ZpZGUgYW4gb3B0aW9uYWxcbiAqIGNhbGxiYWNrIHRvIGJlIGV4ZWN1dGVkIHdpdGggYXBwIGNvbnRleHQgZGF0YSB3aGVuIGl0IGlzIHNlbnQgZnJvbSB0aGUgcGFyZW50LlxuICovXG5leHBvcnQgY29uc3QgaW5pdCA9IChcbiAgICBvcHRpb25zPzogQ2xpZW50T3B0aW9ucyxcbiAgICBjYWxsYmFjaz86IChjb250ZXh0OiBBcHBDb250ZXh0KSA9PiB2b2lkXG4pOiBERENsaWVudCA9PiB7XG4gICAgaWYgKCFjbGllbnQpIHtcbiAgICAgICAgY2xpZW50ID0gbmV3IEREQ2xpZW50KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICBjbGllbnQuZ2V0Q29udGV4dCgpLnRoZW4oY2FsbGJhY2spO1xuICAgIH1cblxuICAgIHJldHVybiBjbGllbnQ7XG59O1xuIiwiaW1wb3J0IFBvc3RtYXRlIGZyb20gJ3Bvc3RtYXRlJztcblxuaW1wb3J0IHsgQ2FwYWJpbGl0eU1hbmFnZXIgfSBmcm9tICcuL2NhcGFiaWxpdGVzL2NhcGFiaWxpdHlNYW5hZ2VyJztcbmltcG9ydCB7IGNhcGFiaWxpdHlNYW5hZ2VycyB9IGZyb20gJy4vY2FwYWJpbGl0ZXMnO1xuaW1wb3J0IHtcbiAgICBIb3N0LFxuICAgIFVpQXBwQ2FwYWJpbGl0eVR5cGUsXG4gICAgVWlBcHBFdmVudFR5cGUsXG4gICAgU1RPUkFHRV9QUkVGSVhcbn0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyLCBMb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQge1xuICAgIEFwcENvbnRleHQsXG4gICAgRXZlbnRIYW5kbGVyLFxuICAgIEhhbmRsZUV2ZW50UGFyYW1zLFxuICAgIENsaWVudE9wdGlvbnMsXG4gICAgU2V0U2VjcmV0UGFyYW1zXG59IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgRGVmZXJyZWQsIGRlZmVyIH0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgICBob3N0OiBIb3N0LlNUQUdFLFxuICAgIGRlYnVnOiBmYWxzZVxufTtcblxuZXhwb3J0IGNsYXNzIEREQ2xpZW50IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhvc3Q6IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlYnVnOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgaGFuZHNoYWtlOiBQb3N0bWF0ZS5Nb2RlbDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ2dlcjogTG9nZ2VyO1xuICAgIHByaXZhdGUgY29udGV4dDogRGVmZXJyZWQ8QXBwQ29udGV4dD47XG4gICAgcHJpdmF0ZSBjYXBhYmlsaXR5TWFuYWdlcnM6IENhcGFiaWxpdHlNYW5hZ2VyW107XG5cbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zOiBDbGllbnRPcHRpb25zID0ge30pIHtcbiAgICAgICAgdGhpcy5ob3N0ID0gb3B0aW9ucy5ob3N0IHx8IERFRkFVTFRfT1BUSU9OUy5ob3N0O1xuICAgICAgICB0aGlzLmRlYnVnID0gb3B0aW9ucy5kZWJ1ZyB8fCBERUZBVUxUX09QVElPTlMuZGVidWc7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGRlZmVyKCk7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gZ2V0TG9nZ2VyKG9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgUG9zdG1hdGUuZGVidWcgPSB0aGlzLl9kZWJ1ZztcblxuICAgICAgICB0aGlzLmhhbmRzaGFrZSA9IG5ldyBQb3N0bWF0ZS5Nb2RlbCh7XG4gICAgICAgICAgICBpbml0OiAoY29udGV4dDogQXBwQ29udGV4dCkgPT4gdGhpcy5pbml0KGNvbnRleHQpLFxuICAgICAgICAgICAgaGFuZGxlRXZlbnQ6IChwYXJhbXM6IEhhbmRsZUV2ZW50UGFyYW1zKSA9PlxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlRXZlbnQocGFyYW1zKSxcbiAgICAgICAgICAgIHNldFNlY3JldDogKHBhcmFtczogU2V0U2VjcmV0UGFyYW1zKSA9PiB0aGlzLnNldFNlY3JldChwYXJhbXMpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY2FwYWJpbGl0eU1hbmFnZXJzID0gY2FwYWJpbGl0eU1hbmFnZXJzLm1hcChcbiAgICAgICAgICAgIE1hbmFnZXIgPT5cbiAgICAgICAgICAgICAgICBuZXcgTWFuYWdlcihcbiAgICAgICAgICAgICAgICAgICAgeyBob3N0OiB0aGlzLmhvc3QsIGRlYnVnOiB0aGlzLmRlYnVnIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZHNoYWtlLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHRcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5jYXBhYmlsaXR5TWFuYWdlcnMuZm9yRWFjaChtYW5hZ2VyID0+XG4gICAgICAgICAgICBtYW5hZ2VyLmFwcGx5QWRkaXRpb25hbE1ldGhvZHModGhpcylcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGV2ZW50IGhhbmRsZXIgdG8gZXhlY3V0ZSBvbiBhIGNlcnRhaW4gZXZlbnQgdHlwZSBmcm9tIHRoZSBwYXJlbnQuIFdpbGwgcHJpbnRcbiAgICAgKiBhbiBlcnJvciBpZiB0aGUgaW5zdGFsbGVkIGFwcCBkb2VzIG5vdCBoYXZlIHRoZSByZXF1aXJlZCBjYXBhYmlsaXR5LiBSZXR1cm5zIGFuIHVuc3Vic2NyaWJlXG4gICAgICogbWV0aG9kLiBUaGlzIG1ldGhvZCBjYW4gYmUgY2FsbGVkIGJlZm9yZSBoYW5kc2hha2UgaXMgc3VjY2Vzc2Z1bCwgYnV0IGhhbmRsZXJzIHdpbGwgbm90IGV4ZWN1dGUgdW50aWxcbiAgICAgKiBhZnRlciBzdWNjZXNzc2Z1bCBoYW5kc2hha2UuXG4gICAgICovXG4gICAgb248VCA9IGFueT4oXG4gICAgICAgIGV2ZW50VHlwZTogVWlBcHBFdmVudFR5cGUsXG4gICAgICAgIGhhbmRsZXI6IEV2ZW50SGFuZGxlcjxUPlxuICAgICk6ICgpID0+IHZvaWQge1xuICAgICAgICBjb25zdCBtYW5hZ2VyID0gdGhpcy5nZXRNYW5hZ2VyQnlFdmVudFR5cGUoZXZlbnRUeXBlKTtcblxuICAgICAgICBpZiAoIW1hbmFnZXIpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdVbmtub3duIGV2ZW50IHR5cGUnKTtcblxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1hbmFnZXIuc3Vic2NyaWJlSGFuZGxlcjxUPihldmVudFR5cGUsIGhhbmRsZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYXBwIGNvbnRleHQgZGF0YSwgYWZ0ZXIgaXQgaXMgc2VudCBmcm9tIHRoZSBwYXJlbnRcbiAgICAgKi9cbiAgICBhc3luYyBnZXRDb250ZXh0KCk6IFByb21pc2U8QXBwQ29udGV4dD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnByb21pc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmFsdWUgb2YgYSBzZWNyZXQuIFJldHVybnMgbnVsbCBpZiBzZWNyZXQgaXMgbm90IGRlZmluZWRcbiAgICAgKi9cbiAgICBhc3luYyBnZXRTZWNyZXQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5jb250ZXh0LnByb21pc2U7XG5cbiAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGAke1NUT1JBR0VfUFJFRklYfSR7a2V5fWApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGluaXQgbWV0aG9kIGlzIGV4cG9zZWQgaW4gdGhlIHBvc3RtYXRlIG1vZGVsLiBJdCBtdXN0IGJlIGNhbGxlZCBiZWZvcmUgb3RoZXIgb3BlcmF0aW9ucyBtYXkgcHJvY2VlZCxcbiAgICAgKiBpbiBvcmRlciB0byBpbmZvcm0gY2xpZW50IG9mIGFwcCBjb250ZXh0XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBpbml0KGNvbnRleHQ6IEFwcENvbnRleHQpIHtcbiAgICAgICAgLy8gcGFyZW50IHNob3VsZCBvbmx5IGJlIGFibGUgdG8gY2FsbCB0aGlzIGFmdGVyIGhhbmRzaGFrZSBpcyBjb21wbGV0ZSwgYnV0IGl0cyB3b3J0aCBhIGNoZWNrIGFueXdheXNcbiAgICAgICAgYXdhaXQgdGhpcy5oYW5kc2hha2U7XG5cbiAgICAgICAgdGhpcy5jb250ZXh0LnJlc29sdmUoY29udGV4dCk7XG5cbiAgICAgICAgdGhpcy5sb2dnZXIubG9nKFxuICAgICAgICAgICAgJ2RkLWFwcHM6IHNkayBoYW5kc2hha2U6IHBhcmVudCA8LT4gY2hpbGQgaGFuZHNoYWtlIGlzIGNvbXBsZXRlJ1xuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGhhbmRsZUV2ZW50IGlzIHRoZSBtYWluIG1ldGhvZCBjYWxsZWQgYnkgdGhlIHBhcmVudCB0aHJvdWdoIHBvc3RtYXRlIChjaGlsZC5oYW5kbGVFdmVudCgnZXhlYycsIHsuLi59KSkuXG4gICAgICogSXQgYWNjZXB0cyBhIGtleWVkIGV2ZW50IHR5cGUgYW5kIGFyYml0cmFyeSBkYXRhIHRvIGJlIHBhc3NlZCB0byBldmVudCBoYW5kbGVycy4gSXQgd2lsbCBsb2cgYW4gZXJyb3JcbiAgICAgKiBtZXNzYWdlIGlmIHRoZSB1c2VyIGRvZXMgbm90IGhhdmUgdGhlIHJlcXVpcmVkIGNhcGFiaWxpdHkgZW5hYmxlZFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaGFuZGxlRXZlbnQ8VD4oeyBldmVudFR5cGUsIGRhdGEgfTogSGFuZGxlRXZlbnRQYXJhbXM8VD4pIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jb250ZXh0LnByb21pc2U7XG5cbiAgICAgICAgY29uc3QgbWFuYWdlciA9IHRoaXMuZ2V0TWFuYWdlckJ5RXZlbnRUeXBlKGV2ZW50VHlwZSk7XG5cbiAgICAgICAgaWYgKCFtYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgICAgICAnQ291bGQgbm90IGhhbmRsZSBldmVudDogbm8gY29ycmVzcG9uZGluZyBtYW5hZ2VyIGZvdW5kJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbWFuYWdlci5oYW5kbGVFdmVudCh7IGV2ZW50VHlwZSwgZGF0YSB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHNldFNlY3JldCh7IGtleSwgdmFsdWUgfTogeyBrZXk6IHN0cmluZzsgdmFsdWU6IHN0cmluZyB9KSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY29udGV4dC5wcm9taXNlO1xuXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGAke1NUT1JBR0VfUFJFRklYfSR7a2V5fWAsIHZhbHVlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldE1hbmFnZXJCeVR5cGUoXG4gICAgICAgIGNhcGFiaWxpdHlUeXBlOiBVaUFwcENhcGFiaWxpdHlUeXBlXG4gICAgKTogQ2FwYWJpbGl0eU1hbmFnZXIgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5jYXBhYmlsaXR5TWFuYWdlcnMuZmluZChcbiAgICAgICAgICAgIG1hbmFnZXIgPT4gbWFuYWdlci50eXBlID09PSBjYXBhYmlsaXR5VHlwZVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0TWFuYWdlckJ5RXZlbnRUeXBlKFxuICAgICAgICBldmVudFR5cGU6IFVpQXBwRXZlbnRUeXBlXG4gICAgKTogQ2FwYWJpbGl0eU1hbmFnZXIgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5jYXBhYmlsaXR5TWFuYWdlcnMuZmluZChtYW5hZ2VyID0+XG4gICAgICAgICAgICBtYW5hZ2VyLmV2ZW50cy5pbmNsdWRlcyhldmVudFR5cGUpXG4gICAgICAgICk7XG4gICAgfVxufVxuIiwiLyoqXG4gIHBvc3RtYXRlIC0gQSBwb3dlcmZ1bCwgc2ltcGxlLCBwcm9taXNlLWJhc2VkIHBvc3RNZXNzYWdlIGxpYnJhcnlcbiAgQHZlcnNpb24gdjEuNi4wXG4gIEBsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9kb2xsYXJzaGF2ZWNsdWIvcG9zdG1hdGVcbiAgQGF1dGhvciBKYWNvYiBLZWxsZXkgPGpha2llOEBnbWFpbC5jb20+XG4gIEBsaWNlbnNlIE1JVFxuKiovXG4vKipcbiAqIFRoZSB0eXBlIG9mIG1lc3NhZ2VzIG91ciBmcmFtZXMgb3VyIHNlbmRpbmdcbiAqIEB0eXBlIHtTdHJpbmd9XG4gKi9cbnZhciBtZXNzYWdlVHlwZSA9ICdhcHBsaWNhdGlvbi94LXBvc3RtYXRlLXYxK2pzb24nO1xuLyoqXG4gKiBUaGUgbWF4aW11bSBudW1iZXIgb2YgYXR0ZW1wdHMgdG8gc2VuZCBhIGhhbmRzaGFrZSByZXF1ZXN0IHRvIHRoZSBwYXJlbnRcbiAqIEB0eXBlIHtOdW1iZXJ9XG4gKi9cblxudmFyIG1heEhhbmRzaGFrZVJlcXVlc3RzID0gNTtcbi8qKlxuICogQSB1bmlxdWUgbWVzc2FnZSBJRCB0aGF0IGlzIHVzZWQgdG8gZW5zdXJlIHJlc3BvbnNlcyBhcmUgc2VudCB0byB0aGUgY29ycmVjdCByZXF1ZXN0c1xuICogQHR5cGUge051bWJlcn1cbiAqL1xuXG52YXIgX21lc3NhZ2VJZCA9IDA7XG4vKipcbiAqIEluY3JlbWVudHMgYW5kIHJldHVybnMgYSBtZXNzYWdlIElEXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IEEgdW5pcXVlIElEIGZvciBhIG1lc3NhZ2VcbiAqL1xuXG52YXIgZ2VuZXJhdGVOZXdNZXNzYWdlSWQgPSBmdW5jdGlvbiBnZW5lcmF0ZU5ld01lc3NhZ2VJZCgpIHtcbiAgcmV0dXJuICsrX21lc3NhZ2VJZDtcbn07XG4vKipcbiAqIFBvc3RtYXRlIGxvZ2dpbmcgZnVuY3Rpb24gdGhhdCBlbmFibGVzL2Rpc2FibGVzIHZpYSBjb25maWdcbiAqIEBwYXJhbSAge09iamVjdH0gLi4uYXJncyBSZXN0IEFyZ3VtZW50c1xuICovXG5cbnZhciBsb2cgPSBmdW5jdGlvbiBsb2coKSB7XG4gIHZhciBfY29uc29sZTtcblxuICByZXR1cm4gUG9zdG1hdGUuZGVidWcgPyAoX2NvbnNvbGUgPSBjb25zb2xlKS5sb2cuYXBwbHkoX2NvbnNvbGUsIGFyZ3VtZW50cykgOiBudWxsO1xufTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG5cbi8qKlxuICogVGFrZXMgYSBVUkwgYW5kIHJldHVybnMgdGhlIG9yaWdpblxuICogQHBhcmFtICB7U3RyaW5nfSB1cmwgVGhlIGZ1bGwgVVJMIGJlaW5nIHJlcXVlc3RlZFxuICogQHJldHVybiB7U3RyaW5nfSAgICAgVGhlIFVSTHMgb3JpZ2luXG4gKi9cblxudmFyIHJlc29sdmVPcmlnaW4gPSBmdW5jdGlvbiByZXNvbHZlT3JpZ2luKHVybCkge1xuICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgYS5ocmVmID0gdXJsO1xuICB2YXIgcHJvdG9jb2wgPSBhLnByb3RvY29sLmxlbmd0aCA+IDQgPyBhLnByb3RvY29sIDogd2luZG93LmxvY2F0aW9uLnByb3RvY29sO1xuICB2YXIgaG9zdCA9IGEuaG9zdC5sZW5ndGggPyBhLnBvcnQgPT09ICc4MCcgfHwgYS5wb3J0ID09PSAnNDQzJyA/IGEuaG9zdG5hbWUgOiBhLmhvc3QgOiB3aW5kb3cubG9jYXRpb24uaG9zdDtcbiAgcmV0dXJuIGEub3JpZ2luIHx8IHByb3RvY29sICsgXCIvL1wiICsgaG9zdDtcbn07XG52YXIgbWVzc2FnZVR5cGVzID0ge1xuICBoYW5kc2hha2U6IDEsXG4gICdoYW5kc2hha2UtcmVwbHknOiAxLFxuICBjYWxsOiAxLFxuICBlbWl0OiAxLFxuICByZXBseTogMSxcbiAgcmVxdWVzdDogMVxuICAvKipcbiAgICogRW5zdXJlcyB0aGF0IGEgbWVzc2FnZSBpcyBzYWZlIHRvIGludGVycHJldFxuICAgKiBAcGFyYW0gIHtPYmplY3R9IG1lc3NhZ2UgVGhlIHBvc3RtYXRlIG1lc3NhZ2UgYmVpbmcgc2VudFxuICAgKiBAcGFyYW0gIHtTdHJpbmd8Qm9vbGVhbn0gYWxsb3dlZE9yaWdpbiBUaGUgd2hpdGVsaXN0ZWQgb3JpZ2luIG9yIGZhbHNlIHRvIHNraXAgb3JpZ2luIGNoZWNrXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAqL1xuXG59O1xudmFyIHNhbml0aXplID0gZnVuY3Rpb24gc2FuaXRpemUobWVzc2FnZSwgYWxsb3dlZE9yaWdpbikge1xuICBpZiAodHlwZW9mIGFsbG93ZWRPcmlnaW4gPT09ICdzdHJpbmcnICYmIG1lc3NhZ2Uub3JpZ2luICE9PSBhbGxvd2VkT3JpZ2luKSByZXR1cm4gZmFsc2U7XG4gIGlmICghbWVzc2FnZS5kYXRhKSByZXR1cm4gZmFsc2U7XG4gIGlmICh0eXBlb2YgbWVzc2FnZS5kYXRhID09PSAnb2JqZWN0JyAmJiAhKCdwb3N0bWF0ZScgaW4gbWVzc2FnZS5kYXRhKSkgcmV0dXJuIGZhbHNlO1xuICBpZiAobWVzc2FnZS5kYXRhLnR5cGUgIT09IG1lc3NhZ2VUeXBlKSByZXR1cm4gZmFsc2U7XG4gIGlmICghbWVzc2FnZVR5cGVzW21lc3NhZ2UuZGF0YS5wb3N0bWF0ZV0pIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIHRydWU7XG59O1xuLyoqXG4gKiBUYWtlcyBhIG1vZGVsLCBhbmQgc2VhcmNoZXMgZm9yIGEgdmFsdWUgYnkgdGhlIHByb3BlcnR5XG4gKiBAcGFyYW0gIHtPYmplY3R9IG1vZGVsICAgICBUaGUgZGljdGlvbmFyeSB0byBzZWFyY2ggYWdhaW5zdFxuICogQHBhcmFtICB7U3RyaW5nfSBwcm9wZXJ0eSAgQSBwYXRoIHdpdGhpbiBhIGRpY3Rpb25hcnkgKGkuZS4gJ3dpbmRvdy5sb2NhdGlvbi5ocmVmJylcbiAqIEBwYXJhbSAge09iamVjdH0gZGF0YSAgICAgIEFkZGl0aW9uYWwgaW5mb3JtYXRpb24gZnJvbSB0aGUgZ2V0IHJlcXVlc3QgdGhhdCBpc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc2VkIHRvIGZ1bmN0aW9ucyBpbiB0aGUgY2hpbGQgbW9kZWxcbiAqIEByZXR1cm4ge1Byb21pc2V9XG4gKi9cblxudmFyIHJlc29sdmVWYWx1ZSA9IGZ1bmN0aW9uIHJlc29sdmVWYWx1ZShtb2RlbCwgcHJvcGVydHkpIHtcbiAgdmFyIHVud3JhcHBlZENvbnRleHQgPSB0eXBlb2YgbW9kZWxbcHJvcGVydHldID09PSAnZnVuY3Rpb24nID8gbW9kZWxbcHJvcGVydHldKCkgOiBtb2RlbFtwcm9wZXJ0eV07XG4gIHJldHVybiBQb3N0bWF0ZS5Qcm9taXNlLnJlc29sdmUodW53cmFwcGVkQ29udGV4dCk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBhbiBBUEkgdG8gYmUgdXNlZCBieSB0aGUgcGFyZW50XG4gKiBAcGFyYW0ge09iamVjdH0gaW5mbyBJbmZvcm1hdGlvbiBvbiB0aGUgY29uc3VtZXJcbiAqL1xuXG52YXIgUGFyZW50QVBJID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUGFyZW50QVBJKGluZm8pIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgdGhpcy5wYXJlbnQgPSBpbmZvLnBhcmVudDtcbiAgICB0aGlzLmZyYW1lID0gaW5mby5mcmFtZTtcbiAgICB0aGlzLmNoaWxkID0gaW5mby5jaGlsZDtcbiAgICB0aGlzLmNoaWxkT3JpZ2luID0gaW5mby5jaGlsZE9yaWdpbjtcbiAgICB0aGlzLmV2ZW50cyA9IHt9O1xuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGxvZygnUGFyZW50OiBSZWdpc3RlcmluZyBBUEknKTtcbiAgICAgIGxvZygnUGFyZW50OiBBd2FpdGluZyBtZXNzYWdlcy4uLicpO1xuICAgIH1cblxuICAgIHRoaXMubGlzdGVuZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCFzYW5pdGl6ZShlLCBfdGhpcy5jaGlsZE9yaWdpbikpIHJldHVybiBmYWxzZTtcbiAgICAgIC8qKlxuICAgICAgICogdGhlIGFzc2lnbm1lbnRzIGJlbG93IGVuc3VyZXMgdGhhdCBlLCBkYXRhLCBhbmQgdmFsdWUgYXJlIGFsbCBkZWZpbmVkXG4gICAgICAgKi9cblxuICAgICAgdmFyIF9yZWYgPSAoKGUgfHwge30pLmRhdGEgfHwge30pLnZhbHVlIHx8IHt9LFxuICAgICAgICAgIGRhdGEgPSBfcmVmLmRhdGEsXG4gICAgICAgICAgbmFtZSA9IF9yZWYubmFtZTtcblxuICAgICAgaWYgKGUuZGF0YS5wb3N0bWF0ZSA9PT0gJ2VtaXQnKSB7XG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgbG9nKFwiUGFyZW50OiBSZWNlaXZlZCBldmVudCBlbWlzc2lvbjogXCIgKyBuYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuYW1lIGluIF90aGlzLmV2ZW50cykge1xuICAgICAgICAgIF90aGlzLmV2ZW50c1tuYW1lXS5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2suY2FsbChfdGhpcywgZGF0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMubGlzdGVuZXIsIGZhbHNlKTtcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBsb2coJ1BhcmVudDogQXdhaXRpbmcgZXZlbnQgZW1pc3Npb25zIGZyb20gQ2hpbGQnKTtcbiAgICB9XG4gIH1cblxuICB2YXIgX3Byb3RvID0gUGFyZW50QVBJLnByb3RvdHlwZTtcblxuICBfcHJvdG8uZ2V0ID0gZnVuY3Rpb24gZ2V0KHByb3BlcnR5KSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFBvc3RtYXRlLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgIC8vIEV4dHJhY3QgZGF0YSBmcm9tIHJlc3BvbnNlIGFuZCBraWxsIGxpc3RlbmVyc1xuICAgICAgdmFyIHVpZCA9IGdlbmVyYXRlTmV3TWVzc2FnZUlkKCk7XG5cbiAgICAgIHZhciB0cmFuc2FjdCA9IGZ1bmN0aW9uIHRyYW5zYWN0KGUpIHtcbiAgICAgICAgaWYgKGUuZGF0YS51aWQgPT09IHVpZCAmJiBlLmRhdGEucG9zdG1hdGUgPT09ICdyZXBseScpIHtcbiAgICAgICAgICBfdGhpczIucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0cmFuc2FjdCwgZmFsc2UpO1xuXG4gICAgICAgICAgcmVzb2x2ZShlLmRhdGEudmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9OyAvLyBQcmVwYXJlIGZvciByZXNwb25zZSBmcm9tIENoaWxkLi4uXG5cblxuICAgICAgX3RoaXMyLnBhcmVudC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdHJhbnNhY3QsIGZhbHNlKTsgLy8gVGhlbiBhc2sgY2hpbGQgZm9yIGluZm9ybWF0aW9uXG5cblxuICAgICAgX3RoaXMyLmNoaWxkLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgcG9zdG1hdGU6ICdyZXF1ZXN0JyxcbiAgICAgICAgdHlwZTogbWVzc2FnZVR5cGUsXG4gICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcbiAgICAgICAgdWlkOiB1aWRcbiAgICAgIH0sIF90aGlzMi5jaGlsZE9yaWdpbik7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLmNhbGwgPSBmdW5jdGlvbiBjYWxsKHByb3BlcnR5LCBkYXRhKSB7XG4gICAgLy8gU2VuZCBpbmZvcm1hdGlvbiB0byB0aGUgY2hpbGRcbiAgICB0aGlzLmNoaWxkLnBvc3RNZXNzYWdlKHtcbiAgICAgIHBvc3RtYXRlOiAnY2FsbCcsXG4gICAgICB0eXBlOiBtZXNzYWdlVHlwZSxcbiAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcbiAgICAgIGRhdGE6IGRhdGFcbiAgICB9LCB0aGlzLmNoaWxkT3JpZ2luKTtcbiAgfTtcblxuICBfcHJvdG8ub24gPSBmdW5jdGlvbiBvbihldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCF0aGlzLmV2ZW50c1tldmVudE5hbWVdKSB7XG4gICAgICB0aGlzLmV2ZW50c1tldmVudE5hbWVdID0gW107XG4gICAgfVxuXG4gICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXS5wdXNoKGNhbGxiYWNrKTtcbiAgfTtcblxuICBfcHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGxvZygnUGFyZW50OiBEZXN0cm95aW5nIFBvc3RtYXRlIGluc3RhbmNlJyk7XG4gICAgfVxuXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmxpc3RlbmVyLCBmYWxzZSk7XG4gICAgdGhpcy5mcmFtZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZnJhbWUpO1xuICB9O1xuXG4gIHJldHVybiBQYXJlbnRBUEk7XG59KCk7XG4vKipcbiAqIENvbXBvc2VzIGFuIEFQSSB0byBiZSB1c2VkIGJ5IHRoZSBjaGlsZFxuICogQHBhcmFtIHtPYmplY3R9IGluZm8gSW5mb3JtYXRpb24gb24gdGhlIGNvbnN1bWVyXG4gKi9cblxudmFyIENoaWxkQVBJID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ2hpbGRBUEkoaW5mbykge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdGhpcy5tb2RlbCA9IGluZm8ubW9kZWw7XG4gICAgdGhpcy5wYXJlbnQgPSBpbmZvLnBhcmVudDtcbiAgICB0aGlzLnBhcmVudE9yaWdpbiA9IGluZm8ucGFyZW50T3JpZ2luO1xuICAgIHRoaXMuY2hpbGQgPSBpbmZvLmNoaWxkO1xuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgIGxvZygnQ2hpbGQ6IFJlZ2lzdGVyaW5nIEFQSScpO1xuICAgICAgbG9nKCdDaGlsZDogQXdhaXRpbmcgbWVzc2FnZXMuLi4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmNoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCFzYW5pdGl6ZShlLCBfdGhpczMucGFyZW50T3JpZ2luKSkgcmV0dXJuO1xuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBsb2coJ0NoaWxkOiBSZWNlaXZlZCByZXF1ZXN0JywgZS5kYXRhKTtcbiAgICAgIH1cblxuICAgICAgdmFyIF9lJGRhdGEgPSBlLmRhdGEsXG4gICAgICAgICAgcHJvcGVydHkgPSBfZSRkYXRhLnByb3BlcnR5LFxuICAgICAgICAgIHVpZCA9IF9lJGRhdGEudWlkLFxuICAgICAgICAgIGRhdGEgPSBfZSRkYXRhLmRhdGE7XG5cbiAgICAgIGlmIChlLmRhdGEucG9zdG1hdGUgPT09ICdjYWxsJykge1xuICAgICAgICBpZiAocHJvcGVydHkgaW4gX3RoaXMzLm1vZGVsICYmIHR5cGVvZiBfdGhpczMubW9kZWxbcHJvcGVydHldID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgX3RoaXMzLm1vZGVsW3Byb3BlcnR5XShkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gUmVwbHkgdG8gUGFyZW50XG5cblxuICAgICAgcmVzb2x2ZVZhbHVlKF90aGlzMy5tb2RlbCwgcHJvcGVydHkpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBlLnNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxuICAgICAgICAgIHBvc3RtYXRlOiAncmVwbHknLFxuICAgICAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICAgIHVpZDogdWlkLFxuICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICB9LCBlLm9yaWdpbik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciBfcHJvdG8yID0gQ2hpbGRBUEkucHJvdG90eXBlO1xuXG4gIF9wcm90bzIuZW1pdCA9IGZ1bmN0aW9uIGVtaXQobmFtZSwgZGF0YSkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBsb2coXCJDaGlsZDogRW1pdHRpbmcgRXZlbnQgXFxcIlwiICsgbmFtZSArIFwiXFxcIlwiLCBkYXRhKTtcbiAgICB9XG5cbiAgICB0aGlzLnBhcmVudC5wb3N0TWVzc2FnZSh7XG4gICAgICBwb3N0bWF0ZTogJ2VtaXQnLFxuICAgICAgdHlwZTogbWVzc2FnZVR5cGUsXG4gICAgICB2YWx1ZToge1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBkYXRhOiBkYXRhXG4gICAgICB9XG4gICAgfSwgdGhpcy5wYXJlbnRPcmlnaW4pO1xuICB9O1xuXG4gIHJldHVybiBDaGlsZEFQSTtcbn0oKTtcbi8qKlxuICAqIFRoZSBlbnRyeSBwb2ludCBvZiB0aGUgUGFyZW50LlxuICogQHR5cGUge0NsYXNzfVxuICovXG5cbnZhciBQb3N0bWF0ZSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiAgLy8gSW50ZXJuZXQgRXhwbG9yZXIgY3JhcHMgaXRzZWxmXG5cbiAgLyoqXG4gICAqIFNldHMgb3B0aW9ucyByZWxhdGVkIHRvIHRoZSBQYXJlbnRcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZWxlbWVudCB0byBpbmplY3QgdGhlIGZyYW1lIGludG8sIGFuZCB0aGUgdXJsXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAqL1xuICBmdW5jdGlvbiBQb3N0bWF0ZShfcmVmMikge1xuICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgdmFyIF9yZWYyJGNvbnRhaW5lciA9IF9yZWYyLmNvbnRhaW5lcixcbiAgICAgICAgY29udGFpbmVyID0gX3JlZjIkY29udGFpbmVyID09PSB2b2lkIDAgPyB0eXBlb2YgY29udGFpbmVyICE9PSAndW5kZWZpbmVkJyA/IGNvbnRhaW5lciA6IGRvY3VtZW50LmJvZHkgOiBfcmVmMiRjb250YWluZXIsXG4gICAgICAgIG1vZGVsID0gX3JlZjIubW9kZWwsXG4gICAgICAgIHVybCA9IF9yZWYyLnVybCxcbiAgICAgICAgbmFtZSA9IF9yZWYyLm5hbWUsXG4gICAgICAgIF9yZWYyJGFkZGl0aW9uYWxBdHRyaSA9IF9yZWYyLmFkZGl0aW9uYWxBdHRyaWJ1dGVzLFxuICAgICAgICBhZGRpdGlvbmFsQXR0cmlidXRlcyA9IF9yZWYyJGFkZGl0aW9uYWxBdHRyaSA9PT0gdm9pZCAwID8ge30gOiBfcmVmMiRhZGRpdGlvbmFsQXR0cmksXG4gICAgICAgIF9yZWYyJGNsYXNzTGlzdEFycmF5ID0gX3JlZjIuY2xhc3NMaXN0QXJyYXksXG4gICAgICAgIGNsYXNzTGlzdEFycmF5ID0gX3JlZjIkY2xhc3NMaXN0QXJyYXkgPT09IHZvaWQgMCA/IFtdIDogX3JlZjIkY2xhc3NMaXN0QXJyYXk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZlxuICAgIHRoaXMucGFyZW50ID0gd2luZG93O1xuICAgIHRoaXMuZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICB0aGlzLmZyYW1lLm5hbWUgPSBuYW1lIHx8ICcnO1xuICAgIHRoaXMuZnJhbWUuY2xhc3NMaXN0LmFkZC5hcHBseSh0aGlzLmZyYW1lLmNsYXNzTGlzdCwgY2xhc3NMaXN0QXJyYXkpO1xuICAgIE9iamVjdC5rZXlzKGFkZGl0aW9uYWxBdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgIF90aGlzNC5mcmFtZVthdHRyaWJ1dGVdID0gYWRkaXRpb25hbEF0dHJpYnV0ZXNbYXR0cmlidXRlXTtcbiAgICB9KTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5mcmFtZSk7XG4gICAgdGhpcy5jaGlsZCA9IHRoaXMuZnJhbWUuY29udGVudFdpbmRvdyB8fCB0aGlzLmZyYW1lLmNvbnRlbnREb2N1bWVudC5wYXJlbnRXaW5kb3c7XG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsIHx8IHt9O1xuICAgIHJldHVybiB0aGlzLnNlbmRIYW5kc2hha2UodXJsKTtcbiAgfVxuICAvKipcbiAgICogQmVnaW5zIHRoZSBoYW5kc2hha2Ugc3RyYXRlZ3lcbiAgICogQHBhcmFtICB7U3RyaW5nfSB1cmwgVGhlIFVSTCB0byBzZW5kIGEgaGFuZHNoYWtlIHJlcXVlc3QgdG9cbiAgICogQHJldHVybiB7UHJvbWlzZX0gICAgIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBoYW5kc2hha2UgaXMgY29tcGxldGVcbiAgICovXG5cblxuICB2YXIgX3Byb3RvMyA9IFBvc3RtYXRlLnByb3RvdHlwZTtcblxuICBfcHJvdG8zLnNlbmRIYW5kc2hha2UgPSBmdW5jdGlvbiBzZW5kSGFuZHNoYWtlKHVybCkge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgdmFyIGNoaWxkT3JpZ2luID0gcmVzb2x2ZU9yaWdpbih1cmwpO1xuICAgIHZhciBhdHRlbXB0ID0gMDtcbiAgICB2YXIgcmVzcG9uc2VJbnRlcnZhbDtcbiAgICByZXR1cm4gbmV3IFBvc3RtYXRlLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlcGx5ID0gZnVuY3Rpb24gcmVwbHkoZSkge1xuICAgICAgICBpZiAoIXNhbml0aXplKGUsIGNoaWxkT3JpZ2luKSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGlmIChlLmRhdGEucG9zdG1hdGUgPT09ICdoYW5kc2hha2UtcmVwbHknKSB7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChyZXNwb25zZUludGVydmFsKTtcblxuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ1BhcmVudDogUmVjZWl2ZWQgaGFuZHNoYWtlIHJlcGx5IGZyb20gQ2hpbGQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpczUucGFyZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCByZXBseSwgZmFsc2UpO1xuXG4gICAgICAgICAgX3RoaXM1LmNoaWxkT3JpZ2luID0gZS5vcmlnaW47XG5cbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgbG9nKCdQYXJlbnQ6IFNhdmluZyBDaGlsZCBvcmlnaW4nLCBfdGhpczUuY2hpbGRPcmlnaW4pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ldyBQYXJlbnRBUEkoX3RoaXM1KSk7XG4gICAgICAgIH0gLy8gTWlnaHQgbmVlZCB0byByZW1vdmUgc2luY2UgcGFyZW50IG1pZ2h0IGJlIHJlY2VpdmluZyBkaWZmZXJlbnQgbWVzc2FnZXNcbiAgICAgICAgLy8gZnJvbSBkaWZmZXJlbnQgaG9zdHNcblxuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgbG9nKCdQYXJlbnQ6IEludmFsaWQgaGFuZHNoYWtlIHJlcGx5Jyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVqZWN0KCdGYWlsZWQgaGFuZHNoYWtlJyk7XG4gICAgICB9O1xuXG4gICAgICBfdGhpczUucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCByZXBseSwgZmFsc2UpO1xuXG4gICAgICB2YXIgZG9TZW5kID0gZnVuY3Rpb24gZG9TZW5kKCkge1xuICAgICAgICBhdHRlbXB0Kys7XG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICBsb2coXCJQYXJlbnQ6IFNlbmRpbmcgaGFuZHNoYWtlIGF0dGVtcHQgXCIgKyBhdHRlbXB0LCB7XG4gICAgICAgICAgICBjaGlsZE9yaWdpbjogY2hpbGRPcmlnaW5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzNS5jaGlsZC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgcG9zdG1hdGU6ICdoYW5kc2hha2UnLFxuICAgICAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICAgIG1vZGVsOiBfdGhpczUubW9kZWxcbiAgICAgICAgfSwgY2hpbGRPcmlnaW4pO1xuXG4gICAgICAgIGlmIChhdHRlbXB0ID09PSBtYXhIYW5kc2hha2VSZXF1ZXN0cykge1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwocmVzcG9uc2VJbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBsb2FkZWQgPSBmdW5jdGlvbiBsb2FkZWQoKSB7XG4gICAgICAgIGRvU2VuZCgpO1xuICAgICAgICByZXNwb25zZUludGVydmFsID0gc2V0SW50ZXJ2YWwoZG9TZW5kLCA1MDApO1xuICAgICAgfTtcblxuICAgICAgaWYgKF90aGlzNS5mcmFtZS5hdHRhY2hFdmVudCkge1xuICAgICAgICBfdGhpczUuZnJhbWUuYXR0YWNoRXZlbnQoJ29ubG9hZCcsIGxvYWRlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpczUuZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGxvYWRlZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGxvZygnUGFyZW50OiBMb2FkaW5nIGZyYW1lJywge1xuICAgICAgICAgIHVybDogdXJsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBfdGhpczUuZnJhbWUuc3JjID0gdXJsO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBQb3N0bWF0ZTtcbn0oKTtcbi8qKlxuICogVGhlIGVudHJ5IHBvaW50IG9mIHRoZSBDaGlsZFxuICogQHR5cGUge0NsYXNzfVxuICovXG5cblxuUG9zdG1hdGUuZGVidWcgPSBmYWxzZTtcblxuUG9zdG1hdGUuUHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gd2luZG93ID8gd2luZG93LlByb21pc2UgOiBQcm9taXNlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn0oKTtcblxuUG9zdG1hdGUuTW9kZWwgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIGNoaWxkLCBtb2RlbCwgcGFyZW50LCBhbmQgcmVzcG9uZHMgdG8gdGhlIFBhcmVudHMgaGFuZHNoYWtlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBtb2RlbCBIYXNoIG9mIHZhbHVlcywgZnVuY3Rpb25zLCBvciBwcm9taXNlc1xuICAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICBUaGUgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gdGhlIGhhbmRzaGFrZSBoYXMgYmVlbiByZWNlaXZlZFxuICAgKi9cbiAgZnVuY3Rpb24gTW9kZWwobW9kZWwpIHtcbiAgICB0aGlzLmNoaWxkID0gd2luZG93O1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICB0aGlzLnBhcmVudCA9IHRoaXMuY2hpbGQucGFyZW50O1xuICAgIHJldHVybiB0aGlzLnNlbmRIYW5kc2hha2VSZXBseSgpO1xuICB9XG4gIC8qKlxuICAgKiBSZXNwb25kcyB0byBhIGhhbmRzaGFrZSBpbml0aWF0ZWQgYnkgdGhlIFBhcmVudFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfSBSZXNvbHZlcyBhbiBvYmplY3QgdGhhdCBleHBvc2VzIGFuIEFQSSBmb3IgdGhlIENoaWxkXG4gICAqL1xuXG5cbiAgdmFyIF9wcm90bzQgPSBNb2RlbC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvNC5zZW5kSGFuZHNoYWtlUmVwbHkgPSBmdW5jdGlvbiBzZW5kSGFuZHNoYWtlUmVwbHkoKSB7XG4gICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFBvc3RtYXRlLlByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHNoYWtlID0gZnVuY3Rpb24gc2hha2UoZSkge1xuICAgICAgICBpZiAoIWUuZGF0YS5wb3N0bWF0ZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlLmRhdGEucG9zdG1hdGUgPT09ICdoYW5kc2hha2UnKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgIGxvZygnQ2hpbGQ6IFJlY2VpdmVkIGhhbmRzaGFrZSBmcm9tIFBhcmVudCcpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIF90aGlzNi5jaGlsZC5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgc2hha2UsIGZhbHNlKTtcblxuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ0NoaWxkOiBTZW5kaW5nIGhhbmRzaGFrZSByZXBseSB0byBQYXJlbnQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBlLnNvdXJjZS5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBwb3N0bWF0ZTogJ2hhbmRzaGFrZS1yZXBseScsXG4gICAgICAgICAgICB0eXBlOiBtZXNzYWdlVHlwZVxuICAgICAgICAgIH0sIGUub3JpZ2luKTtcbiAgICAgICAgICBfdGhpczYucGFyZW50T3JpZ2luID0gZS5vcmlnaW47IC8vIEV4dGVuZCBtb2RlbCB3aXRoIHRoZSBvbmUgcHJvdmlkZWQgYnkgdGhlIHBhcmVudFxuXG4gICAgICAgICAgdmFyIGRlZmF1bHRzID0gZS5kYXRhLm1vZGVsO1xuXG4gICAgICAgICAgaWYgKGRlZmF1bHRzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhkZWZhdWx0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgIF90aGlzNi5tb2RlbFtrZXldID0gZGVmYXVsdHNba2V5XTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgICBsb2coJ0NoaWxkOiBJbmhlcml0ZWQgYW5kIGV4dGVuZGVkIG1vZGVsIGZyb20gUGFyZW50Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgIGxvZygnQ2hpbGQ6IFNhdmluZyBQYXJlbnQgb3JpZ2luJywgX3RoaXM2LnBhcmVudE9yaWdpbik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUobmV3IENoaWxkQVBJKF90aGlzNikpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlamVjdCgnSGFuZHNoYWtlIFJlcGx5IEZhaWxlZCcpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXM2LmNoaWxkLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBzaGFrZSwgZmFsc2UpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBNb2RlbDtcbn0oKTtcblxuZXhwb3J0IGRlZmF1bHQgUG9zdG1hdGU7XG4iLCJpbXBvcnQgeyBVaUFwcENhcGFiaWxpdHlUeXBlLCBVaUFwcEV2ZW50VHlwZSB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5cbmltcG9ydCB7IENhcGFiaWxpdHlNYW5hZ2VyIH0gZnJvbSAnLi9jYXBhYmlsaXR5TWFuYWdlcic7XG5cbmV4cG9ydCB0eXBlIHsgQ2FwYWJpbGl0eU1hbmFnZXIgfSBmcm9tICcuL2NhcGFiaWxpdHlNYW5hZ2VyJztcblxuY2xhc3MgRGFzaGJvYXJkQ29nTWVudU1hbmFnZXIgZXh0ZW5kcyBDYXBhYmlsaXR5TWFuYWdlciB7XG4gICAgdHlwZSA9IFVpQXBwQ2FwYWJpbGl0eVR5cGUuREFTSEJPQVJEX0NPR19NRU5VO1xuICAgIGV2ZW50cyA9IFtVaUFwcEV2ZW50VHlwZS5EQVNIQk9BUkRfQ09HX01FTlVfQ09OVEVYVF07XG5cbiAgICBnZXRBZGRpdGlvbmFsQ2xpZW50TWV0aG9kcygpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGNhcGFiaWxpdHlNYW5hZ2VycyA9IFtEYXNoYm9hcmRDb2dNZW51TWFuYWdlcl07XG4iLCJpbXBvcnQgKiBhcyBQb3N0bWF0ZSBmcm9tICdwb3N0bWF0ZSc7XG5cbmltcG9ydCB0eXBlIHsgRERDbGllbnQgfSBmcm9tICcuLi9jbGllbnQnO1xuaW1wb3J0IHsgVWlBcHBDYXBhYmlsaXR5VHlwZSwgVWlBcHBFdmVudFR5cGUgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgZ2V0TG9nZ2VyLCBMb2dnZXIgfSBmcm9tICcuLi9sb2dnZXInO1xuaW1wb3J0IHtcbiAgICBBcHBDb250ZXh0LFxuICAgIENsaWVudE9wdGlvbnMsXG4gICAgRXZlbnRIYW5kbGVyLFxuICAgIEhhbmRsZUV2ZW50UGFyYW1zXG59IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IERlZmVycmVkLCB1bmlxdWVJbnQgfSBmcm9tICcuLi91dGlscyc7XG5cbnR5cGUgU3Vic2NyaXB0aW9ucyA9IHtcbiAgICBba2V5IGluIFVpQXBwRXZlbnRUeXBlXTogeyBbaWQ6IG51bWJlcl06IEV2ZW50SGFuZGxlciB9O1xufTtcblxuY29uc3QgaW5pdFN1YnNjcmlwdGlvbnMgPSAoKTogU3Vic2NyaXB0aW9ucyA9PiB7XG4gICAgY29uc3Qgc3ViY3JpcHRpb25zOiBQYXJ0aWFsPFN1YnNjcmlwdGlvbnM+ID0ge307XG5cbiAgICBPYmplY3QudmFsdWVzKFVpQXBwRXZlbnRUeXBlKS5mb3JFYWNoKGV2ZW50VHlwZSA9PiB7XG4gICAgICAgIHN1YmNyaXB0aW9uc1tldmVudFR5cGVdID0ge307XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3ViY3JpcHRpb25zIGFzIFN1YnNjcmlwdGlvbnM7XG59O1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ2FwYWJpbGl0eU1hbmFnZXIge1xuICAgIGFic3RyYWN0IHR5cGU6IFVpQXBwQ2FwYWJpbGl0eVR5cGU7XG4gICAgYWJzdHJhY3QgZXZlbnRzOiBVaUFwcEV2ZW50VHlwZVtdO1xuXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGhvc3Q6IHN0cmluZztcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgZGVidWc6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGxvZ2dlcjogTG9nZ2VyO1xuICAgIHByb3RlY3RlZCByZWFkb25seSBoYW5kc2hha2U6IFBvc3RtYXRlLk1vZGVsO1xuICAgIHByb3RlY3RlZCByZWFkb25seSBjb250ZXh0OiBEZWZlcnJlZDxBcHBDb250ZXh0PjtcbiAgICBwcml2YXRlIHN1YnNjcmlwdGlvbnM6IHtcbiAgICAgICAgW2tleSBpbiBVaUFwcEV2ZW50VHlwZV06IHsgW2lkOiBudW1iZXJdOiBFdmVudEhhbmRsZXIgfTtcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIG9wdGlvbnM6IFJlcXVpcmVkPENsaWVudE9wdGlvbnM+LFxuICAgICAgICBoYW5kc2hha2U6IFBvc3RtYXRlLk1vZGVsLFxuICAgICAgICBjb250ZXh0OiBEZWZlcnJlZDxBcHBDb250ZXh0PlxuICAgICkge1xuICAgICAgICB0aGlzLmhvc3QgPSBvcHRpb25zLmhvc3Q7XG4gICAgICAgIHRoaXMuZGVidWcgPSBvcHRpb25zLmRlYnVnO1xuICAgICAgICB0aGlzLmxvZ2dlciA9IGdldExvZ2dlcihvcHRpb25zKTtcbiAgICAgICAgdGhpcy5oYW5kc2hha2UgPSBoYW5kc2hha2U7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IGluaXRTdWJzY3JpcHRpb25zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBwbGFjZSBmb3IgZXZlbnR1YWwgZXh0ZW5zaW9ucyBvZiB0aGUgYmFzZSBjbGllbnQgbWV0aG9kcywgc3BlY2lmaWMgdG8gYSBjYXBhYmlsaXR5XG4gICAgICogRXhhbXBsZTpcbiAgICAgKiBwcml2YXRlIGdldEFkZGl0aW9uYWxDbGllbnRNZXRob2RzKCk6IHsgW25hbWU6IHN0cmluZ106IEZ1bmN0aW9uIH0ge1xuICAgICAqICAgcmV0dXJuICB7XG4gICAgICogICAgIGdldFRpbWVTZXJpZXM6ICgpID0+IHRoaXMuZ2V0VGltZVNlcmllcygpO1xuICAgICAqICAgfVxuICAgICAqIH1cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBnZXRBZGRpdGlvbmFsQ2xpZW50TWV0aG9kcygpOiB7IFtuYW1lOiBzdHJpbmddOiBGdW5jdGlvbiB9O1xuXG4gICAgLyoqXG4gICAgICogV3JhcHMgYWRkaXRpb25hbCBtZXRob2RzIGluIGEgY2hlY2sgYWdhaW5zdCB0aGUgY2FwYWJpbGl0eSB0eXBlLCB0aGVuIGFwcGxpZXMgdG8gcHJvdmlkZWQgY2xpZW50IG9iamVjdC4gRG8gbm90IG92ZXJyaWRlXG4gICAgICovXG4gICAgYXBwbHlBZGRpdGlvbmFsTWV0aG9kcyhjbGllbnQ6IEREQ2xpZW50KSB7XG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxNZXRob2RzID0gdGhpcy5nZXRBZGRpdGlvbmFsQ2xpZW50TWV0aG9kcygpO1xuXG4gICAgICAgIGNvbnN0IHdyYXBwZWRNZXRob2RzOiB7IFtuYW1lOiBzdHJpbmddOiBGdW5jdGlvbiB9ID0ge307XG5cbiAgICAgICAgT2JqZWN0LmVudHJpZXMoYWRkaXRpb25hbE1ldGhvZHMpLmZvckVhY2goKFtrZXksIG1ldGhvZF0pID0+IHtcbiAgICAgICAgICAgIHdyYXBwZWRNZXRob2RzW2tleV0gPSBhc3luYyAoLi4uYXJnczogYW55W10pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc0VuYWJsZWQgPSBhd2FpdCB0aGlzLmlzRW5hYmxlZCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0aG9kKC4uLmFyZ3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgYFRoZSAke3RoaXMudHlwZX0gY2FwYWJpbGl0eSBtdXN0IGJlIGVuYWJsZWQgdG8gcGVyZm9ybSB0aGlzIGFjdGlvbmBcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBPYmplY3QuYXNzaWduKGNsaWVudCwgd3JhcHBlZE1ldGhvZHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCBieSB0aGUgY2xpZW50IHRvIHJlZ2lzdGVyIGFuIGV2ZW50IGhhbmRsZXIgbWFuYWdlZCBieSB0aGlzIGNhcGFiaWxpdHkuIERvIG5vdCBvdmVycmlkZVxuICAgICAqL1xuICAgIHN1YnNjcmliZUhhbmRsZXI8VD4oXG4gICAgICAgIGV2ZW50VHlwZTogVWlBcHBFdmVudFR5cGUsXG4gICAgICAgIGhhbmRsZXI6IEV2ZW50SGFuZGxlcjxUPlxuICAgICk6ICgpID0+IHZvaWQge1xuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25JZCA9IHVuaXF1ZUludCgpO1xuXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9uc1tldmVudFR5cGVdW3N1YnNjcmlwdGlvbklkXSA9IGhhbmRsZXI7XG5cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgICBbc3Vic2NyaXB0aW9uSWRdOiBfLFxuICAgICAgICAgICAgICAgIC4uLm90aGVyU3Vic2NyaXB0aW9uc1xuICAgICAgICAgICAgfSA9IHRoaXMuc3Vic2NyaXB0aW9uc1tldmVudFR5cGVdO1xuXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXSA9IG90aGVyU3Vic2NyaXB0aW9ucztcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgdGhlIGNsaWVudCB0byBkZWxlZ2F0ZSBldmVudCBoYW5kbGluZy4gRG8gbm90IG92ZXJyaWRlXG4gICAgICovXG4gICAgYXN5bmMgaGFuZGxlRXZlbnQ8VD4oeyBldmVudFR5cGUsIGRhdGEgfTogSGFuZGxlRXZlbnRQYXJhbXM8VD4pIHtcbiAgICAgICAgY29uc3QgaGFzSGFuZGxlcnMgPSB0aGlzLmhhc0hhbmRsZXJzKGV2ZW50VHlwZSk7XG5cbiAgICAgICAgaWYgKCFoYXNIYW5kbGVycykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNFbmFibGVkID0gYXdhaXQgdGhpcy5pc0VuYWJsZWQoKTtcblxuICAgICAgICBpZiAoaXNFbmFibGVkKSB7XG4gICAgICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV07XG5cbiAgICAgICAgICAgIE9iamVjdC52YWx1ZXMoc3Vic2NyaXB0aW9ucykuZm9yRWFjaChoYW5kbGVyID0+IGhhbmRsZXIoZGF0YSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgICAgYFRoZSAke3RoaXMudHlwZX0gY2FwYWJpbGl0eSBtdXN0IGJlIGVuYWJsZWQgdG8gcmVzcG9uZCB0byBldmVudHMgb2YgdHlwZSAke2V2ZW50VHlwZX0uYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGlzRW5hYmxlZCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgeyBjYXBhYmlsaXRpZXMgfSA9IGF3YWl0IHRoaXMuY29udGV4dC5wcm9taXNlO1xuXG4gICAgICAgIHJldHVybiBjYXBhYmlsaXRpZXMuaW5jbHVkZXModGhpcy50eXBlKTtcbiAgICB9XG5cbiAgICBoYXNIYW5kbGVycyhldmVudFR5cGU6IFVpQXBwRXZlbnRUeXBlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhIU9iamVjdC5rZXlzKHRoaXMuc3Vic2NyaXB0aW9uc1tldmVudFR5cGVdKS5sZW5ndGg7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==