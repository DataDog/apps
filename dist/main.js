!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DD_SDK=t():e.DD_SDK=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UiAppEventType=t.UiAppCapabilityType=t.Host=void 0,function(e){e.PROD="https://app.datadoghq.com/",e.STAGE="https://dd.datad0g.com/"}(t.Host||(t.Host={})),function(e){e.APP_CONTEXT="app_context",e.DASHBOARD_COG_MENU="dashboard_cog_menu"}(t.UiAppCapabilityType||(t.UiAppCapabilityType={})),function(e){e.DASHBOARD_COG_MENU_CONTEXT="dashboard_cog_menu_context"}(t.UiAppEventType||(t.UiAppEventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLogger=void 0,t.getLogger=e=>e.debug?{log:e=>console.log("dd-apps: "+e),error:e=>console.error("dd-apps: "+e)}:{log(){},error(){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueInt=t.defer=void 0,t.defer=()=>{let e=()=>{},t=()=>{};const n=new Promise((n,i)=>{e=n,t=i});return{resolve:e,reject:t,promise:n}};let i=0;t.uniqueInt=()=>(i++,i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const i=n(4);let r;t.init=(e,t)=>(r||(r=new i.DDClient(e)),t&&r.getContext().then(t),r)},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DDClient=void 0;const o=r(n(5)),s=n(6),a=n(0),d=n(1),c=n(2),u={host:a.Host.STAGE,debug:!1};t.DDClient=class{constructor(e={}){this.host=e.host||u.host,this.debug=e.debug||u.debug,this.context=c.defer(),this.logger=d.getLogger(e),o.default.debug=this._debug,this.handshake=new o.default.Model({init:e=>this.init(e),handleEvent:e=>this.handleEvent(e)}),this.capabilityManagers=s.capabilityManagers.map(e=>new e({host:this.host,debug:this.debug},this.handshake,this.context)),this.capabilityManagers.forEach(e=>e.applyAdditionalMethods(this))}on(e,t){const n=this.getManagerByEventType(e);return n?n.subscribeHandler(e,t):(this.logger.error("Unknown event type"),()=>{})}getContext(){return i(this,void 0,void 0,(function*(){return this.context.promise}))}init(e){return i(this,void 0,void 0,(function*(){yield this.handshake,this.context.resolve(e),this.logger.log("dd-apps: sdk handshake: parent <-> child handshake is complete")}))}handleEvent({eventType:e,data:t}){return i(this,void 0,void 0,(function*(){const n=this.getManagerByEventType(e);n?n.handleEvent({eventType:e,data:t}):this.logger.error("Could not handle event: no corresponding manager found")}))}getManagerByType(e){return this.capabilityManagers.find(t=>t.type===e)}getManagerByEventType(e){return this.capabilityManagers.find(t=>t.events.includes(e))}}},function(e,t,n){"use strict";n.r(t);
/**
  postmate - A powerful, simple, promise-based postMessage library
  @version v1.6.0
  @link https://github.com/dollarshaveclub/postmate
  @author Jacob Kelley <jakie8@gmail.com>
  @license MIT
**/
var i="application/x-postmate-v1+json",r=0,o={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},s=function(e,t){return("string"!=typeof t||e.origin===t)&&(!!e.data&&(("object"!=typeof e.data||"postmate"in e.data)&&(e.data.type===i&&!!o[e.data.postmate])))},a=function(){function e(e){var t=this;this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.events={},this.listener=function(e){if(!s(e,t.childOrigin))return!1;var n=((e||{}).data||{}).value||{},i=n.data,r=n.name;"emit"===e.data.postmate&&r in t.events&&t.events[r].forEach((function(e){e.call(t,i)}))},this.parent.addEventListener("message",this.listener,!1)}var t=e.prototype;return t.get=function(e){var t=this;return new c.Promise((function(n){var o=++r;t.parent.addEventListener("message",(function e(i){i.data.uid===o&&"reply"===i.data.postmate&&(t.parent.removeEventListener("message",e,!1),n(i.data.value))}),!1),t.child.postMessage({postmate:"request",type:i,property:e,uid:o},t.childOrigin)}))},t.call=function(e,t){this.child.postMessage({postmate:"call",type:i,property:e,data:t},this.childOrigin)},t.on=function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},t.destroy=function(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)},e}(),d=function(){function e(e){var t=this;this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(function(e){if(s(e,t.parentOrigin)){0;var n=e.data,r=n.property,o=n.uid,a=n.data;"call"!==e.data.postmate?function(e,t){var n="function"==typeof e[t]?e[t]():e[t];return c.Promise.resolve(n)}(t.model,r).then((function(t){return e.source.postMessage({property:r,postmate:"reply",type:i,uid:o,value:t},e.origin)})):r in t.model&&"function"==typeof t.model[r]&&t.model[r](a)}}))}return e.prototype.emit=function(e,t){this.parent.postMessage({postmate:"emit",type:i,value:{name:e,data:t}},this.parentOrigin)},e}(),c=function(){function e(e){var t=this,n=e.container,i=void 0===n?void 0!==i?i:document.body:n,r=e.model,o=e.url,s=e.name,a=e.additionalAttributes,d=void 0===a?{}:a,c=e.classListArray,u=void 0===c?[]:c;return this.parent=window,this.frame=document.createElement("iframe"),this.frame.name=s||"",this.frame.classList.add.apply(this.frame.classList,u),Object.keys(d).forEach((function(e){t.frame[e]=d[e]})),i.appendChild(this.frame),this.child=this.frame.contentWindow||this.frame.contentDocument.parentWindow,this.model=r||{},this.sendHandshake(o)}return e.prototype.sendHandshake=function(t){var n,r=this,o=function(e){var t=document.createElement("a");t.href=e;var n=t.protocol.length>4?t.protocol:window.location.protocol,i=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||n+"//"+i}(t),d=0;return new e.Promise((function(e,c){r.parent.addEventListener("message",(function t(i){return!!s(i,o)&&("handshake-reply"===i.data.postmate?(clearInterval(n),r.parent.removeEventListener("message",t,!1),r.childOrigin=i.origin,e(new a(r))):c("Failed handshake"))}),!1);var u=function(){d++,r.child.postMessage({postmate:"handshake",type:i,model:r.model},o),5===d&&clearInterval(n)},l=function(){u(),n=setInterval(u,500)};r.frame.attachEvent?r.frame.attachEvent("onload",l):r.frame.addEventListener("load",l),r.frame.src=t}))},e}();c.debug=!1,c.Promise=function(){try{return window?window.Promise:Promise}catch(e){return null}}(),c.Model=function(){function e(e){return this.child=window,this.model=e,this.parent=this.child.parent,this.sendHandshakeReply()}return e.prototype.sendHandshakeReply=function(){var e=this;return new c.Promise((function(t,n){e.child.addEventListener("message",(function r(o){if(o.data.postmate){if("handshake"===o.data.postmate){0,e.child.removeEventListener("message",r,!1),o.source.postMessage({postmate:"handshake-reply",type:i},o.origin),e.parentOrigin=o.origin;var s=o.data.model;return s&&Object.keys(s).forEach((function(t){e.model[t]=s[t]})),t(new d(e))}return n("Handshake Reply Failed")}}),!1)}))},e}(),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capabilityManagers=void 0;const i=n(0),r=n(7);class o extends r.CapabilityManager{constructor(){super(...arguments),this.type=i.UiAppCapabilityType.DASHBOARD_COG_MENU,this.events=[i.UiAppEventType.DASHBOARD_COG_MENU_CONTEXT]}getAdditionalClientMethods(){return{}}}t.capabilityManagers=[o]},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function a(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}d((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.CapabilityManager=void 0;const o=n(0),s=n(1),a=n(2);t.CapabilityManager=class{constructor(e,t,n){this.host=e.host,this.debug=e.debug,this.logger=s.getLogger(e),this.handshake=t,this.context=n,this.subscriptions=(()=>{const e={};return Object.values(o.UiAppEventType).forEach(t=>{e[t]={}}),e})()}applyAdditionalMethods(e){const t=this.getAdditionalClientMethods(),n={};Object.entries(t).forEach(([e,t])=>{n[e]=(...e)=>i(this,void 0,void 0,(function*(){if(yield this.isEnabled())return t(...e);this.logger.error(`The ${this.type} capability must be enabled to perform this action`)}))}),Object.assign(e,n)}subscribeHandler(e,t){const n=a.uniqueInt();return this.subscriptions[e][n]=t,()=>{const t=this.subscriptions[e],i=n,o=(t[i],r(t,["symbol"==typeof i?i:i+""]));this.subscriptions[e]=o}}handleEvent({eventType:e,data:t}){return i(this,void 0,void 0,(function*(){if(!this.hasHandlers(e))return;if(yield this.isEnabled()){const n=this.subscriptions[e];Object.values(n).forEach(e=>e(t))}else this.logger.error(`The ${this.type} capability must be enabled to respond to events of type ${e}.`)}))}isEnabled(){return i(this,void 0,void 0,(function*(){const{capabilities:e}=yield this.context.promise;return e.includes(this.type)}))}hasHandlers(e){return!!Object.keys(this.subscriptions[e]).length}}}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ERF9TREsvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0REX1NESy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9ERF9TREsvLi9zcmMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL0REX1NESy8uL3NyYy9sb2dnZXIudHMiLCJ3ZWJwYWNrOi8vRERfU0RLLy4vc3JjL3V0aWxzLnRzIiwid2VicGFjazovL0REX1NESy8uL3NyYy9pbmRleC50cyIsIndlYnBhY2s6Ly9ERF9TREsvLi9zcmMvY2xpZW50LnRzIiwid2VicGFjazovL0REX1NESy8uL25vZGVfbW9kdWxlcy9wb3N0bWF0ZS9idWlsZC9wb3N0bWF0ZS5lcy5qcyIsIndlYnBhY2s6Ly9ERF9TREsvLi9zcmMvY2FwYWJpbGl0ZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vRERfU0RLLy4vc3JjL2NhcGFiaWxpdGVzL2NhcGFiaWxpdHlNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJIb3N0IiwiVWlBcHBDYXBhYmlsaXR5VHlwZSIsIlVpQXBwRXZlbnRUeXBlIiwiZ2V0TG9nZ2VyIiwib3B0aW9ucyIsImRlYnVnIiwibG9nIiwibWVzc2FnZSIsImNvbnNvbGUiLCJlcnJvciIsImRlZmVyIiwicmVzb2x2ZSIsInJlamVjdCIsInByb21pc2UiLCJQcm9taXNlIiwicmVzIiwicmVqIiwiaW5jcmVtZW50IiwidW5pcXVlSW50IiwiY2xpZW50IiwiaW5pdCIsImNhbGxiYWNrIiwiRERDbGllbnQiLCJnZXRDb250ZXh0IiwidGhlbiIsIkRFRkFVTFRfT1BUSU9OUyIsImhvc3QiLCJTVEFHRSIsInRoaXMiLCJjb250ZXh0IiwibG9nZ2VyIiwiX2RlYnVnIiwiaGFuZHNoYWtlIiwiTW9kZWwiLCJoYW5kbGVFdmVudCIsInBhcmFtcyIsImNhcGFiaWxpdHlNYW5hZ2VycyIsIm1hcCIsIk1hbmFnZXIiLCJmb3JFYWNoIiwibWFuYWdlciIsImFwcGx5QWRkaXRpb25hbE1ldGhvZHMiLCJldmVudFR5cGUiLCJoYW5kbGVyIiwiZ2V0TWFuYWdlckJ5RXZlbnRUeXBlIiwic3Vic2NyaWJlSGFuZGxlciIsImRhdGEiLCJjYXBhYmlsaXR5VHlwZSIsImZpbmQiLCJ0eXBlIiwiZXZlbnRzIiwiaW5jbHVkZXMiLCJtZXNzYWdlVHlwZSIsIl9tZXNzYWdlSWQiLCJtZXNzYWdlVHlwZXMiLCJlbWl0IiwicmVwbHkiLCJyZXF1ZXN0Iiwic2FuaXRpemUiLCJhbGxvd2VkT3JpZ2luIiwib3JpZ2luIiwicG9zdG1hdGUiLCJQYXJlbnRBUEkiLCJpbmZvIiwiX3RoaXMiLCJwYXJlbnQiLCJmcmFtZSIsImNoaWxkIiwiY2hpbGRPcmlnaW4iLCJsaXN0ZW5lciIsImUiLCJfcmVmIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9wcm90byIsIl90aGlzMiIsIlBvc3RtYXRlIiwidWlkIiwidHJhbnNhY3QiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicG9zdE1lc3NhZ2UiLCJvbiIsImV2ZW50TmFtZSIsInB1c2giLCJkZXN0cm95IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiQ2hpbGRBUEkiLCJfdGhpczMiLCJtb2RlbCIsInBhcmVudE9yaWdpbiIsIl9lJGRhdGEiLCJ1bndyYXBwZWRDb250ZXh0IiwicmVzb2x2ZVZhbHVlIiwic291cmNlIiwiX3JlZjIiLCJfdGhpczQiLCJfcmVmMiRjb250YWluZXIiLCJjb250YWluZXIiLCJkb2N1bWVudCIsImJvZHkiLCJ1cmwiLCJfcmVmMiRhZGRpdGlvbmFsQXR0cmkiLCJhZGRpdGlvbmFsQXR0cmlidXRlcyIsIl9yZWYyJGNsYXNzTGlzdEFycmF5IiwiY2xhc3NMaXN0QXJyYXkiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwbHkiLCJrZXlzIiwiYXR0cmlidXRlIiwiYXBwZW5kQ2hpbGQiLCJjb250ZW50V2luZG93IiwiY29udGVudERvY3VtZW50IiwicGFyZW50V2luZG93Iiwic2VuZEhhbmRzaGFrZSIsInJlc3BvbnNlSW50ZXJ2YWwiLCJfdGhpczUiLCJhIiwiaHJlZiIsInByb3RvY29sIiwibGVuZ3RoIiwibG9jYXRpb24iLCJwb3J0IiwiaG9zdG5hbWUiLCJyZXNvbHZlT3JpZ2luIiwiYXR0ZW1wdCIsImNsZWFySW50ZXJ2YWwiLCJkb1NlbmQiLCJsb2FkZWQiLCJzZXRJbnRlcnZhbCIsImF0dGFjaEV2ZW50Iiwic3JjIiwic2VuZEhhbmRzaGFrZVJlcGx5IiwiX3RoaXM2Iiwic2hha2UiLCJkZWZhdWx0cyIsIkRhc2hib2FyZENvZ01lbnVNYW5hZ2VyIiwiQ2FwYWJpbGl0eU1hbmFnZXIiLCJEQVNIQk9BUkRfQ09HX01FTlUiLCJEQVNIQk9BUkRfQ09HX01FTlVfQ09OVEVYVCIsInN1YnNjcmlwdGlvbnMiLCJzdWJjcmlwdGlvbnMiLCJ2YWx1ZXMiLCJpbml0U3Vic2NyaXB0aW9ucyIsImFkZGl0aW9uYWxNZXRob2RzIiwiZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMiLCJ3cmFwcGVkTWV0aG9kcyIsImVudHJpZXMiLCJtZXRob2QiLCJhcmdzIiwiaXNFbmFibGVkIiwiYXNzaWduIiwic3Vic2NyaXB0aW9uSWQiLCJvdGhlclN1YnNjcmlwdGlvbnMiLCJoYXNIYW5k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LFFBRTVDLE9BQU8rSSxFQUFhekcsU0FBU3ZCLEtBQUtxQixTQUd0QyxZQUFZUCxHQUNSLFFBQVNoRSxPQUFPbUksS0FBS2pGLEtBQUtpSCxjQUFjbkcsSUFBWStFIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJERF9TREtcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiRERfU0RLXCJdID0gZmFjdG9yeSgpO1xufSkod2luZG93LCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMyk7XG4iLCJleHBvcnQgZW51bSBIb3N0IHtcbiAgICBQUk9EID0gJ2h0dHBzOi8vYXBwLmRhdGFkb2docS5jb20vJyxcbiAgICBTVEFHRSA9ICdodHRwczovL2RkLmRhdGFkMGcuY29tLydcbn1cblxuZXhwb3J0IGVudW0gVWlBcHBDYXBhYmlsaXR5VHlwZSB7XG4gICAgQVBQX0NPTlRFWFQgPSAnYXBwX2NvbnRleHQnLFxuICAgIERBU0hCT0FSRF9DT0dfTUVOVSA9ICdkYXNoYm9hcmRfY29nX21lbnUnXG59XG5cbmV4cG9ydCBlbnVtIFVpQXBwRXZlbnRUeXBlIHtcbiAgICBEQVNIQk9BUkRfQ09HX01FTlVfQ09OVEVYVCA9ICdkYXNoYm9hcmRfY29nX21lbnVfY29udGV4dCdcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi9cbmltcG9ydCB7IENsaWVudE9wdGlvbnMgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBMb2dnZXIge1xuICAgIGxvZyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkO1xuICAgIGVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjb25zdCBnZXRMb2dnZXIgPSAob3B0aW9uczogQ2xpZW50T3B0aW9ucyk6IExvZ2dlciA9PiB7XG4gICAgaWYgKG9wdGlvbnMuZGVidWcpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvZyhtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5sb2coYGRkLWFwcHM6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS5lcnJvcihgZGQtYXBwczogJHttZXNzYWdlfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsb2coKSB7fSxcbiAgICAgICAgICAgIGVycm9yKCkge31cbiAgICAgICAgfTtcbiAgICB9XG59O1xuIiwiZXhwb3J0IGludGVyZmFjZSBEZWZlcnJlZDxUPiB7XG4gICAgcmVzb2x2ZTogKHQ6IFQpID0+IHZvaWQ7XG4gICAgcmVqZWN0OiAodDogVCkgPT4gdm9pZDtcbiAgICBwcm9taXNlOiBQcm9taXNlPFQ+O1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBkZWZmZXJyZWQgb2JqZWN0LCBpbmNsdWRpbmcgcHJvbWlzZSBhbmQgcmVzb2x2ZSArIHJlamVjdCBtZXRob2RzIHRvIGJlIGV4ZWN1dGVkIGxhdGVyXG4gKi9cbmV4cG9ydCBjb25zdCBkZWZlciA9IDxUPigpOiBEZWZlcnJlZDxUPiA9PiB7XG4gICAgbGV0IHJlc29sdmU6ICh0OiBUKSA9PiB2b2lkID0gKCkgPT4ge307XG4gICAgbGV0IHJlamVjdDogKHQ6IFQpID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2U8VD4oKHJlcywgcmVqKSA9PiB7XG4gICAgICAgIHJlc29sdmUgPSByZXM7XG4gICAgICAgIHJlamVjdCA9IHJlajtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc29sdmUsXG4gICAgICAgIHJlamVjdCxcbiAgICAgICAgcHJvbWlzZVxuICAgIH07XG59O1xuXG5sZXQgaW5jcmVtZW50OiBudW1iZXIgPSAwO1xuXG4vLyBnZW5lcmF0ZXMgYW4gaW50ZWdlciwgZ3VhcmFudGVlZCB0byBiZSB1bmlxdWUgYmVjdWFzZSBpdCdzIGluY3JlbWVudGVkIDopXG5leHBvcnQgY29uc3QgdW5pcXVlSW50ID0gKCk6IG51bWJlciA9PiB7XG4gICAgaW5jcmVtZW50Kys7XG5cbiAgICByZXR1cm4gaW5jcmVtZW50O1xufTtcbiIsImltcG9ydCB7IEREQ2xpZW50IH0gZnJvbSAnLi9jbGllbnQnO1xuaW1wb3J0IHsgQXBwQ29udGV4dCwgQ2xpZW50T3B0aW9ucyB9IGZyb20gJy4vdHlwZXMnO1xuXG5sZXQgY2xpZW50OiBERENsaWVudDtcblxuLyoqXG4gKiBJbml0aWFsaXplcyBhIGNsaWVudCwgb3IgcmV0dXJucyBhbiBleGlzdGluZyBvbmUgaWYgYWxyZWFkeSBpbml0aWFsaXplZC4gVXNlciBjYW4gcHJvdmlkZSBhbiBvcHRpb25hbFxuICogY2FsbGJhY2sgdG8gYmUgZXhlY3V0ZWQgd2l0aCBhcHAgY29udGV4dCBkYXRhIHdoZW4gaXQgaXMgc2VudCBmcm9tIHRoZSBwYXJlbnQuXG4gKi9cbmV4cG9ydCBjb25zdCBpbml0ID0gKFxuICAgIG9wdGlvbnM/OiBDbGllbnRPcHRpb25zLFxuICAgIGNhbGxiYWNrPzogKGNvbnRleHQ6IEFwcENvbnRleHQpID0+IHZvaWRcbik6IEREQ2xpZW50ID0+IHtcbiAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICBjbGllbnQgPSBuZXcgRERDbGllbnQob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIGNsaWVudC5nZXRDb250ZXh0KCkudGhlbihjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNsaWVudDtcbn07XG4iLCJpbXBvcnQgUG9zdG1hdGUgZnJvbSAncG9zdG1hdGUnO1xuXG5pbXBvcnQgeyBDYXBhYmlsaXR5TWFuYWdlciB9IGZyb20gJy4vY2FwYWJpbGl0ZXMvY2FwYWJpbGl0eU1hbmFnZXInO1xuaW1wb3J0IHsgY2FwYWJpbGl0eU1hbmFnZXJzIH0gZnJvbSAnLi9jYXBhYmlsaXRlcyc7XG5pbXBvcnQgeyBIb3N0LCBVaUFwcENhcGFiaWxpdHlUeXBlLCBVaUFwcEV2ZW50VHlwZSB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7IGdldExvZ2dlciwgTG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHtcbiAgICBBcHBDb250ZXh0LFxuICAgIEV2ZW50SGFuZGxlcixcbiAgICBIYW5kbGVFdmVudFBhcmFtcyxcbiAgICBDbGllbnRPcHRpb25zXG59IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgRGVmZXJyZWQsIGRlZmVyIH0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgICBob3N0OiBIb3N0LlNUQUdFLFxuICAgIGRlYnVnOiBmYWxzZVxufTtcblxuZXhwb3J0IGNsYXNzIEREQ2xpZW50IHtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhvc3Q6IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlYnVnOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgaGFuZHNoYWtlOiBQb3N0bWF0ZS5Nb2RlbDtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ2dlcjogTG9nZ2VyO1xuICAgIHByaXZhdGUgY29udGV4dDogRGVmZXJyZWQ8QXBwQ29udGV4dD47XG4gICAgcHJpdmF0ZSBjYXBhYmlsaXR5TWFuYWdlcnM6IENhcGFiaWxpdHlNYW5hZ2VyW107XG5cbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zOiBDbGllbnRPcHRpb25zID0ge30pIHtcbiAgICAgICAgdGhpcy5ob3N0ID0gb3B0aW9ucy5ob3N0IHx8IERFRkFVTFRfT1BUSU9OUy5ob3N0O1xuICAgICAgICB0aGlzLmRlYnVnID0gb3B0aW9ucy5kZWJ1ZyB8fCBERUZBVUxUX09QVElPTlMuZGVidWc7XG4gICAgICAgIHRoaXMuY29udGV4dCA9IGRlZmVyKCk7XG4gICAgICAgIHRoaXMubG9nZ2VyID0gZ2V0TG9nZ2VyKG9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgUG9zdG1hdGUuZGVidWcgPSB0aGlzLl9kZWJ1ZztcblxuICAgICAgICB0aGlzLmhhbmRzaGFrZSA9IG5ldyBQb3N0bWF0ZS5Nb2RlbCh7XG4gICAgICAgICAgICBpbml0OiAoY29udGV4dDogQXBwQ29udGV4dCkgPT4gdGhpcy5pbml0KGNvbnRleHQpLFxuICAgICAgICAgICAgaGFuZGxlRXZlbnQ6IChwYXJhbXM6IEhhbmRsZUV2ZW50UGFyYW1zKSA9PiB0aGlzLmhhbmRsZUV2ZW50KHBhcmFtcylcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jYXBhYmlsaXR5TWFuYWdlcnMgPSBjYXBhYmlsaXR5TWFuYWdlcnMubWFwKFxuICAgICAgICAgICAgTWFuYWdlciA9PlxuICAgICAgICAgICAgICAgIG5ldyBNYW5hZ2VyKFxuICAgICAgICAgICAgICAgICAgICB7IGhvc3Q6IHRoaXMuaG9zdCwgZGVidWc6IHRoaXMuZGVidWcgfSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kc2hha2UsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmNhcGFiaWxpdHlNYW5hZ2Vycy5mb3JFYWNoKG1hbmFnZXIgPT5cbiAgICAgICAgICAgIG1hbmFnZXIuYXBwbHlBZGRpdGlvbmFsTWV0aG9kcyh0aGlzKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZHMgZXZlbnQgaGFuZGxlciB0byBleGVjdXRlIG9uIGEgY2VydGFpbiBldmVudCB0eXBlIGZyb20gdGhlIHBhcmVudC4gV2lsbCBwcmludFxuICAgICAqIGFuIGVycm9yIGlmIHRoZSBpbnN0YWxsZWQgYXBwIGRvZXMgbm90IGhhdmUgdGhlIHJlcXVpcmVkIGNhcGFiaWxpdHkuIFJldHVybnMgYW4gdW5zdWJzY3JpYmVcbiAgICAgKiBtZXRob2QuIFRoaXMgbWV0aG9kIGNhbiBiZSBjYWxsZWQgYmVmb3JlIGhhbmRzaGFrZSBpcyBzdWNjZXNzZnVsLCBidXQgaGFuZGxlcnMgd2lsbCBub3QgZXhlY3V0ZSB1bnRpbFxuICAgICAqIGFmdGVyIHN1Y2Nlc3NzZnVsIGhhbmRzaGFrZS5cbiAgICAgKi9cbiAgICBvbjxUID0gYW55PihcbiAgICAgICAgZXZlbnRUeXBlOiBVaUFwcEV2ZW50VHlwZSxcbiAgICAgICAgaGFuZGxlcjogRXZlbnRIYW5kbGVyPFQ+XG4gICAgKTogKCkgPT4gdm9pZCB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSB0aGlzLmdldE1hbmFnZXJCeUV2ZW50VHlwZShldmVudFR5cGUpO1xuXG4gICAgICAgIGlmICghbWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ1Vua25vd24gZXZlbnQgdHlwZScpO1xuXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge307XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbWFuYWdlci5zdWJzY3JpYmVIYW5kbGVyPFQ+KGV2ZW50VHlwZSwgaGFuZGxlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhcHAgY29udGV4dCBkYXRhLCBhZnRlciBpdCBpcyBzZW50IGZyb20gdGhlIHBhcmVudFxuICAgICAqL1xuICAgIGFzeW5jIGdldENvbnRleHQoKTogUHJvbWlzZTxBcHBDb250ZXh0PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQucHJvbWlzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBpbml0IG1ldGhvZCBpcyBleHBvc2VkIGluIHRoZSBwb3N0bWF0ZSBtb2RlbC4gSXQgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIG90aGVyIG9wZXJhdGlvbnMgbWF5IHByb2NlZWQsXG4gICAgICogaW4gb3JkZXIgdG8gaW5mb3JtIGNsaWVudCBvZiBhcHAgY29udGV4dFxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgaW5pdChjb250ZXh0OiBBcHBDb250ZXh0KSB7XG4gICAgICAgIC8vIHBhcmVudCBzaG91bGQgb25seSBiZSBhYmxlIHRvIGNhbGwgdGhpcyBhZnRlciBoYW5kc2hha2UgaXMgY29tcGxldGUsIGJ1dCBpdHMgd29ydGggYSBjaGVjayBhbnl3YXlzXG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZHNoYWtlO1xuXG4gICAgICAgIHRoaXMuY29udGV4dC5yZXNvbHZlKGNvbnRleHQpO1xuXG4gICAgICAgIHRoaXMubG9nZ2VyLmxvZyhcbiAgICAgICAgICAgICdkZC1hcHBzOiBzZGsgaGFuZHNoYWtlOiBwYXJlbnQgPC0+IGNoaWxkIGhhbmRzaGFrZSBpcyBjb21wbGV0ZSdcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBoYW5kbGVFdmVudCBpcyB0aGUgbWFpbiBtZXRob2QgY2FsbGVkIGJ5IHRoZSBwYXJlbnQgdGhyb3VnaCBwb3N0bWF0ZSAoY2hpbGQuaGFuZGxlRXZlbnQoJ2V4ZWMnLCB7Li4ufSkpLlxuICAgICAqIEl0IGFjY2VwdHMgYSBrZXllZCBldmVudCB0eXBlIGFuZCBhcmJpdHJhcnkgZGF0YSB0byBiZSBwYXNzZWQgdG8gZXZlbnQgaGFuZGxlcnMuIEl0IHdpbGwgbG9nIGFuIGVycm9yXG4gICAgICogbWVzc2FnZSBpZiB0aGUgdXNlciBkb2VzIG5vdCBoYXZlIHRoZSByZXF1aXJlZCBjYXBhYmlsaXR5IGVuYWJsZWRcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGhhbmRsZUV2ZW50PFQ+KHsgZXZlbnRUeXBlLCBkYXRhIH06IEhhbmRsZUV2ZW50UGFyYW1zPFQ+KSB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSB0aGlzLmdldE1hbmFnZXJCeUV2ZW50VHlwZShldmVudFR5cGUpO1xuXG4gICAgICAgIGlmICghbWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgICAgJ0NvdWxkIG5vdCBoYW5kbGUgZXZlbnQ6IG5vIGNvcnJlc3BvbmRpbmcgbWFuYWdlciBmb3VuZCdcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIG1hbmFnZXIuaGFuZGxlRXZlbnQoeyBldmVudFR5cGUsIGRhdGEgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRNYW5hZ2VyQnlUeXBlKFxuICAgICAgICBjYXBhYmlsaXR5VHlwZTogVWlBcHBDYXBhYmlsaXR5VHlwZVxuICAgICk6IENhcGFiaWxpdHlNYW5hZ2VyIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FwYWJpbGl0eU1hbmFnZXJzLmZpbmQoXG4gICAgICAgICAgICBtYW5hZ2VyID0+IG1hbmFnZXIudHlwZSA9PT0gY2FwYWJpbGl0eVR5cGVcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldE1hbmFnZXJCeUV2ZW50VHlwZShcbiAgICAgICAgZXZlbnRUeXBlOiBVaUFwcEV2ZW50VHlwZVxuICAgICk6IENhcGFiaWxpdHlNYW5hZ2VyIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FwYWJpbGl0eU1hbmFnZXJzLmZpbmQobWFuYWdlciA9PlxuICAgICAgICAgICAgbWFuYWdlci5ldmVudHMuaW5jbHVkZXMoZXZlbnRUeXBlKVxuICAgICAgICApO1xuICAgIH1cbn1cbiIsIi8qKlxuICBwb3N0bWF0ZSAtIEEgcG93ZXJmdWwsIHNpbXBsZSwgcHJvbWlzZS1iYXNlZCBwb3N0TWVzc2FnZSBsaWJyYXJ5XG4gIEB2ZXJzaW9uIHYxLjYuMFxuICBAbGluayBodHRwczovL2dpdGh1Yi5jb20vZG9sbGFyc2hhdmVjbHViL3Bvc3RtYXRlXG4gIEBhdXRob3IgSmFjb2IgS2VsbGV5IDxqYWtpZThAZ21haWwuY29tPlxuICBAbGljZW5zZSBNSVRcbioqL1xuLyoqXG4gKiBUaGUgdHlwZSBvZiBtZXNzYWdlcyBvdXIgZnJhbWVzIG91ciBzZW5kaW5nXG4gKiBAdHlwZSB7U3RyaW5nfVxuICovXG52YXIgbWVzc2FnZVR5cGUgPSAnYXBwbGljYXRpb24veC1wb3N0bWF0ZS12MStqc29uJztcbi8qKlxuICogVGhlIG1heGltdW0gbnVtYmVyIG9mIGF0dGVtcHRzIHRvIHNlbmQgYSBoYW5kc2hha2UgcmVxdWVzdCB0byB0aGUgcGFyZW50XG4gKiBAdHlwZSB7TnVtYmVyfVxuICovXG5cbnZhciBtYXhIYW5kc2hha2VSZXF1ZXN0cyA9IDU7XG4vKipcbiAqIEEgdW5pcXVlIG1lc3NhZ2UgSUQgdGhhdCBpcyB1c2VkIHRvIGVuc3VyZSByZXNwb25zZXMgYXJlIHNlbnQgdG8gdGhlIGNvcnJlY3QgcmVxdWVzdHNcbiAqIEB0eXBlIHtOdW1iZXJ9XG4gKi9cblxudmFyIF9tZXNzYWdlSWQgPSAwO1xuLyoqXG4gKiBJbmNyZW1lbnRzIGFuZCByZXR1cm5zIGEgbWVzc2FnZSBJRFxuICogQHJldHVybiB7TnVtYmVyfSBBIHVuaXF1ZSBJRCBmb3IgYSBtZXNzYWdlXG4gKi9cblxudmFyIGdlbmVyYXRlTmV3TWVzc2FnZUlkID0gZnVuY3Rpb24gZ2VuZXJhdGVOZXdNZXNzYWdlSWQoKSB7XG4gIHJldHVybiArK19tZXNzYWdlSWQ7XG59O1xuLyoqXG4gKiBQb3N0bWF0ZSBsb2dnaW5nIGZ1bmN0aW9uIHRoYXQgZW5hYmxlcy9kaXNhYmxlcyB2aWEgY29uZmlnXG4gKiBAcGFyYW0gIHtPYmplY3R9IC4uLmFyZ3MgUmVzdCBBcmd1bWVudHNcbiAqL1xuXG52YXIgbG9nID0gZnVuY3Rpb24gbG9nKCkge1xuICB2YXIgX2NvbnNvbGU7XG5cbiAgcmV0dXJuIFBvc3RtYXRlLmRlYnVnID8gKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBhcmd1bWVudHMpIDogbnVsbDtcbn07IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuXG4vKipcbiAqIFRha2VzIGEgVVJMIGFuZCByZXR1cm5zIHRoZSBvcmlnaW5cbiAqIEBwYXJhbSAge1N0cmluZ30gdXJsIFRoZSBmdWxsIFVSTCBiZWluZyByZXF1ZXN0ZWRcbiAqIEByZXR1cm4ge1N0cmluZ30gICAgIFRoZSBVUkxzIG9yaWdpblxuICovXG5cbnZhciByZXNvbHZlT3JpZ2luID0gZnVuY3Rpb24gcmVzb2x2ZU9yaWdpbih1cmwpIHtcbiAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gIGEuaHJlZiA9IHVybDtcbiAgdmFyIHByb3RvY29sID0gYS5wcm90b2NvbC5sZW5ndGggPiA0ID8gYS5wcm90b2NvbCA6IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbDtcbiAgdmFyIGhvc3QgPSBhLmhvc3QubGVuZ3RoID8gYS5wb3J0ID09PSAnODAnIHx8IGEucG9ydCA9PT0gJzQ0MycgPyBhLmhvc3RuYW1lIDogYS5ob3N0IDogd2luZG93LmxvY2F0aW9uLmhvc3Q7XG4gIHJldHVybiBhLm9yaWdpbiB8fCBwcm90b2NvbCArIFwiLy9cIiArIGhvc3Q7XG59O1xudmFyIG1lc3NhZ2VUeXBlcyA9IHtcbiAgaGFuZHNoYWtlOiAxLFxuICAnaGFuZHNoYWtlLXJlcGx5JzogMSxcbiAgY2FsbDogMSxcbiAgZW1pdDogMSxcbiAgcmVwbHk6IDEsXG4gIHJlcXVlc3Q6IDFcbiAgLyoqXG4gICAqIEVuc3VyZXMgdGhhdCBhIG1lc3NhZ2UgaXMgc2FmZSB0byBpbnRlcnByZXRcbiAgICogQHBhcmFtICB7T2JqZWN0fSBtZXNzYWdlIFRoZSBwb3N0bWF0ZSBtZXNzYWdlIGJlaW5nIHNlbnRcbiAgICogQHBhcmFtICB7U3RyaW5nfEJvb2xlYW59IGFsbG93ZWRPcmlnaW4gVGhlIHdoaXRlbGlzdGVkIG9yaWdpbiBvciBmYWxzZSB0byBza2lwIG9yaWdpbiBjaGVja1xuICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgKi9cblxufTtcbnZhciBzYW5pdGl6ZSA9IGZ1bmN0aW9uIHNhbml0aXplKG1lc3NhZ2UsIGFsbG93ZWRPcmlnaW4pIHtcbiAgaWYgKHR5cGVvZiBhbGxvd2VkT3JpZ2luID09PSAnc3RyaW5nJyAmJiBtZXNzYWdlLm9yaWdpbiAhPT0gYWxsb3dlZE9yaWdpbikgcmV0dXJuIGZhbHNlO1xuICBpZiAoIW1lc3NhZ2UuZGF0YSkgcmV0dXJuIGZhbHNlO1xuICBpZiAodHlwZW9mIG1lc3NhZ2UuZGF0YSA9PT0gJ29iamVjdCcgJiYgISgncG9zdG1hdGUnIGluIG1lc3NhZ2UuZGF0YSkpIHJldHVybiBmYWxzZTtcbiAgaWYgKG1lc3NhZ2UuZGF0YS50eXBlICE9PSBtZXNzYWdlVHlwZSkgcmV0dXJuIGZhbHNlO1xuICBpZiAoIW1lc3NhZ2VUeXBlc1ttZXNzYWdlLmRhdGEucG9zdG1hdGVdKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB0cnVlO1xufTtcbi8qKlxuICogVGFrZXMgYSBtb2RlbCwgYW5kIHNlYXJjaGVzIGZvciBhIHZhbHVlIGJ5IHRoZSBwcm9wZXJ0eVxuICogQHBhcmFtICB7T2JqZWN0fSBtb2RlbCAgICAgVGhlIGRpY3Rpb25hcnkgdG8gc2VhcmNoIGFnYWluc3RcbiAqIEBwYXJhbSAge1N0cmluZ30gcHJvcGVydHkgIEEgcGF0aCB3aXRoaW4gYSBkaWN0aW9uYXJ5IChpLmUuICd3aW5kb3cubG9jYXRpb24uaHJlZicpXG4gKiBAcGFyYW0gIHtPYmplY3R9IGRhdGEgICAgICBBZGRpdGlvbmFsIGluZm9ybWF0aW9uIGZyb20gdGhlIGdldCByZXF1ZXN0IHRoYXQgaXNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3NlZCB0byBmdW5jdGlvbnMgaW4gdGhlIGNoaWxkIG1vZGVsXG4gKiBAcmV0dXJuIHtQcm9taXNlfVxuICovXG5cbnZhciByZXNvbHZlVmFsdWUgPSBmdW5jdGlvbiByZXNvbHZlVmFsdWUobW9kZWwsIHByb3BlcnR5KSB7XG4gIHZhciB1bndyYXBwZWRDb250ZXh0ID0gdHlwZW9mIG1vZGVsW3Byb3BlcnR5XSA9PT0gJ2Z1bmN0aW9uJyA/IG1vZGVsW3Byb3BlcnR5XSgpIDogbW9kZWxbcHJvcGVydHldO1xuICByZXR1cm4gUG9zdG1hdGUuUHJvbWlzZS5yZXNvbHZlKHVud3JhcHBlZENvbnRleHQpO1xufTtcbi8qKlxuICogQ29tcG9zZXMgYW4gQVBJIHRvIGJlIHVzZWQgYnkgdGhlIHBhcmVudFxuICogQHBhcmFtIHtPYmplY3R9IGluZm8gSW5mb3JtYXRpb24gb24gdGhlIGNvbnN1bWVyXG4gKi9cblxudmFyIFBhcmVudEFQSSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFBhcmVudEFQSShpbmZvKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHRoaXMucGFyZW50ID0gaW5mby5wYXJlbnQ7XG4gICAgdGhpcy5mcmFtZSA9IGluZm8uZnJhbWU7XG4gICAgdGhpcy5jaGlsZCA9IGluZm8uY2hpbGQ7XG4gICAgdGhpcy5jaGlsZE9yaWdpbiA9IGluZm8uY2hpbGRPcmlnaW47XG4gICAgdGhpcy5ldmVudHMgPSB7fTtcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBsb2coJ1BhcmVudDogUmVnaXN0ZXJpbmcgQVBJJyk7XG4gICAgICBsb2coJ1BhcmVudDogQXdhaXRpbmcgbWVzc2FnZXMuLi4nKTtcbiAgICB9XG5cbiAgICB0aGlzLmxpc3RlbmVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICghc2FuaXRpemUoZSwgX3RoaXMuY2hpbGRPcmlnaW4pKSByZXR1cm4gZmFsc2U7XG4gICAgICAvKipcbiAgICAgICAqIHRoZSBhc3NpZ25tZW50cyBiZWxvdyBlbnN1cmVzIHRoYXQgZSwgZGF0YSwgYW5kIHZhbHVlIGFyZSBhbGwgZGVmaW5lZFxuICAgICAgICovXG5cbiAgICAgIHZhciBfcmVmID0gKChlIHx8IHt9KS5kYXRhIHx8IHt9KS52YWx1ZSB8fCB7fSxcbiAgICAgICAgICBkYXRhID0gX3JlZi5kYXRhLFxuICAgICAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG5cbiAgICAgIGlmIChlLmRhdGEucG9zdG1hdGUgPT09ICdlbWl0Jykge1xuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgIGxvZyhcIlBhcmVudDogUmVjZWl2ZWQgZXZlbnQgZW1pc3Npb246IFwiICsgbmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmFtZSBpbiBfdGhpcy5ldmVudHMpIHtcbiAgICAgICAgICBfdGhpcy5ldmVudHNbbmFtZV0uZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoX3RoaXMsIGRhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMucGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmxpc3RlbmVyLCBmYWxzZSk7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgbG9nKCdQYXJlbnQ6IEF3YWl0aW5nIGV2ZW50IGVtaXNzaW9ucyBmcm9tIENoaWxkJyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIF9wcm90byA9IFBhcmVudEFQSS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmdldCA9IGZ1bmN0aW9uIGdldChwcm9wZXJ0eSkge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgcmV0dXJuIG5ldyBQb3N0bWF0ZS5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAvLyBFeHRyYWN0IGRhdGEgZnJvbSByZXNwb25zZSBhbmQga2lsbCBsaXN0ZW5lcnNcbiAgICAgIHZhciB1aWQgPSBnZW5lcmF0ZU5ld01lc3NhZ2VJZCgpO1xuXG4gICAgICB2YXIgdHJhbnNhY3QgPSBmdW5jdGlvbiB0cmFuc2FjdChlKSB7XG4gICAgICAgIGlmIChlLmRhdGEudWlkID09PSB1aWQgJiYgZS5kYXRhLnBvc3RtYXRlID09PSAncmVwbHknKSB7XG4gICAgICAgICAgX3RoaXMyLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdHJhbnNhY3QsIGZhbHNlKTtcblxuICAgICAgICAgIHJlc29sdmUoZS5kYXRhLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfTsgLy8gUHJlcGFyZSBmb3IgcmVzcG9uc2UgZnJvbSBDaGlsZC4uLlxuXG5cbiAgICAgIF90aGlzMi5wYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRyYW5zYWN0LCBmYWxzZSk7IC8vIFRoZW4gYXNrIGNoaWxkIGZvciBpbmZvcm1hdGlvblxuXG5cbiAgICAgIF90aGlzMi5jaGlsZC5wb3N0TWVzc2FnZSh7XG4gICAgICAgIHBvc3RtYXRlOiAncmVxdWVzdCcsXG4gICAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksXG4gICAgICAgIHVpZDogdWlkXG4gICAgICB9LCBfdGhpczIuY2hpbGRPcmlnaW4pO1xuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5jYWxsID0gZnVuY3Rpb24gY2FsbChwcm9wZXJ0eSwgZGF0YSkge1xuICAgIC8vIFNlbmQgaW5mb3JtYXRpb24gdG8gdGhlIGNoaWxkXG4gICAgdGhpcy5jaGlsZC5wb3N0TWVzc2FnZSh7XG4gICAgICBwb3N0bWF0ZTogJ2NhbGwnLFxuICAgICAgdHlwZTogbWVzc2FnZVR5cGUsXG4gICAgICBwcm9wZXJ0eTogcHJvcGVydHksXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSwgdGhpcy5jaGlsZE9yaWdpbik7XG4gIH07XG5cbiAgX3Byb3RvLm9uID0gZnVuY3Rpb24gb24oZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgIGlmICghdGhpcy5ldmVudHNbZXZlbnROYW1lXSkge1xuICAgICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXSA9IFtdO1xuICAgIH1cblxuICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XG4gIH07XG5cbiAgX3Byb3RvLmRlc3Ryb3kgPSBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBsb2coJ1BhcmVudDogRGVzdHJveWluZyBQb3N0bWF0ZSBpbnN0YW5jZScpO1xuICAgIH1cblxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5saXN0ZW5lciwgZmFsc2UpO1xuICAgIHRoaXMuZnJhbWUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmZyYW1lKTtcbiAgfTtcblxuICByZXR1cm4gUGFyZW50QVBJO1xufSgpO1xuLyoqXG4gKiBDb21wb3NlcyBhbiBBUEkgdG8gYmUgdXNlZCBieSB0aGUgY2hpbGRcbiAqIEBwYXJhbSB7T2JqZWN0fSBpbmZvIEluZm9ybWF0aW9uIG9uIHRoZSBjb25zdW1lclxuICovXG5cbnZhciBDaGlsZEFQSSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENoaWxkQVBJKGluZm8pIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIHRoaXMubW9kZWwgPSBpbmZvLm1vZGVsO1xuICAgIHRoaXMucGFyZW50ID0gaW5mby5wYXJlbnQ7XG4gICAgdGhpcy5wYXJlbnRPcmlnaW4gPSBpbmZvLnBhcmVudE9yaWdpbjtcbiAgICB0aGlzLmNoaWxkID0gaW5mby5jaGlsZDtcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICBsb2coJ0NoaWxkOiBSZWdpc3RlcmluZyBBUEknKTtcbiAgICAgIGxvZygnQ2hpbGQ6IEF3YWl0aW5nIG1lc3NhZ2VzLi4uJyk7XG4gICAgfVxuXG4gICAgdGhpcy5jaGlsZC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICghc2FuaXRpemUoZSwgX3RoaXMzLnBhcmVudE9yaWdpbikpIHJldHVybjtcblxuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgbG9nKCdDaGlsZDogUmVjZWl2ZWQgcmVxdWVzdCcsIGUuZGF0YSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBfZSRkYXRhID0gZS5kYXRhLFxuICAgICAgICAgIHByb3BlcnR5ID0gX2UkZGF0YS5wcm9wZXJ0eSxcbiAgICAgICAgICB1aWQgPSBfZSRkYXRhLnVpZCxcbiAgICAgICAgICBkYXRhID0gX2UkZGF0YS5kYXRhO1xuXG4gICAgICBpZiAoZS5kYXRhLnBvc3RtYXRlID09PSAnY2FsbCcpIHtcbiAgICAgICAgaWYgKHByb3BlcnR5IGluIF90aGlzMy5tb2RlbCAmJiB0eXBlb2YgX3RoaXMzLm1vZGVsW3Byb3BlcnR5XSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIF90aGlzMy5tb2RlbFtwcm9wZXJ0eV0oZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFJlcGx5IHRvIFBhcmVudFxuXG5cbiAgICAgIHJlc29sdmVWYWx1ZShfdGhpczMubW9kZWwsIHByb3BlcnR5KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gZS5zb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgIHByb3BlcnR5OiBwcm9wZXJ0eSxcbiAgICAgICAgICBwb3N0bWF0ZTogJ3JlcGx5JyxcbiAgICAgICAgICB0eXBlOiBtZXNzYWdlVHlwZSxcbiAgICAgICAgICB1aWQ6IHVpZCxcbiAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgfSwgZS5vcmlnaW4pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICB2YXIgX3Byb3RvMiA9IENoaWxkQVBJLnByb3RvdHlwZTtcblxuICBfcHJvdG8yLmVtaXQgPSBmdW5jdGlvbiBlbWl0KG5hbWUsIGRhdGEpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgbG9nKFwiQ2hpbGQ6IEVtaXR0aW5nIEV2ZW50IFxcXCJcIiArIG5hbWUgKyBcIlxcXCJcIiwgZGF0YSk7XG4gICAgfVxuXG4gICAgdGhpcy5wYXJlbnQucG9zdE1lc3NhZ2Uoe1xuICAgICAgcG9zdG1hdGU6ICdlbWl0JyxcbiAgICAgIHR5cGU6IG1lc3NhZ2VUeXBlLFxuICAgICAgdmFsdWU6IHtcbiAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgZGF0YTogZGF0YVxuICAgICAgfVxuICAgIH0sIHRoaXMucGFyZW50T3JpZ2luKTtcbiAgfTtcblxuICByZXR1cm4gQ2hpbGRBUEk7XG59KCk7XG4vKipcbiAgKiBUaGUgZW50cnkgcG9pbnQgb2YgdGhlIFBhcmVudC5cbiAqIEB0eXBlIHtDbGFzc31cbiAqL1xuXG52YXIgUG9zdG1hdGUgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG4gIC8vIEludGVybmV0IEV4cGxvcmVyIGNyYXBzIGl0c2VsZlxuXG4gIC8qKlxuICAgKiBTZXRzIG9wdGlvbnMgcmVsYXRlZCB0byB0aGUgUGFyZW50XG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGVsZW1lbnQgdG8gaW5qZWN0IHRoZSBmcmFtZSBpbnRvLCBhbmQgdGhlIHVybFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfVxuICAgKi9cbiAgZnVuY3Rpb24gUG9zdG1hdGUoX3JlZjIpIHtcbiAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgIHZhciBfcmVmMiRjb250YWluZXIgPSBfcmVmMi5jb250YWluZXIsXG4gICAgICAgIGNvbnRhaW5lciA9IF9yZWYyJGNvbnRhaW5lciA9PT0gdm9pZCAwID8gdHlwZW9mIGNvbnRhaW5lciAhPT0gJ3VuZGVmaW5lZCcgPyBjb250YWluZXIgOiBkb2N1bWVudC5ib2R5IDogX3JlZjIkY29udGFpbmVyLFxuICAgICAgICBtb2RlbCA9IF9yZWYyLm1vZGVsLFxuICAgICAgICB1cmwgPSBfcmVmMi51cmwsXG4gICAgICAgIG5hbWUgPSBfcmVmMi5uYW1lLFxuICAgICAgICBfcmVmMiRhZGRpdGlvbmFsQXR0cmkgPSBfcmVmMi5hZGRpdGlvbmFsQXR0cmlidXRlcyxcbiAgICAgICAgYWRkaXRpb25hbEF0dHJpYnV0ZXMgPSBfcmVmMiRhZGRpdGlvbmFsQXR0cmkgPT09IHZvaWQgMCA/IHt9IDogX3JlZjIkYWRkaXRpb25hbEF0dHJpLFxuICAgICAgICBfcmVmMiRjbGFzc0xpc3RBcnJheSA9IF9yZWYyLmNsYXNzTGlzdEFycmF5LFxuICAgICAgICBjbGFzc0xpc3RBcnJheSA9IF9yZWYyJGNsYXNzTGlzdEFycmF5ID09PSB2b2lkIDAgPyBbXSA6IF9yZWYyJGNsYXNzTGlzdEFycmF5O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcbiAgICB0aGlzLnBhcmVudCA9IHdpbmRvdztcbiAgICB0aGlzLmZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG4gICAgdGhpcy5mcmFtZS5uYW1lID0gbmFtZSB8fCAnJztcbiAgICB0aGlzLmZyYW1lLmNsYXNzTGlzdC5hZGQuYXBwbHkodGhpcy5mcmFtZS5jbGFzc0xpc3QsIGNsYXNzTGlzdEFycmF5KTtcbiAgICBPYmplY3Qua2V5cyhhZGRpdGlvbmFsQXR0cmlidXRlcykuZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICBfdGhpczQuZnJhbWVbYXR0cmlidXRlXSA9IGFkZGl0aW9uYWxBdHRyaWJ1dGVzW2F0dHJpYnV0ZV07XG4gICAgfSk7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZnJhbWUpO1xuICAgIHRoaXMuY2hpbGQgPSB0aGlzLmZyYW1lLmNvbnRlbnRXaW5kb3cgfHwgdGhpcy5mcmFtZS5jb250ZW50RG9jdW1lbnQucGFyZW50V2luZG93O1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbCB8fCB7fTtcbiAgICByZXR1cm4gdGhpcy5zZW5kSGFuZHNoYWtlKHVybCk7XG4gIH1cbiAgLyoqXG4gICAqIEJlZ2lucyB0aGUgaGFuZHNoYWtlIHN0cmF0ZWd5XG4gICAqIEBwYXJhbSAge1N0cmluZ30gdXJsIFRoZSBVUkwgdG8gc2VuZCBhIGhhbmRzaGFrZSByZXF1ZXN0IHRvXG4gICAqIEByZXR1cm4ge1Byb21pc2V9ICAgICBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgaGFuZHNoYWtlIGlzIGNvbXBsZXRlXG4gICAqL1xuXG5cbiAgdmFyIF9wcm90bzMgPSBQb3N0bWF0ZS5wcm90b3R5cGU7XG5cbiAgX3Byb3RvMy5zZW5kSGFuZHNoYWtlID0gZnVuY3Rpb24gc2VuZEhhbmRzaGFrZSh1cmwpIHtcbiAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgIHZhciBjaGlsZE9yaWdpbiA9IHJlc29sdmVPcmlnaW4odXJsKTtcbiAgICB2YXIgYXR0ZW1wdCA9IDA7XG4gICAgdmFyIHJlc3BvbnNlSW50ZXJ2YWw7XG4gICAgcmV0dXJuIG5ldyBQb3N0bWF0ZS5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciByZXBseSA9IGZ1bmN0aW9uIHJlcGx5KGUpIHtcbiAgICAgICAgaWYgKCFzYW5pdGl6ZShlLCBjaGlsZE9yaWdpbikpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBpZiAoZS5kYXRhLnBvc3RtYXRlID09PSAnaGFuZHNoYWtlLXJlcGx5Jykge1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwocmVzcG9uc2VJbnRlcnZhbCk7XG5cbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgbG9nKCdQYXJlbnQ6IFJlY2VpdmVkIGhhbmRzaGFrZSByZXBseSBmcm9tIENoaWxkJyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgX3RoaXM1LnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgcmVwbHksIGZhbHNlKTtcblxuICAgICAgICAgIF90aGlzNS5jaGlsZE9yaWdpbiA9IGUub3JpZ2luO1xuXG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgIGxvZygnUGFyZW50OiBTYXZpbmcgQ2hpbGQgb3JpZ2luJywgX3RoaXM1LmNoaWxkT3JpZ2luKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShuZXcgUGFyZW50QVBJKF90aGlzNSkpO1xuICAgICAgICB9IC8vIE1pZ2h0IG5lZWQgdG8gcmVtb3ZlIHNpbmNlIHBhcmVudCBtaWdodCBiZSByZWNlaXZpbmcgZGlmZmVyZW50IG1lc3NhZ2VzXG4gICAgICAgIC8vIGZyb20gZGlmZmVyZW50IGhvc3RzXG5cblxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgIGxvZygnUGFyZW50OiBJbnZhbGlkIGhhbmRzaGFrZSByZXBseScpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlamVjdCgnRmFpbGVkIGhhbmRzaGFrZScpO1xuICAgICAgfTtcblxuICAgICAgX3RoaXM1LnBhcmVudC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgcmVwbHksIGZhbHNlKTtcblxuICAgICAgdmFyIGRvU2VuZCA9IGZ1bmN0aW9uIGRvU2VuZCgpIHtcbiAgICAgICAgYXR0ZW1wdCsrO1xuXG4gICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgbG9nKFwiUGFyZW50OiBTZW5kaW5nIGhhbmRzaGFrZSBhdHRlbXB0IFwiICsgYXR0ZW1wdCwge1xuICAgICAgICAgICAgY2hpbGRPcmlnaW46IGNoaWxkT3JpZ2luXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBfdGhpczUuY2hpbGQucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgIHBvc3RtYXRlOiAnaGFuZHNoYWtlJyxcbiAgICAgICAgICB0eXBlOiBtZXNzYWdlVHlwZSxcbiAgICAgICAgICBtb2RlbDogX3RoaXM1Lm1vZGVsXG4gICAgICAgIH0sIGNoaWxkT3JpZ2luKTtcblxuICAgICAgICBpZiAoYXR0ZW1wdCA9PT0gbWF4SGFuZHNoYWtlUmVxdWVzdHMpIHtcbiAgICAgICAgICBjbGVhckludGVydmFsKHJlc3BvbnNlSW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB2YXIgbG9hZGVkID0gZnVuY3Rpb24gbG9hZGVkKCkge1xuICAgICAgICBkb1NlbmQoKTtcbiAgICAgICAgcmVzcG9uc2VJbnRlcnZhbCA9IHNldEludGVydmFsKGRvU2VuZCwgNTAwKTtcbiAgICAgIH07XG5cbiAgICAgIGlmIChfdGhpczUuZnJhbWUuYXR0YWNoRXZlbnQpIHtcbiAgICAgICAgX3RoaXM1LmZyYW1lLmF0dGFjaEV2ZW50KCdvbmxvYWQnLCBsb2FkZWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXM1LmZyYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBsb2FkZWQpO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICBsb2coJ1BhcmVudDogTG9hZGluZyBmcmFtZScsIHtcbiAgICAgICAgICB1cmw6IHVybFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgX3RoaXM1LmZyYW1lLnNyYyA9IHVybDtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gUG9zdG1hdGU7XG59KCk7XG4vKipcbiAqIFRoZSBlbnRyeSBwb2ludCBvZiB0aGUgQ2hpbGRcbiAqIEB0eXBlIHtDbGFzc31cbiAqL1xuXG5cblBvc3RtYXRlLmRlYnVnID0gZmFsc2U7XG5cblBvc3RtYXRlLlByb21pc2UgPSBmdW5jdGlvbiAoKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHdpbmRvdyA/IHdpbmRvdy5Qcm9taXNlIDogUHJvbWlzZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59KCk7XG5cblBvc3RtYXRlLk1vZGVsID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSBjaGlsZCwgbW9kZWwsIHBhcmVudCwgYW5kIHJlc3BvbmRzIHRvIHRoZSBQYXJlbnRzIGhhbmRzaGFrZVxuICAgKiBAcGFyYW0ge09iamVjdH0gbW9kZWwgSGFzaCBvZiB2YWx1ZXMsIGZ1bmN0aW9ucywgb3IgcHJvbWlzZXNcbiAgICogQHJldHVybiB7UHJvbWlzZX0gICAgICAgVGhlIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aGVuIHRoZSBoYW5kc2hha2UgaGFzIGJlZW4gcmVjZWl2ZWRcbiAgICovXG4gIGZ1bmN0aW9uIE1vZGVsKG1vZGVsKSB7XG4gICAgdGhpcy5jaGlsZCA9IHdpbmRvdztcbiAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgdGhpcy5wYXJlbnQgPSB0aGlzLmNoaWxkLnBhcmVudDtcbiAgICByZXR1cm4gdGhpcy5zZW5kSGFuZHNoYWtlUmVwbHkoKTtcbiAgfVxuICAvKipcbiAgICogUmVzcG9uZHMgdG8gYSBoYW5kc2hha2UgaW5pdGlhdGVkIGJ5IHRoZSBQYXJlbnRcbiAgICogQHJldHVybiB7UHJvbWlzZX0gUmVzb2x2ZXMgYW4gb2JqZWN0IHRoYXQgZXhwb3NlcyBhbiBBUEkgZm9yIHRoZSBDaGlsZFxuICAgKi9cblxuXG4gIHZhciBfcHJvdG80ID0gTW9kZWwucHJvdG90eXBlO1xuXG4gIF9wcm90bzQuc2VuZEhhbmRzaGFrZVJlcGx5ID0gZnVuY3Rpb24gc2VuZEhhbmRzaGFrZVJlcGx5KCkge1xuICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgcmV0dXJuIG5ldyBQb3N0bWF0ZS5Qcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBzaGFrZSA9IGZ1bmN0aW9uIHNoYWtlKGUpIHtcbiAgICAgICAgaWYgKCFlLmRhdGEucG9zdG1hdGUpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZS5kYXRhLnBvc3RtYXRlID09PSAnaGFuZHNoYWtlJykge1xuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ0NoaWxkOiBSZWNlaXZlZCBoYW5kc2hha2UgZnJvbSBQYXJlbnQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpczYuY2hpbGQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHNoYWtlLCBmYWxzZSk7XG5cbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgbG9nKCdDaGlsZDogU2VuZGluZyBoYW5kc2hha2UgcmVwbHkgdG8gUGFyZW50Jyk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZS5zb3VyY2UucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgcG9zdG1hdGU6ICdoYW5kc2hha2UtcmVwbHknLFxuICAgICAgICAgICAgdHlwZTogbWVzc2FnZVR5cGVcbiAgICAgICAgICB9LCBlLm9yaWdpbik7XG4gICAgICAgICAgX3RoaXM2LnBhcmVudE9yaWdpbiA9IGUub3JpZ2luOyAvLyBFeHRlbmQgbW9kZWwgd2l0aCB0aGUgb25lIHByb3ZpZGVkIGJ5IHRoZSBwYXJlbnRcblxuICAgICAgICAgIHZhciBkZWZhdWx0cyA9IGUuZGF0YS5tb2RlbDtcblxuICAgICAgICAgIGlmIChkZWZhdWx0cykge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGVmYXVsdHMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICBfdGhpczYubW9kZWxba2V5XSA9IGRlZmF1bHRzW2tleV07XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICAgICAgbG9nKCdDaGlsZDogSW5oZXJpdGVkIGFuZCBleHRlbmRlZCBtb2RlbCBmcm9tIFBhcmVudCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgICAgICBsb2coJ0NoaWxkOiBTYXZpbmcgUGFyZW50IG9yaWdpbicsIF90aGlzNi5wYXJlbnRPcmlnaW4pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiByZXNvbHZlKG5ldyBDaGlsZEFQSShfdGhpczYpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZWplY3QoJ0hhbmRzaGFrZSBSZXBseSBGYWlsZWQnKTtcbiAgICAgIH07XG5cbiAgICAgIF90aGlzNi5jaGlsZC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgc2hha2UsIGZhbHNlKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gTW9kZWw7XG59KCk7XG5cbmV4cG9ydCBkZWZhdWx0IFBvc3RtYXRlO1xuIiwiaW1wb3J0IHsgVWlBcHBDYXBhYmlsaXR5VHlwZSwgVWlBcHBFdmVudFR5cGUgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuXG5pbXBvcnQgeyBDYXBhYmlsaXR5TWFuYWdlciB9IGZyb20gJy4vY2FwYWJpbGl0eU1hbmFnZXInO1xuXG5leHBvcnQgdHlwZSB7IENhcGFiaWxpdHlNYW5hZ2VyIH0gZnJvbSAnLi9jYXBhYmlsaXR5TWFuYWdlcic7XG5cbmNsYXNzIERhc2hib2FyZENvZ01lbnVNYW5hZ2VyIGV4dGVuZHMgQ2FwYWJpbGl0eU1hbmFnZXIge1xuICAgIHR5cGUgPSBVaUFwcENhcGFiaWxpdHlUeXBlLkRBU0hCT0FSRF9DT0dfTUVOVTtcbiAgICBldmVudHMgPSBbVWlBcHBFdmVudFR5cGUuREFTSEJPQVJEX0NPR19NRU5VX0NPTlRFWFRdO1xuXG4gICAgZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMoKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBjYXBhYmlsaXR5TWFuYWdlcnMgPSBbRGFzaGJvYXJkQ29nTWVudU1hbmFnZXJdO1xuIiwiaW1wb3J0ICogYXMgUG9zdG1hdGUgZnJvbSAncG9zdG1hdGUnO1xuXG5pbXBvcnQgdHlwZSB7IEREQ2xpZW50IH0gZnJvbSAnLi4vY2xpZW50JztcbmltcG9ydCB7IFVpQXBwQ2FwYWJpbGl0eVR5cGUsIFVpQXBwRXZlbnRUeXBlIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IGdldExvZ2dlciwgTG9nZ2VyIH0gZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCB7XG4gICAgQXBwQ29udGV4dCxcbiAgICBDbGllbnRPcHRpb25zLFxuICAgIEV2ZW50SGFuZGxlcixcbiAgICBIYW5kbGVFdmVudFBhcmFtc1xufSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBEZWZlcnJlZCwgdW5pcXVlSW50IH0gZnJvbSAnLi4vdXRpbHMnO1xuXG50eXBlIFN1YnNjcmlwdGlvbnMgPSB7XG4gICAgW2tleSBpbiBVaUFwcEV2ZW50VHlwZV06IHsgW2lkOiBudW1iZXJdOiBFdmVudEhhbmRsZXIgfTtcbn07XG5cbmNvbnN0IGluaXRTdWJzY3JpcHRpb25zID0gKCk6IFN1YnNjcmlwdGlvbnMgPT4ge1xuICAgIGNvbnN0IHN1YmNyaXB0aW9uczogUGFydGlhbDxTdWJzY3JpcHRpb25zPiA9IHt9O1xuXG4gICAgT2JqZWN0LnZhbHVlcyhVaUFwcEV2ZW50VHlwZSkuZm9yRWFjaChldmVudFR5cGUgPT4ge1xuICAgICAgICBzdWJjcmlwdGlvbnNbZXZlbnRUeXBlXSA9IHt9O1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN1YmNyaXB0aW9ucyBhcyBTdWJzY3JpcHRpb25zO1xufTtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENhcGFiaWxpdHlNYW5hZ2VyIHtcbiAgICBhYnN0cmFjdCB0eXBlOiBVaUFwcENhcGFiaWxpdHlUeXBlO1xuICAgIGFic3RyYWN0IGV2ZW50czogVWlBcHBFdmVudFR5cGVbXTtcblxuICAgIHByb3RlY3RlZCByZWFkb25seSBob3N0OiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGRlYnVnOiBib29sZWFuO1xuICAgIHByb3RlY3RlZCByZWFkb25seSBsb2dnZXI6IExvZ2dlcjtcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgaGFuZHNoYWtlOiBQb3N0bWF0ZS5Nb2RlbDtcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgY29udGV4dDogRGVmZXJyZWQ8QXBwQ29udGV4dD47XG4gICAgcHJpdmF0ZSBzdWJzY3JpcHRpb25zOiB7XG4gICAgICAgIFtrZXkgaW4gVWlBcHBFdmVudFR5cGVdOiB7IFtpZDogbnVtYmVyXTogRXZlbnRIYW5kbGVyIH07XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBvcHRpb25zOiBSZXF1aXJlZDxDbGllbnRPcHRpb25zPixcbiAgICAgICAgaGFuZHNoYWtlOiBQb3N0bWF0ZS5Nb2RlbCxcbiAgICAgICAgY29udGV4dDogRGVmZXJyZWQ8QXBwQ29udGV4dD5cbiAgICApIHtcbiAgICAgICAgdGhpcy5ob3N0ID0gb3B0aW9ucy5ob3N0O1xuICAgICAgICB0aGlzLmRlYnVnID0gb3B0aW9ucy5kZWJ1ZztcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBnZXRMb2dnZXIob3B0aW9ucyk7XG4gICAgICAgIHRoaXMuaGFuZHNoYWtlID0gaGFuZHNoYWtlO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBpbml0U3Vic2NyaXB0aW9ucygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgcGxhY2UgZm9yIGV2ZW50dWFsIGV4dGVuc2lvbnMgb2YgdGhlIGJhc2UgY2xpZW50IG1ldGhvZHMsIHNwZWNpZmljIHRvIGEgY2FwYWJpbGl0eVxuICAgICAqIEV4YW1wbGU6XG4gICAgICogcHJpdmF0ZSBnZXRBZGRpdGlvbmFsQ2xpZW50TWV0aG9kcygpOiB7IFtuYW1lOiBzdHJpbmddOiBGdW5jdGlvbiB9IHtcbiAgICAgKiAgIHJldHVybiAge1xuICAgICAqICAgICBnZXRUaW1lU2VyaWVzOiAoKSA9PiB0aGlzLmdldFRpbWVTZXJpZXMoKTtcbiAgICAgKiAgIH1cbiAgICAgKiB9XG4gICAgICovXG4gICAgYWJzdHJhY3QgZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMoKTogeyBbbmFtZTogc3RyaW5nXTogRnVuY3Rpb24gfTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGFkZGl0aW9uYWwgbWV0aG9kcyBpbiBhIGNoZWNrIGFnYWluc3QgdGhlIGNhcGFiaWxpdHkgdHlwZSwgdGhlbiBhcHBsaWVzIHRvIHByb3ZpZGVkIGNsaWVudCBvYmplY3QuIERvIG5vdCBvdmVycmlkZVxuICAgICAqL1xuICAgIGFwcGx5QWRkaXRpb25hbE1ldGhvZHMoY2xpZW50OiBERENsaWVudCkge1xuICAgICAgICBjb25zdCBhZGRpdGlvbmFsTWV0aG9kcyA9IHRoaXMuZ2V0QWRkaXRpb25hbENsaWVudE1ldGhvZHMoKTtcblxuICAgICAgICBjb25zdCB3cmFwcGVkTWV0aG9kczogeyBbbmFtZTogc3RyaW5nXTogRnVuY3Rpb24gfSA9IHt9O1xuXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGFkZGl0aW9uYWxNZXRob2RzKS5mb3JFYWNoKChba2V5LCBtZXRob2RdKSA9PiB7XG4gICAgICAgICAgICB3cmFwcGVkTWV0aG9kc1trZXldID0gYXN5bmMgKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNFbmFibGVkID0gYXdhaXQgdGhpcy5pc0VuYWJsZWQoKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc0VuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ldGhvZCguLi5hcmdzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIGBUaGUgJHt0aGlzLnR5cGV9IGNhcGFiaWxpdHkgbXVzdCBiZSBlbmFibGVkIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25gXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgT2JqZWN0LmFzc2lnbihjbGllbnQsIHdyYXBwZWRNZXRob2RzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxsZWQgYnkgdGhlIGNsaWVudCB0byByZWdpc3RlciBhbiBldmVudCBoYW5kbGVyIG1hbmFnZWQgYnkgdGhpcyBjYXBhYmlsaXR5LiBEbyBub3Qgb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBzdWJzY3JpYmVIYW5kbGVyPFQ+KFxuICAgICAgICBldmVudFR5cGU6IFVpQXBwRXZlbnRUeXBlLFxuICAgICAgICBoYW5kbGVyOiBFdmVudEhhbmRsZXI8VD5cbiAgICApOiAoKSA9PiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uSWQgPSB1bmlxdWVJbnQoKTtcblxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXVtzdWJzY3JpcHRpb25JZF0gPSBoYW5kbGVyO1xuXG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICAgICAgW3N1YnNjcmlwdGlvbklkXTogXyxcbiAgICAgICAgICAgICAgICAuLi5vdGhlclN1YnNjcmlwdGlvbnNcbiAgICAgICAgICAgIH0gPSB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXTtcblxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0gPSBvdGhlclN1YnNjcmlwdGlvbnM7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IHRoZSBjbGllbnQgdG8gZGVsZWdhdGUgZXZlbnQgaGFuZGxpbmcuIERvIG5vdCBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIGhhbmRsZUV2ZW50PFQ+KHsgZXZlbnRUeXBlLCBkYXRhIH06IEhhbmRsZUV2ZW50UGFyYW1zPFQ+KSB7XG4gICAgICAgIGNvbnN0IGhhc0hhbmRsZXJzID0gdGhpcy5oYXNIYW5kbGVycyhldmVudFR5cGUpO1xuXG4gICAgICAgIGlmICghaGFzSGFuZGxlcnMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzRW5hYmxlZCA9IGF3YWl0IHRoaXMuaXNFbmFibGVkKCk7XG5cbiAgICAgICAgaWYgKGlzRW5hYmxlZCkge1xuICAgICAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9uc1tldmVudFR5cGVdO1xuXG4gICAgICAgICAgICBPYmplY3QudmFsdWVzKHN1YnNjcmlwdGlvbnMpLmZvckVhY2goaGFuZGxlciA9PiBoYW5kbGVyKGRhdGEpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFxuICAgICAgICAgICAgICAgIGBUaGUgJHt0aGlzLnR5cGV9IGNhcGFiaWxpdHkgbXVzdCBiZSBlbmFibGVkIHRvIHJlc3BvbmQgdG8gZXZlbnRzIG9mIHR5cGUgJHtldmVudFR5cGV9LmBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBpc0VuYWJsZWQoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHsgY2FwYWJpbGl0aWVzIH0gPSBhd2FpdCB0aGlzLmNvbnRleHQucHJvbWlzZTtcblxuICAgICAgICByZXR1cm4gY2FwYWJpbGl0aWVzLmluY2x1ZGVzKHRoaXMudHlwZSk7XG4gICAgfVxuXG4gICAgaGFzSGFuZGxlcnMoZXZlbnRUeXBlOiBVaUFwcEV2ZW50VHlwZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISFPYmplY3Qua2V5cyh0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXSkubGVuZ3RoO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=